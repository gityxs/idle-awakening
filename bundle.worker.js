/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./src/worker/main.module.js":
/*!***********************************!*\
  !*** ./src/worker/main.module.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MainModule: () => (/* binding */ MainModule),\n/* harmony export */   mainModule: () => (/* binding */ mainModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _modules_mage_mage_module__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./modules/mage/mage.module */ \"./src/worker/modules/mage/mage.module.js\");\n/* harmony import */ var _modules_resources_resource_pool_module__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./modules/resources/resource-pool.module */ \"./src/worker/modules/resources/resource-pool.module.js\");\n/* harmony import */ var _modules_actions_actions_module__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./modules/actions/actions.module */ \"./src/worker/modules/actions/actions.module.js\");\n/* harmony import */ var _modules_attributes_attributes_module__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./modules/attributes/attributes.module */ \"./src/worker/modules/attributes/attributes.module.js\");\n/* harmony import */ var _modules_items_shop_module__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./modules/items/shop.module */ \"./src/worker/modules/items/shop.module.js\");\n/* harmony import */ var _modules_inventory_inventory_module__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./modules/inventory/inventory.module */ \"./src/worker/modules/inventory/inventory.module.js\");\n/* harmony import */ var _modules_property_property_module__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./modules/property/property.module */ \"./src/worker/modules/property/property.module.js\");\n/* harmony import */ var _modules_magic_spells_module__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./modules/magic/spells.module */ \"./src/worker/modules/magic/spells.module.js\");\n/* harmony import */ var _modules_workshop_crafting_module__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./modules/workshop/crafting.module */ \"./src/worker/modules/workshop/crafting.module.js\");\n/* harmony import */ var _modules_workshop_plantations_module__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./modules/workshop/plantations.module */ \"./src/worker/modules/workshop/plantations.module.js\");\n/* harmony import */ var _modules_social_guilds_module__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./modules/social/guilds.module */ \"./src/worker/modules/social/guilds.module.js\");\n/* harmony import */ var _shared_modules_unlock_notifications_module__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./shared/modules/unlock-notifications.module */ \"./src/worker/shared/modules/unlock-notifications.module.js\");\n/* harmony import */ var _modules_general_random_events_module__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./modules/general/random-events.module */ \"./src/worker/modules/general/random-events.module.js\");\n/* harmony import */ var _modules_general_temporary_effects_module__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./modules/general/temporary-effects.module */ \"./src/worker/modules/general/temporary-effects.module.js\");\n/* harmony import */ var _modules_map_map_module__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./modules/map/map.module */ \"./src/worker/modules/map/map.module.js\");\n/* harmony import */ var _shared_modules_hotkeys_module__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./shared/modules/hotkeys.module */ \"./src/worker/shared/modules/hotkeys.module.js\");\n/* harmony import */ var _shared_modules_monitoring_module__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./shared/modules/monitoring.module */ \"./src/worker/shared/modules/monitoring.module.js\");\n/* harmony import */ var _shared_modules_rules_module__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./shared/modules/rules.module */ \"./src/worker/shared/modules/rules.module.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar MainModule = /*#__PURE__*/function (_GameModule) {\n  function MainModule() {\n    var _this;\n    _classCallCheck(this, MainModule);\n    _this = _callSuper(this, MainModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('attributes', _modules_attributes_attributes_module__WEBPACK_IMPORTED_MODULE_5__.AttributesModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('mage', _modules_mage_mage_module__WEBPACK_IMPORTED_MODULE_2__.MageModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('resource-pool', _modules_resources_resource_pool_module__WEBPACK_IMPORTED_MODULE_3__.ResourcePoolModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('actions', _modules_actions_actions_module__WEBPACK_IMPORTED_MODULE_4__.ActionsModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('property', _modules_property_property_module__WEBPACK_IMPORTED_MODULE_8__.PropertyModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('shop', _modules_items_shop_module__WEBPACK_IMPORTED_MODULE_6__.ShopModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('inventory', _modules_inventory_inventory_module__WEBPACK_IMPORTED_MODULE_7__.InventoryModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('magic', _modules_magic_spells_module__WEBPACK_IMPORTED_MODULE_9__.SpellModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('crafting', _modules_workshop_crafting_module__WEBPACK_IMPORTED_MODULE_10__.CraftingModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('plantations', _modules_workshop_plantations_module__WEBPACK_IMPORTED_MODULE_11__.PlantationsModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('guilds', _modules_social_guilds_module__WEBPACK_IMPORTED_MODULE_12__.GuildsModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('unlock-notifications', _shared_modules_unlock_notifications_module__WEBPACK_IMPORTED_MODULE_13__.UnlockNotificationsModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('random-events', _modules_general_random_events_module__WEBPACK_IMPORTED_MODULE_14__.RandomEventsModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('temporary-effects', _modules_general_temporary_effects_module__WEBPACK_IMPORTED_MODULE_15__.TemporaryEffectsModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('map', _modules_map_map_module__WEBPACK_IMPORTED_MODULE_16__.MapModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('hotkeys', _shared_modules_hotkeys_module__WEBPACK_IMPORTED_MODULE_17__.HotkeysModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('monitoring', _shared_modules_monitoring_module__WEBPACK_IMPORTED_MODULE_18__.MonitoringModule);\n    game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.registerModule('rules', _shared_modules_rules_module__WEBPACK_IMPORTED_MODULE_19__.RulesModule);\n    _this.eventHandler.registerHandler('initialize-game', function (data) {\n      console.log('gameCoreBeforeInited', game_framework__WEBPACK_IMPORTED_MODULE_1__.GameCore.instance);\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.initialize();\n      console.log('gameCoreInited', game_framework__WEBPACK_IMPORTED_MODULE_1__.GameCore.instance);\n      _this.eventHandler.sendData('initialized', _objectSpread(_objectSpread({}, data), {}, {\n        received: true\n      }));\n      console.log('sent initialized');\n    });\n    _this.eventHandler.registerHandler('load-game', function (data) {\n      console.log('load-game received');\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.load(data);\n      console.log('loaded');\n      _this.eventHandler.sendData('loaded', _objectSpread(_objectSpread({}, data), {}, {\n        received: true\n      }));\n    });\n    _this.eventHandler.registerHandler('reset-game', function () {\n      console.log('reset-game received');\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.stopTicking();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.load({});\n      var cheat = 1;\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.startTicking(100, function () {\n        var _gameCore$getModule$b, _gameCore$getModule$b2;\n        return 0.1 * cheat * ((_gameCore$getModule$b = (_gameCore$getModule$b2 = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('mage').bankedTime) === null || _gameCore$getModule$b2 === void 0 ? void 0 : _gameCore$getModule$b2.speedUpFactor) !== null && _gameCore$getModule$b !== void 0 ? _gameCore$getModule$b : 1);\n      }, function () {\n        if (game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.numTicks % 300 === 0) {\n          _this.save();\n        }\n      }, false);\n      _this.eventHandler.sendData('loaded', {\n        received: true,\n        isReset: true\n      });\n    });\n    _this.eventHandler.registerHandler('start-ticking', function () {\n      var cheat = 1;\n      // const speedUpMode = gameCore.getModule('mage').bankedTime?.speedUpFactor ?? 1;\n      // console.log('gameCore', GameCore.instance, speedUpMode);\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.startTicking(100, function () {\n        var _gameCore$getModule$b3, _gameCore$getModule$b4;\n        return 0.1 * cheat * ((_gameCore$getModule$b3 = (_gameCore$getModule$b4 = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('mage').bankedTime) === null || _gameCore$getModule$b4 === void 0 ? void 0 : _gameCore$getModule$b4.speedUpFactor) !== null && _gameCore$getModule$b3 !== void 0 ? _gameCore$getModule$b3 : 1);\n      }, function () {\n        if (game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.numTicks % 100 === 0) {\n          _this.save();\n        }\n      }, false);\n    });\n    _this.eventHandler.registerHandler('query-unlocks', function (payload) {\n      var unlocks = {\n        'actions': true,\n        'actionLists': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_notebook') > 0,\n        'shop': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('shop').isUnlocked,\n        'inventory': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_backpack') > 0,\n        'property': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_tent') > 0,\n        'spellbook': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_spellbook') > 0,\n        'crafting': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_crafting_courses') > 0,\n        'alchemy': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_alchemy_courses') > 0,\n        'workshop': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_crafting_courses') > 0 || game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_alchemy_courses') > 0 || game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('plantation_slots').income > 0,\n        'plantation': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('plantation_slots').income > 0,\n        'guilds': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_charisma') >= 500,\n        'social': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_charisma') >= 500,\n        'map': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_backpack') > 0,\n        'world': game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_backpack') > 0\n      };\n      var label = 'unlocks';\n      if (payload !== null && payload !== void 0 && payload.prefix) {\n        label = \"\".concat(label, \"-\").concat(payload === null || payload === void 0 ? void 0 : payload.prefix);\n      }\n      _this.eventHandler.sendData(label, unlocks);\n    });\n    _this.eventHandler.registerHandler('get-save-string', function (_ref) {\n      var type = _ref.type;\n      var saveObj = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.save();\n      _this.eventHandler.sendData('saved-string', {\n        string: JSON.stringify(saveObj),\n        type: type\n      });\n    });\n    MainModule.instance = _this;\n    return _this;\n  }\n  _inherits(MainModule, _GameModule);\n  return _createClass(MainModule, [{\n    key: \"initialize\",\n    value: function initialize() {}\n  }, {\n    key: \"tick\",\n    value: function tick() {}\n  }, {\n    key: \"save\",\n    value: function save() {\n      var saveStr = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.save();\n      this.eventHandler.sendData('save-game', saveStr);\n    }\n  }, {\n    key: \"load\",\n    value: function load() {}\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\nvar mainModule = function mainModule() {\n  return MainModule.instance || new MainModule();\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/main.module.js?");

/***/ }),

/***/ "./src/worker/modules/actions/action-lists.submodule.js":
/*!**************************************************************!*\
  !*** ./src/worker/modules/actions/action-lists.submodule.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ActionListsSubmodule: () => (/* binding */ ActionListsSubmodule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/utils/rule-utils */ \"./src/worker/shared/utils/rule-utils.js\");\n/* harmony import */ var _shared_utils_objects__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/utils/objects */ \"./src/worker/shared/utils/objects.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _createForOfIteratorHelper(r, e) { var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t[\"return\"] || t[\"return\"](); } finally { if (u) throw o; } } }; }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar ActionListsSubmodule = /*#__PURE__*/function (_GameModule) {\n  function ActionListsSubmodule() {\n    var _this;\n    _classCallCheck(this, ActionListsSubmodule);\n    _this = _callSuper(this, ActionListsSubmodule);\n    _this.actionsLists = {};\n    _this.runningList = null;\n    _this.listsAutotrigger = [];\n    _this.autotriggerCD = 0;\n    _this.automationEnabled = false;\n    _this.combineLists = true;\n    _this.autotriggerIntervalSetting = 10;\n    _this.eventHandler.registerHandler('save-action-list', function (payload) {\n      _this.saveActionList(payload);\n    });\n    _this.eventHandler.registerHandler('delete-action-list', function (_ref) {\n      var id = _ref.id;\n      _this.deleteActionList(id);\n    });\n    _this.eventHandler.registerHandler('load-action-list', function (_ref2) {\n      var id = _ref2.id;\n      _this.sendListData(id);\n    });\n    _this.eventHandler.registerHandler('query-actions-lists', function (pl) {\n      var lists = _this.getLists(pl);\n      var label = 'actions-lists';\n      if (pl.prefix) {\n        label = \"\".concat(label, \"-\").concat(pl.prefix);\n      }\n      _this.eventHandler.sendData(label, lists);\n    });\n    _this.eventHandler.registerHandler('run-list', function (_ref3) {\n      var id = _ref3.id;\n      _this.runList(id);\n    });\n    _this.eventHandler.registerHandler('stop-list', function (_ref4) {\n      var id = _ref4.id;\n      _this.stopList(id);\n    });\n    _this.eventHandler.registerHandler('set-automation-enabled', function (_ref5) {\n      var flag = _ref5.flag;\n      _this.automationEnabled = !!flag;\n    });\n    _this.eventHandler.registerHandler('set-autotrigger-interval', function (_ref6) {\n      var interval = _ref6.interval;\n      _this.autotriggerIntervalSetting = interval;\n    });\n    _this.eventHandler.registerHandler('set-action-lists-order', function (payload) {\n      _this.reorderLists(payload);\n    });\n    _this.eventHandler.registerHandler('query-action-list-effects', function (_ref7) {\n      var id = _ref7.id,\n        listData = _ref7.listData;\n      var data = _this.getListEffects(null, listData);\n      var prevEffects = [];\n      var resourcesEffects = _this.packEffects(data.filter(function (one) {\n        return one.type === 'resources';\n      }).map(function (effect) {\n        var prev = game_framework__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.assertResource(effect.id, false, ['running']);\n        if (effect.scope !== 'income' && effect.scope !== 'consumption') return effect;\n        var pScope = effect.scope === 'consumption' ? 'income' : effect.scope;\n        var nPrv = _objectSpread(_objectSpread({}, effect), {}, {\n          scope: pScope,\n          value: prev.balance\n        });\n        if (nPrv.value < 0) {\n          nPrv.value = Math.abs(nPrv.value);\n          nPrv.scope = 'consumption';\n        }\n        prevEffects.push(nPrv);\n        var newVal = (effect.scope === 'income' ? effect.value : -effect.value) + prev.balance;\n        var nScope = newVal > 0 ? 'income' : 'consumption';\n        return _objectSpread(_objectSpread({}, effect), {}, {\n          value: Math.abs(newVal),\n          scope: nScope\n        });\n      }));\n      console.log('SendingData: ', JSON.stringify(data.prevEffects), JSON.stringify(data.resourcesEffects), data, id);\n      _this.eventHandler.sendData('action-list-effects', {\n        potentialEffects: data,\n        resourcesEffects: resourcesEffects,\n        prevEffects: _this.packEffects(prevEffects),\n        effectEffects: data.filter(function (one) {\n          return one.type === 'effects';\n        })\n      });\n    });\n    return _this;\n  }\n  _inherits(ActionListsSubmodule, _GameModule);\n  return _createClass(ActionListsSubmodule, [{\n    key: \"runList\",\n    value: function runList(id) {\n      if (!id) {\n        this.stopList();\n        return;\n      }\n      this.runningList = {\n        id: id,\n        name: this.actionsLists[id].name,\n        actionIndex: 0,\n        actionTimer: 0\n      };\n      if (this.combineLists) {\n        // register entity as custom action\n        this.runCombinedList(id);\n      }\n    }\n  }, {\n    key: \"stopList\",\n    value: function stopList() {\n      this.runningList = null;\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').stopRunningActions();\n    }\n  }, {\n    key: \"saveActionList\",\n    value: function saveActionList(payload) {\n      var _this$runningList, _this$runningList2;\n      var isNew = !payload.id;\n      var list = _objectSpread({}, payload);\n      delete list['isReopenEdit'];\n      var isReopenEdit = payload.isReopenEdit;\n      if (!list.id) {\n        list.id = \"\".concat(Math.random() * 1000000);\n      }\n      this.actionsLists[list.id] = list;\n      this.actionsLists[list.id].actions = (this.actionsLists[list.id].actions || []).filter(function (one) {\n        return one.time > 0;\n      });\n      if (isReopenEdit) {\n        this.sendListData(list.id, true);\n      }\n      this.sortLists();\n      this.regenerateListsPriorityMap();\n      if ((_this$runningList = this.runningList) !== null && _this$runningList !== void 0 && _this$runningList.id && ((_this$runningList2 = this.runningList) === null || _this$runningList2 === void 0 ? void 0 : _this$runningList2.id) === payload.id) {\n        var listToRun = this.actionsLists[this.runningList.id];\n        var newTotalTime = 0.;\n        listToRun.actions.forEach(function (a) {\n          var isAvailable = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(a.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(a.id);\n          if (isAvailable) {\n            newTotalTime += a.time;\n          }\n        });\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeActions = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeActions.map(function (active) {\n          var _listToRun$actions$fi;\n          return _objectSpread(_objectSpread({}, active), {}, {\n            effort: (((_listToRun$actions$fi = listToRun.actions.find(function (o) {\n              return o.id === active.originalId;\n            })) === null || _listToRun$actions$fi === void 0 ? void 0 : _listToRun$actions$fi.time) || 0) / Math.max(newTotalTime, 0.0001)\n          });\n        });\n        console.log('Reassert list onSave: ', newTotalTime, game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeActions);\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').reassertRunningEfforts(true);\n      }\n    }\n  }, {\n    key: \"deleteActionList\",\n    value: function deleteActionList(id) {\n      delete this.actionsLists[id];\n      this.sortLists();\n      this.regenerateListsPriorityMap();\n    }\n  }, {\n    key: \"regenerateListsPriorityMap\",\n    value: function regenerateListsPriorityMap() {\n      var listsBeingAutotrigger = Object.values(this.actionsLists).filter(function (one) {\n        var _one$autotrigger;\n        return !!((_one$autotrigger = one.autotrigger) !== null && _one$autotrigger !== void 0 && (_one$autotrigger = _one$autotrigger.rules) !== null && _one$autotrigger !== void 0 && _one$autotrigger.length);\n      });\n      var listsBeingAutotriggerAvailable = listsBeingAutotrigger.filter(function (lst) {\n        if (lst.actions && lst.actions.find(function (one) {\n          return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(one.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(one.id);\n        })) return true;\n        return false;\n      });\n      console.log('regenerateListPriority: ', listsBeingAutotrigger, listsBeingAutotriggerAvailable);\n      this.listsAutotrigger = listsBeingAutotriggerAvailable.map(function (one) {\n        var _one$autotrigger$prio;\n        return {\n          id: one.id,\n          priority: (_one$autotrigger$prio = one.autotrigger.priority) !== null && _one$autotrigger$prio !== void 0 ? _one$autotrigger$prio : 0\n        };\n      }).sort(function (a, b) {\n        return a.priority - b.priority;\n      });\n    }\n  }, {\n    key: \"reorderLists\",\n    value: function reorderLists(newOrder) {\n      var _this2 = this;\n      newOrder.forEach(function (_ref8) {\n        var id = _ref8.id,\n          sort = _ref8.sort;\n        if (_this2.actionsLists[id]) {\n          _this2.actionsLists[id].sort = sort;\n        }\n      });\n      console.log('newOrder: ', newOrder);\n      this.sortLists(); // Re-sort the cached list\n    }\n  }, {\n    key: \"sortLists\",\n    value: function sortLists() {\n      this._cachedSortedLists = Object.values(this.actionsLists).sort(function (a, b) {\n        return a.sort - b.sort;\n      });\n    }\n  }, {\n    key: \"getLists\",\n    value: function getLists(pl) {\n      if (!this._cachedSortedLists) {\n        this.sortLists();\n      }\n      var ls = this._cachedSortedLists.map(function (one) {\n        return _objectSpread(_objectSpread({}, one), {}, {\n          isUnlocked: true\n        });\n      });\n      if (pl !== null && pl !== void 0 && pl.filterAutomated) {\n        ls = ls.filter(function (one) {\n          var _one$autotrigger2;\n          return (_one$autotrigger2 = one.autotrigger) === null || _one$autotrigger2 === void 0 || (_one$autotrigger2 = _one$autotrigger2.rules) === null || _one$autotrigger2 === void 0 ? void 0 : _one$autotrigger2.length;\n        });\n      }\n      return ls;\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        list: (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_3__.mapObject)(this.actionsLists, function (one) {\n          return {\n            id: one.id,\n            name: one.name,\n            sort: one.sort,\n            actions: one.actions,\n            autotrigger: one.autotrigger\n          };\n        }),\n        runningList: this.runningList,\n        automationEnabled: this.automationEnabled,\n        autotriggerIntervalSetting: this.autotriggerIntervalSetting\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      var _obj$list, _obj$runningList;\n      this.actionsLists = (_obj$list = obj === null || obj === void 0 ? void 0 : obj.list) !== null && _obj$list !== void 0 ? _obj$list : [];\n      this.runningList = (_obj$runningList = obj === null || obj === void 0 ? void 0 : obj.runningList) !== null && _obj$runningList !== void 0 ? _obj$runningList : null;\n      this.automationEnabled = obj === null || obj === void 0 ? void 0 : obj.automationEnabled;\n      this.autotriggerIntervalSetting = (obj === null || obj === void 0 ? void 0 : obj.autotriggerIntervalSetting) || 10;\n      if (this.actionsLists) {\n        for (var key in this.actionsLists) {\n          this.actionsLists[key].actions = (this.actionsLists[key].actions || []).filter(function (one) {\n            return one.time > 0;\n          });\n        }\n      }\n      this.sortLists();\n      this.regenerateListsPriorityMap();\n    }\n  }, {\n    key: \"getAutotriggerList\",\n    value: function getAutotriggerList() {\n      var _iterator = _createForOfIteratorHelper(this.listsAutotrigger),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _this$actionsLists$li, _this$actionsLists$li2;\n          var list = _step.value;\n          if ((0,_shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_2__.checkMatchingRules)((_this$actionsLists$li = this.actionsLists[list.id]) === null || _this$actionsLists$li === void 0 || (_this$actionsLists$li = _this$actionsLists$li.autotrigger) === null || _this$actionsLists$li === void 0 ? void 0 : _this$actionsLists$li.rules, (_this$actionsLists$li2 = this.actionsLists[list.id]) === null || _this$actionsLists$li2 === void 0 || (_this$actionsLists$li2 = _this$actionsLists$li2.autotrigger) === null || _this$actionsLists$li2 === void 0 ? void 0 : _this$actionsLists$li2.pattern)) {\n            return list.id;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return null;\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      // Here we checking autotrigger\n      if (this.automationEnabled && this.listsAutotrigger.length && this.autotriggerCD <= 0) {\n        var _this$runningList3;\n        this.autotriggerCD = this.autotriggerIntervalSetting || 10;\n        var autotrigger = this.getAutotriggerList();\n        if (autotrigger && ((_this$runningList3 = this.runningList) === null || _this$runningList3 === void 0 ? void 0 : _this$runningList3.id) !== autotrigger) {\n          var _this$runningList4;\n          console.log('Run list autotrigger: ', autotrigger, (_this$runningList4 = this.runningList) === null || _this$runningList4 === void 0 ? void 0 : _this$runningList4.id, this.listsAutotrigger);\n          this.runList(autotrigger);\n        }\n      }\n      this.autotriggerCD -= delta;\n      if (this.runningList && !this.combineLists) {\n        var _action;\n        var listToRun = this.actionsLists[this.runningList.id];\n        if (!listToRun) {\n          console.error('List: ', this.actionsLists, this.runningList);\n          throw new Error('Invalid list to run!!');\n        }\n        var action = listToRun.actions[this.runningList.actionIndex];\n        var isAvailable = ((_action = action) === null || _action === void 0 ? void 0 : _action.id) && game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(action.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(action.id);\n\n        // Check if action timer exceeded or action is not available\n        if (!action || this.runningList.actionTimer > action.time || !isAvailable) {\n          this.runningList.actionTimer = 0;\n\n          // Initialize loop control variables\n          var loops = 0;\n          var maxLoops = listToRun.actions.length;\n\n          // Loop to find the next available action\n          do {\n            this.runningList.actionIndex++;\n            if (this.runningList.actionIndex >= listToRun.actions.length) {\n              this.runningList.actionIndex = 0; // Reset to start if end is reached\n            }\n            action = listToRun.actions[this.runningList.actionIndex];\n            isAvailable = action && game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(action.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(action.id);\n            loops++;\n          } while (!isAvailable && loops < maxLoops);\n          if (!isAvailable) {\n            // No available actions found in the list\n            console.log('No available actions in the list.');\n            // Handle this case as needed, e.g., stop the running list\n            this.stopList();\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').setRunningAction(null);\n            return; // Exit the function early\n          } else {\n            console.log('Toggled to:', this.runningList, action.id, delta);\n          }\n        }\n\n        // Set the active action if it's not already active\n        if (game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeAction !== action.id) {\n          game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').setRunningAction(action.id);\n        }\n\n        // Increment the action timer\n        this.runningList.actionTimer += delta;\n      }\n      if (this.runningList && this.combineLists) {\n        // include available notpresent\n        var _listToRun = this.actionsLists[this.runningList.id];\n        if (!_listToRun) {\n          console.error('List: ', this.actionsLists, this.runningList);\n          throw new Error('Invalid list to run');\n        }\n        var totalTime = _listToRun.actions.reduce(function (acc, item) {\n          return acc += item.time;\n        }, 0);\n        var needReassert = false;\n        var newTotalTime = 0.;\n        _listToRun.actions.forEach(function (a) {\n          var isAvailable = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(a.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(a.id);\n          if (isAvailable) {\n            newTotalTime += a.time;\n          }\n          if (!isAvailable && game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').isRunningAction(a.id)) {\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').dropRunningAction(a.id);\n            needReassert = true;\n          }\n          if (!game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').isRunningAction(a.id) && isAvailable) {\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').addRunningAction(a.id, a.time / totalTime);\n            needReassert = true;\n          }\n        });\n        var activeActions = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeActions;\n        activeActions.forEach(function (active) {\n          if (!_listToRun.actions.find(function (o) {\n            return o.id === active.originalId;\n          })) {\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').dropRunningAction(active.originalId);\n            needReassert = true;\n          }\n        });\n        if (needReassert) {\n          game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeActions = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeActions.map(function (active) {\n            var _listToRun$actions$fi2;\n            return _objectSpread(_objectSpread({}, active), {}, {\n              effort: (((_listToRun$actions$fi2 = _listToRun.actions.find(function (o) {\n                return o.id === active.originalId;\n              })) === null || _listToRun$actions$fi2 === void 0 ? void 0 : _listToRun$actions$fi2.time) || 0) / newTotalTime\n            });\n          });\n          console.log('Reassert list: ', needReassert, newTotalTime, totalTime, game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').activeActions);\n          game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').reassertRunningEfforts();\n        }\n      }\n    }\n  }, {\n    key: \"packEffects\",\n    value: function packEffects(effects) {\n      var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (item) {\n        return true;\n      };\n      var result = effects.filter(filter).reduce(function (acc, item) {\n        acc[item.id] = item;\n        return acc;\n      }, {});\n      return result;\n    }\n  }, {\n    key: \"runCombinedList\",\n    value: function runCombinedList(id) {\n      var data = this.actionsLists[id];\n      var actionsAvailable = (data.actions || []).map(function (a) {\n        return _objectSpread(_objectSpread({}, a), {}, {\n          isAvailable: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(a.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(a.id)\n        });\n      });\n      var totalTime = actionsAvailable.filter(function (action) {\n        return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(action.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(action.id);\n      }).reduce(function (acc, item) {\n        return acc += item.time;\n      }, 0);\n      var actionsFractions = actionsAvailable.map(function (action) {\n        return _objectSpread(_objectSpread({}, action), {}, {\n          effortFraction: action.time / Math.max(totalTime, 0.0001)\n        });\n      });\n\n      // now registering entities for every action\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').stopRunningActions();\n      actionsFractions.forEach(function (actionToRun) {\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').addRunningAction(actionToRun.id, actionToRun.effortFraction);\n      });\n    }\n  }, {\n    key: \"sendListData\",\n    value: function sendListData(id) {\n      var bForceOpen = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var data = this.actionsLists[id];\n      data.actions = (data.actions || []).map(function (a) {\n        return _objectSpread(_objectSpread({}, a), {}, {\n          isAvailable: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(a.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(a.id)\n        });\n      });\n      data.potentialEffects = this.getListEffects(id);\n      var resourcesEffects = data.potentialEffects.filter(function (one) {\n        return one.type === 'resources';\n      });\n      data.effectEffects = data.potentialEffects.filter(function (one) {\n        return one.type === 'effects';\n      });\n      var prevEffects = [];\n      data.resourcesEffects = this.packEffects(resourcesEffects.map(function (effect) {\n        var prev = game_framework__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.assertResource(effect.id, false, ['running']);\n        if (effect.scope !== 'income' && effect.scope !== 'consumption') return effect;\n        var pScope = effect.scope === 'consumption' ? 'income' : effect.scope;\n        var nPrv = _objectSpread(_objectSpread({}, effect), {}, {\n          scope: pScope,\n          value: prev.balance\n        });\n        if (nPrv.value < 0) {\n          nPrv.value = Math.abs(nPrv.value);\n          nPrv.scope = 'consumption';\n        }\n        console.log('Prv2: ', prev, effect, nPrv);\n        prevEffects.push(nPrv);\n        var newVal = (effect.scope === 'income' ? effect.value : -effect.value) + prev.balance;\n        var nScope = newVal > 0 ? 'income' : 'consumption';\n        return _objectSpread(_objectSpread({}, effect), {}, {\n          value: Math.abs(newVal),\n          scope: nScope\n        });\n      }));\n      data.prevEffects = this.packEffects(prevEffects);\n      data.bForceOpen = bForceOpen;\n\n      // console.log('SendingData: ', JSON.stringify(data.prevEffects), JSON.stringify(data.resourcesEffects));\n\n      this.eventHandler.sendData('action-list-data', data);\n    }\n  }, {\n    key: \"getListEffects\",\n    value: function getListEffects(id, listData) {\n      var list = this.actionsLists[id];\n      if (!list) {\n        if (!listData) {\n          throw new Error(\"List with id \".concat(id, \" not found\"));\n        }\n        list = listData;\n      }\n      var totalTime = list.actions.filter(function (action) {\n        return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(action.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(action.id);\n      }).reduce(function (acc, item) {\n        return acc += item.time;\n      }, 0);\n      var totalEffects = [];\n      list.actions.forEach(function (action) {\n        var isAvailable = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(action.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(action.id);\n        if (!isAvailable) {\n          return;\n        }\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEffects(action.id, game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getAttribute(action.id, 'isTraining') ? 1 : 0, game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getAttribute(action.id, 'isTraining') ? 1 : game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel(action.id), true, action.time / totalTime);\n        var learnRateFactor = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').getLearningRate(action.id) / game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').getActionXPMax(action.id);\n        effects.forEach(function (effToAdd) {\n          var foundId = totalEffects.findIndex(function (a) {\n            return a.id === effToAdd.id && (a.scope === effToAdd.scope || ['income', 'consumption'].includes(a.scope) && ['income', 'consumption'].includes(effToAdd.scope));\n          });\n          if (effToAdd.scope === 'income' && effToAdd.type === 'resources') {\n            effToAdd.value *= game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource(effToAdd.id).multiplier;\n          }\n          if (effToAdd.scope === 'multiplier' && effToAdd.type === 'effects') {\n            // we actually adding multiplier\n            effToAdd.value *= learnRateFactor;\n          }\n          if (effToAdd.scope === 'income' && effToAdd.type === 'effects') {\n            effToAdd.value *= learnRateFactor;\n          }\n          if (foundId < 0) {\n            totalEffects.push(effToAdd);\n          } else {\n            if (totalEffects[foundId].scope === 'consumption') {\n              totalEffects[foundId].scope = 'income';\n              totalEffects[foundId].value = -totalEffects[foundId].value;\n            }\n            if (effToAdd.scope === 'consumption') {\n              totalEffects[foundId].value -= effToAdd.value;\n            } else {\n              totalEffects[foundId].value += effToAdd.value;\n            }\n          }\n        });\n      });\n      return totalEffects.map(function (eff) {\n        return eff.scope === 'income' && eff.value < 0 ? _objectSpread(_objectSpread({}, eff), {}, {\n          scope: 'consumption',\n          value: -eff.value\n        }) : eff;\n      });\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/actions/action-lists.submodule.js?");

/***/ }),

/***/ "./src/worker/modules/actions/actions-db.js":
/*!**************************************************!*\
  !*** ./src/worker/modules/actions/actions-db.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerActionsStage1: () => (/* binding */ registerActionsStage1)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\n\nvar getPrimaryBonus = function getPrimaryBonus(attributeId) {\n  return 0.98 + 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue(attributeId);\n};\nvar getChanceBased = function getChanceBased(effect, softCap, hardCap) {\n  if (effect < softCap) {\n    return effect;\n  }\n  var rs = softCap + (effect - softCap) * Math.pow(softCap / effect, 0.5);\n  if (rs < hardCap) {\n    return rs;\n  }\n  return hardCap;\n};\nvar getResourceModifierDataSearchable = function getResourceModifierDataSearchable(rs) {\n  var searchables = {\n    'effects': [],\n    'resources': []\n  };\n  if (!rs) return searchables;\n  ['income', 'consumption', 'multiplier'].forEach(function (scope) {\n    var rObj = null;\n    if (rs[\"get_\".concat(scope)]) {\n      rObj = rs[\"get_\".concat(scope)]();\n    } else {\n      rObj = rs[scope];\n    }\n    if (!rObj) return;\n    var _loop = function _loop(type) {\n      var _searchables$type;\n      (_searchables$type = searchables[type]).push.apply(_searchables$type, _toConsumableArray(Object.keys(rObj[type]).map(function (one) {\n        var _gameEffects$getEffec;\n        return type === 'resources' ? game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(one).name.toLowerCase() : (_gameEffects$getEffec = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffect(one)) === null || _gameEffects$getEffec === void 0 ? void 0 : _gameEffects$getEffec.name.toLowerCase();\n      })));\n    };\n    for (var type in rObj) {\n      _loop(type);\n    }\n  });\n  return searchables;\n};\nvar registerGameAction = function registerGameAction(id, options) {\n  var primaryAttribute = options.attributes.primaryAttribute;\n  if (!options.resourceModifier) {\n    return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(id, options);\n  }\n  if (primaryAttribute) {\n    if (!options.resourceModifier.effectDeps) {\n      options.resourceModifier.effectDeps = [];\n    }\n    if (!options.resourceModifier.effectDeps.includes(primaryAttribute)) {\n      options.resourceModifier.effectDeps.push(primaryAttribute);\n    }\n    options.getPrimaryEffect = function () {\n      return getPrimaryBonus(primaryAttribute);\n    };\n    if (options.attributes.isTraining) {\n      options.resourceModifier.customAmplifierApplyTypes = ['resources'];\n    } else {\n      options.resourceModifier.customAmplifierApplyTypes = ['effects', 'resources'];\n    }\n    options.resourceModifier.getCustomAmplifier = function () {\n      return options.getPrimaryEffect();\n    };\n  }\n  options.searchableMeta = getResourceModifierDataSearchable(options.resourceModifier);\n  return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(id, options);\n};\nvar registerActionsStage1 = function registerActionsStage1() {\n  registerGameAction('action_walk', {\n    tags: [\"action\", \"training\", \"physical\"],\n    name: 'Walking',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Perform some walking exercises to improve your stamina',\n    level: 1,\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_stamina': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 0.05,\n            type: 0\n          }\n        }\n      },\n      effectDeps: ['walking_learning_rate']\n    },\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['walking_learning_rate', 'physical_training_learn_speed'],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 5,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_visit_city', {\n    tags: [\"action\", \"training\", \"physical\"],\n    name: 'Visit City',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Visit city to find new jobs and opportunities',\n    level: 1,\n    maxLevel: 2,\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_walk',\n      level: 2\n    }],\n    attributes: {\n      baseXPCost: 10\n    }\n  });\n  registerGameAction('action_beggar', {\n    tags: [\"action\", \"job\", \"physical\"],\n    name: 'Beggar',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Wander the city streets, hoping for someone\\'s help',\n    level: 1,\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'coins': {\n              A: 0.01 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('begging_efficiency') * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              B: 0.09 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('begging_efficiency') * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0,\n              B: 0.2,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['begging_efficiency', 'coins_earned_bonus']\n    },\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['job_learning_rate'],\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_visit_city',\n      level: 2\n    }],\n    attributes: {\n      baseXPCost: 10,\n      primaryAttribute: 'attribute_charisma'\n    }\n  });\n  registerGameAction('action_street_musician', {\n    tags: [\"action\", \"job\", \"politician\"],\n    name: 'Street Musician',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Perform melodies for passersby and earn some coins through the power of music',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['job_learning_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'coins': {\n              A: 0.05 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              B: 0.45 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0,\n              B: 1.0,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['begging_efficiency', 'coins_earned_bonus']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 10\n    }],\n    attributes: {\n      baseXPCost: 20,\n      primaryAttribute: 'attribute_charisma'\n    }\n  });\n  registerGameAction('action_clean_stable', {\n    tags: [\"action\", \"job\", \"physical\"],\n    name: 'Clean Stable',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Clean Stables to earn some gold',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['job_learning_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'coins': {\n              A: 0.08 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('clean_stable_efficiency') * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              B: 0.72 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('clean_stable_efficiency') * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 1,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 0.4,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['coins_earned_bonus', 'clean_stable_efficiency']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 5\n    }],\n    attributes: {\n      baseXPCost: 20,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('action_patrol', {\n    tags: [\"action\", \"job\", \"physical\"],\n    name: 'Patrol',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Protect streets from hooligans and robbers. Its risky and hard job, but its well paid',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['job_learning_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'coins': {\n              A: 0.25 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              B: 2.25 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 4,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 2,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['coins_earned_bonus']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 50\n    }],\n    attributes: {\n      baseXPCost: 20,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('action_builder', {\n    tags: [\"action\", \"job\", \"physical\"],\n    name: 'Builder',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Work as builder. Its hard job, but well paid',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['job_learning_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'coins': {\n              A: 1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              B: 9 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_earned_bonus'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 12,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 6,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['coins_earned_bonus']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 350\n    }],\n    attributes: {\n      baseXPCost: 20,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('action_woodcutter', {\n    tags: [\"action\", \"activity\", \"physical\", \"manual-labor\"],\n    name: 'Woodcutting',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spend some time working hard to get some wood',\n    level: 1,\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_wood': {\n              A: 0.002 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('manual_labor_efficiency'),\n              B: 0.008 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('manual_labor_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 8,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 3,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['manual_labor_efficiency']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 100\n    }],\n    attributes: {\n      baseXPCost: 500,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('action_quarrying', {\n    tags: [\"action\", \"activity\", \"physical\", \"manual-labor\"],\n    name: 'Quarrying',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Work hard in quarry trying to find some rocks containing precious minerals',\n    level: 1,\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_stone': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('manual_labor_efficiency'),\n              B: 0.004 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('manual_labor_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 12,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['manual_labor_efficiency']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 300\n    }],\n    attributes: {\n      baseXPCost: 500,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('action_mining', {\n    tags: [\"action\", \"activity\", \"physical\", \"manual-labor\"],\n    name: 'Mining',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Go to mine and get some iron ore',\n    level: 1,\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_iron_ore': {\n              A: 0.0004 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('manual_labor_efficiency'),\n              B: 0.002 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('manual_labor_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 42,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 75,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['manual_labor_efficiency']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 1000\n    }],\n    attributes: {\n      baseXPCost: 1500,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('action_rest', {\n    tags: [\"action\", \"rest\", \"physical\"],\n    name: 'Rest in Tavern',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Pay some gold to rest in tavern',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 0;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'energy': {\n              A: 1.0,\n              B: 0,\n              type: 0\n            },\n            'health': {\n              A: 0.1,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'coins': {\n              A: 0.0,\n              B: 0.2,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_visit_city',\n      level: 2\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') < 1;\n    },\n    attributes: {\n      baseXPCost: 1.e+10\n    }\n  });\n  registerGameAction('action_rest_home', {\n    tags: [\"action\", \"rest\", \"physical\"],\n    name: 'Rest at home',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Stay at your sweet home to heal and recover',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 0;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'energy': {\n              A: 1.0 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('rest_efficiency'),\n              B: 0,\n              type: 0\n            },\n            'health': {\n              A: 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('rest_efficiency'),\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['rest_efficiency']\n    },\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_visit_city',\n      level: 2\n    }, {\n      type: 'entity',\n      id: 'shop_item_tent',\n      level: 1\n    }],\n    attributes: {\n      baseXPCost: 1.e+10\n    }\n  });\n  registerGameAction('action_gossip', {\n    tags: [\"action\", \"training\", \"mental\", \"social\"],\n    name: 'Gossip',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spend some time communicating with people about news and other things. Improves your charisma',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['mental_training_learning_rate', 'social_training_learning_rate'],\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_charisma': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 0.1,\n            type: 0\n          }\n        }\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_beggar',\n      level: 5\n    }],\n    attributes: {\n      baseXPCost: 25,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_knowledge_exchange', {\n    tags: [\"action\", \"training\", \"mental\", \"social\"],\n    name: 'Knowledge Exchange',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Engage in a mutual exchange of ideas with others, sharing insights and gaining valuable knowledge. Slightly increases your learning speed.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['mental_training_learning_rate', 'social_training_learning_rate'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'learning_rate': {\n              A: 0.01,\n              B: 0.99,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            },\n            'knowledge': {\n              A: 0.0,\n              B: 5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 75\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 200,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_trade_efficiency', {\n    tags: [\"action\", \"training\", \"social\"],\n    name: 'Train Trade Efficiency',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Learn more about trading and local economy. Increase amount of goods that can be sold',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 2.;\n    },\n    learningEffects: ['social_training_learning_rate'],\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'shop_max_stock': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          },\n          'shop_stock_renew_rate': {\n            A: 0.02,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 20,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 125\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 5000,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_train_bargaining', {\n    tags: [\"action\", \"training\", \"mental\", \"social\"],\n    name: 'Train Bargaining',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spent time walking through local market and talking to local merchants.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 2.;\n    },\n    learningEffects: ['mental_training_learning_rate', 'social_training_learning_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_bargaining': {\n              A: 0.5,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 50,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 200\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 5000,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_public_engagement', {\n    tags: [\"action\", \"mental\", \"social\", \"activity\"],\n    name: 'Public Engagement',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Engage with the public through speeches, events, and social interactions to inspire others and strengthen your influence. This action enhances the effectiveness of all social actions, making your efforts more impactful.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 4.;\n    },\n    learningEffects: ['social_training_learning_rate', 'mental_activities_learn_rate'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'social_training_learning_rate': {\n              A: 0.02,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 100,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 300\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 1000,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_academic_discussions', {\n    tags: [\"action\", \"mental\", \"activity\"],\n    name: 'Academic Discussions',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Participate in thought-provoking academic discussions and debates to broaden your knowledge and understanding.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['mental_activities_learn_rate'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'learning_rate': {\n              A: 0.02,\n              B: 0.98,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 25,\n              type: 0\n            },\n            'knowledge': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 750\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 5000,\n      isTraining: true,\n      primaryAttribute: 'attribute_charisma'\n    }\n  });\n  registerGameAction('action_pushup', {\n    tags: [\"action\", \"training\", \"physical\"],\n    name: 'Push Up',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Perform some simple physical exercises to become stronger and unlock better physical jobs options',\n    level: 1,\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_strength': {\n            A: 1,\n            B: 0,\n            type: 0\n          },\n          'attribute_vitality': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 0.25,\n            type: 0\n          }\n        }\n      },\n      effectDeps: [],\n      reourcesToReassert: ['health']\n    },\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_walk',\n      level: 20\n    }],\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['physical_training_learn_speed'],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_walk') > 19;\n    },\n    attributes: {\n      baseXPCost: 25,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_read_motivation_book', {\n    tags: [\"action\", \"training\", \"mental\"],\n    name: 'Read book of Motivation',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Read book of motivation, containing some useful advices regarding self-development',\n    level: 1,\n    maxLevel: 5,\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'learning_rate': {\n            A: 0.25,\n            B: 0.75,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 0.4,\n            type: 0\n          }\n        }\n      },\n      effectDeps: []\n    },\n    unlockCondition: function unlockCondition() {\n      // console.log('Beggar level: ', gameEntity.getLevel('action_beggar'));\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_book_of_motivation') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_read_math_book', {\n    tags: [\"action\", \"training\", \"mental\"],\n    name: 'Train Math',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Train you brain to calculate coins better. Increase coins income',\n    level: 1,\n    maxLevel: 5,\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'coins_earned_bonus': {\n            A: 0.125,\n            B: 0.875,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 0.8,\n            type: 0\n          }\n        }\n      },\n      effectDeps: []\n    },\n    unlockCondition: function unlockCondition() {\n      // console.log('Beggar level: ', gameEntity.getLevel('action_beggar'));\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_book_of_math') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_gather_carefully', {\n    tags: [\"action\", \"activity\", \"routine\", \"gathering\"],\n    name: 'Careful Gathering',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spend some time looking for items, but without many risks',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'gathering_effort': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.049 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      primaryAttribute: 'attribute_patience'\n    }\n  });\n  registerGameAction('action_gather_normal', {\n    tags: [\"action\", \"activity\", \"routine\", \"gathering\"],\n    name: 'Gathering',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spend more energy and efforts on looking for items for better rewards',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'gathering_effort': {\n              A: 0.002 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.018 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'gathering_perception': {\n              A: 0,\n              B: 0.3,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0,\n              B: 5,\n              type: 0\n            },\n            'health': {\n              A: 0,\n              B: 2.5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      primaryAttribute: 'attribute_patience'\n    }\n  });\n  registerGameAction('action_gather_berries', {\n    tags: [\"action\", \"gathering\", \"routine\"],\n    name: 'Gather Berries',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spend some time walking in nearby forest and collecting berries',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_berry': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && false;\n    },\n    attributes: {\n      baseXPCost: 50,\n      primaryAttribute: 'attribute_patience'\n    }\n  });\n  registerGameAction('action_read_books', {\n    tags: [\"action\", \"activity\", \"mental\", \"book\"],\n    name: 'Read Books',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Read books to find new information and increase your knowledge',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['books_learning_rate', 'mental_activities_learn_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'knowledge': {\n              A: 0.0015 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('read_books_efficiency'),\n              B: 0.0135 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('read_books_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 1,\n              type: 0\n            },\n            'coins': {\n              A: 0.0,\n              B: 1.5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['read_books_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    attributes: {\n      baseXPCost: 50\n    }\n  });\n  registerGameAction('action_read_mages_handbook', {\n    tags: [\"action\", \"activity\", \"spiritual\", \"book\"],\n    name: 'Read Apprentice Handbook',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Read magic book, providing you precious information about increasing your magic potential. Unfortunately, the text inside is encrypted with runes that you have to de-crypt using spells.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['books_learning_rate'],\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_spell_reading': {\n            A: 1,\n            B: -1,\n            type: 0\n          }\n        }\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0,\n              B: 30.0,\n              type: 0\n            },\n            'mana': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['read_books_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_mages_handbook') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_yoga_practices', {\n    tags: [\"action\", \"training\", \"mental\"],\n    name: 'Yoga Practice',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Practice yoga to train your patience and stamina. Unlocks new activities requiring more patience.',\n    level: 1,\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_patience': {\n              A: 1,\n              B: -1,\n              type: 0\n            },\n            'attribute_stamina': {\n              A: 0.5,\n              B: -0.5,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 2,\n              type: 0\n            },\n            'knowledge': {\n              A: 0.0,\n              B: 0.05,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['read_books_efficiency']\n    },\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['yoga_learn_speed', 'mental_training_learning_rate'],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_yoga_manual') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      displayPerLevel: 1,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_home_errands', {\n    tags: [\"action\", \"activity\", \"routine\"],\n    name: 'Home Errands',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Clean your house, organize things to free more space for coins storage',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'coins_cap_bonus': {\n              A: 0.05,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 3,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_patience',\n      level: 5\n    }],\n    attributes: {\n      baseXPCost: 50,\n      isTraining: true,\n      primaryAttribute: 'attribute_patience'\n    }\n  });\n  registerGameAction('action_dig_vaults', {\n    tags: [\"action\", \"activity\", \"routine\"],\n    name: 'Dig Vaults',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Dig underground vaults to store your coins. Its energy consuming action, but can pay off',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 2.;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'coins_cap_bonus': {\n              A: 0.025,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 20,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_patience',\n      level: 225\n    }],\n    attributes: {\n      baseXPCost: 500,\n      isTraining: true,\n      primaryAttribute: 'attribute_patience'\n    }\n  });\n  registerGameAction('action_learn_anatomy', {\n    tags: [\"action\", \"training\", \"mental\", \"book\"],\n    name: 'Learn Anatomy',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Lear anatomy to better understand your body and improve your energy and health regeneration',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['books_learning_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_recovery': {\n              A: 0.2,\n              B: -0.2,\n              type: 0\n            },\n            'attribute_stamina': {\n              A: 3,\n              B: -3,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 1,\n              type: 0\n            },\n            'knowledge': {\n              A: 0.0,\n              B: 0.25,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['read_books_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_anatomy_book') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      displayPerLevel: 1,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_learn_geography', {\n    tags: [\"action\", \"training\", \"mental\", \"book\"],\n    name: 'Learn Geography',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Lear geography to find better places of finding natural resources',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['books_learning_rate'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'manual_labor_efficiency': {\n              A: 0.005,\n              B: 0.995,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 100,\n              type: 0\n            },\n            'knowledge': {\n              A: 0.0,\n              B: 20,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['read_books_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_geography_book') > 0;\n    },\n    attributes: {\n      baseXPCost: 5000,\n      displayPerLevel: 1,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_learn_languages', {\n    tags: [\"action\", \"training\", \"mental\"],\n    name: 'Learn Languages',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Lear ancient languages to increase book reading related XP',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['mental_training_learning_rate'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'books_learning_rate': {\n              A: 0.1,\n              B: -0.1,\n              type: 0\n            },\n            'attribute_memory': {\n              A: 0.5,\n              B: -0.5,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 2,\n              type: 0\n            },\n            'knowledge': {\n              A: 0.0,\n              B: 0.25,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['read_books_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_vocabulary') > 0;\n    },\n    attributes: {\n      baseXPCost: 50,\n      displayPerLevel: 1,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_endurance_training', {\n    tags: [\"action\", \"training\", \"physical\"],\n    name: 'Train Endurance',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Do some exercises in local gym to improve your body',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['physical_training_learn_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_recovery': {\n              A: 1,\n              B: -1,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 2,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['read_books_efficiency']\n    },\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_pushup',\n      level: 5\n    }],\n    attributes: {\n      baseXPCost: 50,\n      displayPerLevel: 1,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_stamina_training', {\n    tags: [\"action\", \"training\", \"physical\"],\n    name: 'Train Stamina',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Your improved endurance has unlocked a harder but much more efficient way to train your stamina',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['physical_training_learn_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_stamina': {\n              A: 8,\n              B: -8,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['physical_training_learn_speed']\n    },\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_endurance_training',\n      level: 175\n    }],\n    attributes: {\n      baseXPCost: 500,\n      displayPerLevel: 1,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_cardio_training', {\n    tags: [\"action\", \"training\", \"physical\"],\n    name: 'Cardio Training',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Finally, you feel the power in your hands. But still, you feel like you need to train more',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['physical_training_learn_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_recovery': {\n              A: 3,\n              B: -3,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 20,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['physical_training_learn_speed']\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 200\n    }],\n    attributes: {\n      baseXPCost: 500,\n      displayPerLevel: 1,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_deeper_forest', {\n    tags: [\"action\", \"gathering\", \"routine\"],\n    name: 'Walking in Forest',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'More dangerous activity, but searching for plants in less accessible places can pay off',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_berry': {\n              A: 0.004 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.036 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_fly_mushroom': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_aloe_vera': {\n              A: 0.0002 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.0018 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'rare_herbs_loot': {\n              A: 0,\n              B: 0.0004 * getChanceBased(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'), 1.5, 10),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 2,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 0.5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && false;\n    },\n    attributes: {\n      baseXPCost: 50,\n      primaryAttribute: 'attribute_patience',\n      possibleRareHerbs: {\n        'inventory_rare_titanleaf': 1,\n        'inventory_rare_heartroot': 1\n      }\n    }\n  });\n  registerGameAction('action_magic_garden', {\n    tags: [\"action\", \"gathering\", \"routine\"],\n    name: 'Searching in Magic Garden',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Magic garden is told to be planted by some wizard. The wizard was murdered, but his garden keeps growing, providing variety of precious herbs',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_aloe_vera': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_ginseng': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_nightshade': {\n              A: 0.0002 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.0018 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'rare_herbs_loot': {\n              A: 0,\n              B: 0.0004 * getChanceBased(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'), 1.5, 10),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 4,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 2,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_1') > 0 && false;\n    },\n    attributes: {\n      baseXPCost: 50,\n      primaryAttribute: 'attribute_patience',\n      possibleRareHerbs: {\n        'inventory_rare_titanleaf': 1,\n        'inventory_rare_heartroot': 1,\n        'inventory_rare_energloom': 0.5,\n        'inventory_rare_lifebloom': 0.5\n      }\n    }\n  });\n  registerGameAction('action_magic_backyard', {\n    tags: [\"action\", \"gathering\", \"routine\"],\n    name: 'Searching in Mages Backyard',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'There is abandoned mages hut at the edge of settlement. It is told to be very dangerous, but having a lot of unique plants',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_fly_mushroom': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_ginseng': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_nightshade': {\n              A: 0.0002 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.0018 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'rare_herbs_loot': {\n              A: 0,\n              B: 0.0004 * getChanceBased(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'), 1.5, 10),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 20,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0 && false;\n    },\n    attributes: {\n      baseXPCost: 500,\n      primaryAttribute: 'attribute_patience',\n      possibleRareHerbs: {\n        'inventory_rare_titanleaf': 1,\n        'inventory_rare_heartroot': 1,\n        'inventory_rare_azureblossom': 0.5,\n        'inventory_rare_mindspire': 0.5,\n        'inventory_rare_mindroot': 0.5\n      }\n    }\n  });\n  registerGameAction('action_silent_fields', {\n    tags: [\"action\", \"gathering\", \"routine\"],\n    name: 'Searching in Silent Fields',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'TBD',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_harmony_blossom': {\n              A: 0.00001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.00009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_ember_leaf': {\n              A: 0.00001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.00009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_mystic_bloom': {\n              A: 0.00001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.00009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'rare_herbs_loot': {\n              A: 0,\n              B: 0.0004 * getChanceBased(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'), 1.5, 10),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 20,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_3') > 0 && false;\n    },\n    attributes: {\n      baseXPCost: 500,\n      primaryAttribute: 'attribute_patience',\n      possibleRareHerbs: {\n        'inventory_rare_ironvine': 1,\n        'inventory_rare_mindspire': 1,\n        'inventory_rare_verdant_coil': 1\n      }\n    }\n  });\n  registerGameAction('action_dark_forest', {\n    tags: [\"action\", \"gathering\", \"routine\"],\n    name: 'Searching Dark Forest',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Your guild-mates told you about dark forest with some unique plants...',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['routine_learning_speed'],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_fly_mushroom': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_ginseng': {\n              A: 0.001 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.009 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'inventory_nightshade': {\n              A: 0.0002 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              B: 0.0018 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'),\n              type: 0\n            },\n            'rare_herbs_loot': {\n              A: 0,\n              B: 0.0004 * getChanceBased(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('gathering_efficiency'), 1.5, 10),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 40,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 15,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['gathering_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_herbalists') > 0 && false;\n    },\n    attributes: {\n      baseXPCost: 5000,\n      primaryAttribute: 'attribute_patience',\n      possibleRareHerbs: {\n        'inventory_rare_stillfern': 1,\n        'inventory_rare_ironvine': 0.5,\n        'inventory_rare_mindspire': 0.5,\n        'inventory_rare_mindroot': 1\n      }\n    }\n  });\n  registerGameAction('action_meditate', {\n    tags: [\"action\", \"training\", \"magical\", \"spiritual\"],\n    name: 'Meditate',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Use meditative practices to improve your mental abilities',\n    level: 1,\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_magic_ability': {\n            A: 1,\n            B: -1,\n            type: 0\n          },\n          'attribute_patience': {\n            A: 0.25,\n            B: -0.25,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 5.00,\n            type: 0\n          },\n          'knowledge': {\n            A: 0,\n            B: 1.00,\n            type: 0\n          }\n        }\n      },\n      effectDeps: []\n    },\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['spiritual_learning_rate'],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_meditation') > 0;\n    },\n    attributes: {\n      baseXPCost: 100,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_magic_training', {\n    tags: [\"action\", \"training\", \"magical\", \"spiritual\"],\n    name: 'Magic Training',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Improve your magic capability using practices of ancient monks',\n    level: 1,\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_magic_capability': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 5.00,\n            type: 0\n          },\n          'knowledge': {\n            A: 0,\n            B: 1.00,\n            type: 0\n          }\n        }\n      },\n      effectDeps: []\n    },\n    getLearnRate: function getLearnRate() {\n      return 1;\n    },\n    learningEffects: ['spiritual_learning_rate'],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_magic_training') > 0;\n    },\n    attributes: {\n      baseXPCost: 200,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_spiritual_alignment', {\n    tags: [\"action\", \"training\", \"mental\"],\n    name: 'Spiritual Alignment',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spend some time trying to hear the magic inside you. Improve your feeling of yourself',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 1.;\n    },\n    learningEffects: ['mental_training_learning_rate'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'spiritual_learning_rate': {\n              A: 0.05,\n              B: 0.95,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 5,\n              type: 0\n            },\n            'knowledge': {\n              A: 0,\n              B: 2.5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spiritualism') > 0;\n    },\n    attributes: {\n      baseXPCost: 200,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_craft', {\n    tags: [\"action\", \"activity\", \"physical\", \"crafting\"],\n    name: 'Basic Craft',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Dedicate your time and efforts to crafting',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 2;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'crafting_ability': {\n              A: 0.001,\n              B: 0.009,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 5,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 1.5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 100,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('advanced_craft', {\n    tags: [\"action\", \"activity\", \"physical\", \"crafting\"],\n    name: 'Advanced Craft',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spend more time and efforts on crafting advanced things',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 2;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'crafting_ability': {\n              A: 0.005,\n              B: 0.045,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 30,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 10,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 500\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 500,\n      primaryAttribute: 'attribute_strength'\n    }\n  });\n  registerGameAction('action_alchemy', {\n    tags: [\"action\", \"activity\", \"crafting\", \"alchemy\"],\n    name: 'Alchemy',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Spent some time brewing potions',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 2;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'alchemy_ability': {\n              A: 0.001,\n              B: 0.009,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 5,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 1.5,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 100,\n      primaryAttribute: 'attribute_patience'\n    }\n  });\n  registerGameAction('action_meditative_insight', {\n    tags: [\"action\", \"training\", \"magical\", \"spiritual\"],\n    name: 'Meditative Insight',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Engage in a deep meditative practice with the Metaphysics Book, sharpening memory and enhancing mana regeneration by channeling profound knowledge and magical focus.',\n    level: 1,\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_magic_ability': {\n            A: 2,\n            B: -2,\n            type: 0\n          },\n          'attribute_memory': {\n            A: 4,\n            B: -4,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 25.00,\n            type: 0\n          },\n          'knowledge': {\n            A: 0,\n            B: 10.00,\n            type: 0\n          },\n          'mana': {\n            A: 0,\n            B: 5.00,\n            type: 0\n          }\n        }\n      },\n      effectDeps: []\n    },\n    getLearnRate: function getLearnRate() {\n      return 2;\n    },\n    learningEffects: ['spiritual_learning_rate'],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_metaphysics_handbook') > 0;\n    },\n    attributes: {\n      baseXPCost: 1000,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_nail_standing', {\n    tags: [\"action\", \"training\", \"mental\"],\n    name: 'Nail Standing',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'This practice demands immense concentration and endurance as you stand on a board embedded with nails. Through this rigorous discipline, you strengthen both mind and body, enhancing your efficiency in routine tasks.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 5.;\n    },\n    learningEffects: ['mental_training_learning_rate'],\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'routine_learning_speed': {\n              A: 0.02,\n              B: 0.98,\n              type: 0\n            }\n          }\n        };\n      },\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_recovery': {\n              A: 2,\n              B: -2,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 200,\n              type: 0\n            },\n            'health': {\n              A: 0,\n              B: 25,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_patience',\n      level: 350\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 10000,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_charity', {\n    tags: [\"action\", \"activity\", \"social\"],\n    name: 'Charitable Deeds',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Dedicate yourself to helping others selflessly, sacrificing energy and health, but gaining patience and a boost to your charisma in return.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 5.;\n    },\n    learningEffects: [],\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          effects: {\n            'attribute_charisma': {\n              A: 2,\n              B: -2,\n              type: 0\n            },\n            'attribute_patience': {\n              A: 0.5,\n              B: -0.5,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 200,\n              type: 0\n            },\n            'health': {\n              A: 0,\n              B: 25,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_patience',\n      level: 800\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 5000,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_magic_analyzes', {\n    tags: [\"action\", \"training\", \"magical\", \"spiritual\"],\n    name: 'Magic Analysis',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Finally you achieved that point where your brain allows you to understand the nature of magic. Analyze magic, mana and how its used by spells. Its hard and exhausting task, but totally worth it',\n    level: 1,\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_magic_capability': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'energy': {\n            A: 0,\n            B: 225.00,\n            type: 0\n          },\n          'knowledge': {\n            A: 0,\n            B: 50.00,\n            type: 0\n          },\n          'mana': {\n            A: 0,\n            B: 25.00,\n            type: 0\n          }\n        }\n      },\n      effectDeps: []\n    },\n    getLearnRate: function getLearnRate() {\n      return 2;\n    },\n    learningEffects: ['spiritual_learning_rate'],\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_magic_ability',\n      level: 500\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_metaphysics_handbook') > 0;\n    },\n    attributes: {\n      baseXPCost: 1000,\n      isTraining: true\n    }\n  });\n  registerGameAction('action_guild_volunteering', {\n    tags: [\"action\", \"activity\", \"social\", \"guild-activity\"],\n    name: 'Guild Volunteering',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Contribute your time and effort to support guild initiatives, earning reputation and respect.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 4;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'guild_reputation': {\n              A: 0.0005,\n              B: 0.0095,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 80,\n              type: 0\n            },\n            'health': {\n              A: 0.0,\n              B: 40,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('guilds').selectedGuild != null;\n    },\n    attributes: {\n      baseXPCost: 20000\n    }\n  });\n  registerGameAction('action_guild_donations', {\n    tags: [\"action\", \"activity\", \"social\", \"guild-activity\"],\n    name: 'Guild Donations',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Offer monetary support to the guild, boosting your reputation and helping fund its endeavors.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 4;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'guild_reputation': {\n              A: 0.001,\n              B: 0.0019,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 20,\n              type: 0\n            },\n            'coins': {\n              A: 0.0,\n              B: 25000,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('guilds').selectedGuild != null;\n    },\n    attributes: {\n      baseXPCost: 20000\n    }\n  });\n  registerGameAction('action_guild_speech', {\n    tags: [\"action\", \"activity\", \"social\", \"guild-activity\"],\n    name: 'Guild Speech',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Deliver an inspiring speech to guild members, boosting their morale and strengthening your reputation within the guild.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 4;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'guild_reputation': {\n              A: 0.002,\n              B: 0.038,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 400,\n              type: 0\n            },\n            'knowledge': {\n              A: 0.0,\n              B: 200,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 1250\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('guilds').selectedGuild != null;\n    },\n    attributes: {\n      baseXPCost: 20000\n    }\n  });\n  registerGameAction('action_magical_immersion', {\n    tags: [\"action\", \"magical\", \"training\"],\n    name: 'Magical Immersion',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'You delve into the world of magical energies, training your mind to interact with forces beyond ordinary understanding. This is not just a practice  it\\'s a transformation of consciousness.',\n    level: 1,\n    getLearnRate: function getLearnRate() {\n      return 5;\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'mental_activities_learn_rate': {\n              A: 0.01,\n              B: 0.99,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            'energy': {\n              A: 0.0,\n              B: 500,\n              type: 0\n            },\n            'mana': {\n              A: 0.0,\n              B: 250,\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: []\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_magic_ability',\n      level: 2000\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 50000,\n      isTraining: true\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/actions/actions-db.js?");

/***/ }),

/***/ "./src/worker/modules/actions/actions.module.js":
/*!******************************************************!*\
  !*** ./src/worker/modules/actions/actions.module.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ActionsModule: () => (/* binding */ ActionsModule)\n/* harmony export */ });\n/* harmony import */ var _actions_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./actions-db */ \"./src/worker/modules/actions/actions-db.js\");\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _action_lists_submodule__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./action-lists.submodule */ \"./src/worker/modules/actions/action-lists.submodule.js\");\n/* harmony import */ var _shared_utils_math__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/utils/math */ \"./src/worker/shared/utils/math.js\");\n/* harmony import */ var game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! game-framework/src/utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _createForOfIteratorHelper(r, e) { var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t[\"return\"] || t[\"return\"](); } finally { if (u) throw o; } } }; }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\n\n\nvar ActionsModule = /*#__PURE__*/function (_GameModule) {\n  function ActionsModule() {\n    var _this;\n    _classCallCheck(this, ActionsModule);\n    _this = _callSuper(this, ActionsModule);\n    _this.activeActions = [];\n    _this.actions = {};\n    _this.selectedFilterId = 'all';\n    _this.lists = new _action_lists_submodule__WEBPACK_IMPORTED_MODULE_3__.ActionListsSubmodule();\n    _this.focus = null;\n    _this.showHidden = false;\n    _this.searchData = {\n      search: '',\n      selectedScopes: ['name', 'tags']\n    };\n    _this.eventHandler.registerHandler('run-action', function (payload) {\n      if (payload.isForce) {\n        _this.lists.stopList();\n      }\n      _this.setRunningAction(payload.id);\n    });\n    _this.eventHandler.registerHandler('query-actions-data', function (payload) {\n      _this.sendActionsData(_this.selectedFilterId, {\n        searchData: _this.searchData\n      });\n    });\n    _this.eventHandler.registerHandler('query-all-actions', function (payload) {\n      _this.sendAllActions(payload);\n    });\n    _this.eventHandler.registerHandler('query-all-action-tags', function (payload) {\n      _this.sendAllActionTags(payload);\n    });\n    _this.eventHandler.registerHandler('query-actions-unlocks', function () {\n      _this.sendActionsUnlocks();\n    });\n    _this.eventHandler.registerHandler('query-action-details', function (payload) {\n      _this.sendActionDetails(payload.id);\n    });\n    _this.eventHandler.registerHandler('toggle-hidden-action', function (payload) {\n      _this.setActionHidden(payload.id, payload.flag);\n      _this.sendActionsData(_this.selectedFilterId, {\n        searchData: _this.searchData\n      });\n    });\n    _this.eventHandler.registerHandler('toggle-show-hidden', function (payload) {\n      _this.showHidden = payload;\n      _this.sendActionsData(_this.selectedFilterId, {\n        searchData: _this.searchData\n      });\n    });\n    _this.eventHandler.registerHandler('set-selected-actions-filter', function (_ref) {\n      var filterId = _ref.filterId;\n      _this.selectedFilterId = filterId;\n    });\n    _this.eventHandler.registerHandler('set-actions-search', function (_ref2) {\n      var searchData = _ref2.searchData;\n      _this.searchData = searchData;\n    });\n    _this.eventHandler.registerHandler('query-action-xp-breakdown', function (payload) {\n      var eff = undefined;\n      if (_this.isRunningAction(payload.id)) {\n        eff = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntityEfficiency(\"runningAction_\".concat(payload.id));\n      }\n      var breakdowns = _this.getLearningRate(payload.id, eff, true);\n      _this.eventHandler.sendData(\"action-xp-breakdown-\".concat(payload.id), breakdowns);\n    });\n    _this.filters = [{\n      id: 'all',\n      name: 'All',\n      tags: [],\n      isDefault: true\n    }, {\n      id: 'jobs',\n      name: 'Jobs',\n      tags: ['job'],\n      isDefault: true\n    }, {\n      id: 'training',\n      name: 'Training',\n      tags: ['training'],\n      isDefault: true\n    }, {\n      id: 'gathering',\n      name: 'Gathering',\n      tags: ['gathering'],\n      isDefault: true\n    }, {\n      id: 'other_activity',\n      name: 'Activities',\n      tags: ['activity'],\n      isDefault: true\n    }];\n    return _this;\n  }\n  _inherits(ActionsModule, _GameModule);\n  return _createClass(ActionsModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.registerGameEntity('runningAction', {\n        name: 'Idling',\n        level: 0\n      });\n      (0,_actions_db__WEBPACK_IMPORTED_MODULE_0__.registerActionsStage1)();\n      this.actions = {};\n    }\n  }, {\n    key: \"setMonitored\",\n    value: function setMonitored(_ref3) {\n      var type = _ref3.type,\n        id = _ref3.id;\n      if (!id) {\n        this.monitorData = null;\n        return;\n      }\n      this.monitorData = {\n        type: type,\n        id: id\n      };\n    }\n  }, {\n    key: \"getMonitoredData\",\n    value: function getMonitoredData(entity) {\n      if (!this.monitorData || !entity) return null;\n      if (this.monitorData.type === 'attribute') {\n        var _this$actions$entity$, _increment$this$monit;\n        if (entity.attributes.primaryAttribute === this.monitorData.id) {\n          return 'use';\n        }\n        var increment = this.packEffects(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 1, ((_this$actions$entity$ = this.actions[entity.id]) === null || _this$actions$entity$ === void 0 ? void 0 : _this$actions$entity$.level) || 1, true), function (item) {\n          return item.type === 'effects';\n        });\n        if ((_increment$this$monit = increment[this.monitorData.id]) !== null && _increment$this$monit !== void 0 && _increment$this$monit.value) {\n          return 'produce';\n        }\n      }\n      if (this.monitorData.type === 'resource') {\n        var _this$actions$entity$2, _rsEff$this$monitorDa;\n        var rsEff = this.packEffects(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 0, ((_this$actions$entity$2 = this.actions[entity.id]) === null || _this$actions$entity$2 === void 0 ? void 0 : _this$actions$entity$2.level) || 1, true).filter(function (eff) {\n          return eff.type === 'resources';\n        }));\n        if ((_rsEff$this$monitorDa = rsEff[this.monitorData.id]) !== null && _rsEff$this$monitorDa !== void 0 && _rsEff$this$monitorDa.value) {\n          return rsEff[this.monitorData.id].scope === 'consumption' ? 'use' : 'produce';\n        }\n      }\n    }\n  }, {\n    key: \"getActionXPMax\",\n    value: function getActionXPMax(id) {\n      var _this$actions$id$leve, _this$actions$id;\n      var lvl = (_this$actions$id$leve = (_this$actions$id = this.actions[id]) === null || _this$actions$id === void 0 ? void 0 : _this$actions$id.level) !== null && _this$actions$id$leve !== void 0 ? _this$actions$id$leve : 1;\n      return game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAttribute(id, 'baseXPCost', 50) * Math.pow(1.01, lvl - 1) * (0.8 + 0.2 * lvl);\n    }\n  }, {\n    key: \"reassertRunningEfforts\",\n    value: function reassertRunningEfforts(bForce) {\n      var _this2 = this;\n      var totalEffort = this.activeActions.reduce(function (acc, act) {\n        return acc += act.effort;\n      }, 0);\n      if (Math.abs(1.0 - totalEffort) > 1.e-8 || bForce) {\n        var mult = 1. / totalEffort;\n        this.activeActions.forEach(function (act, index) {\n          _this2.activeActions[index].effort *= mult;\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(act.id).modifier.effectFactor = _this2.activeActions[index].effort;\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators.regenerateModifier(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(act.id).modifier.id);\n        });\n      }\n    }\n  }, {\n    key: \"setActionHidden\",\n    value: function setActionHidden(id, flag) {\n      if (!this.actions[id]) {\n        this.actions[id] = {\n          level: 1,\n          xp: 0,\n          focus: {\n            time: 0\n          }\n        };\n      }\n      this.actions[id].isHidden = flag;\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      var _this3 = this;\n      for (var key in this.actions) {\n        this.actions[key].isLeveled = false;\n      }\n      var rareEvents = {\n        herbDrops: {},\n        oreDrops: {}\n      };\n      if (this.activeActions) {\n        this.activeActions.forEach(function (act) {\n          if (!_this3.actions[act.originalId]) {\n            _this3.actions[act.originalId] = {\n              level: 1,\n              xp: 0,\n              focus: {\n                time: 0\n              }\n            };\n          }\n          if (!_this3.actions[act.originalId].focus) {\n            _this3.actions[act.originalId].focus = {\n              time: 0\n            };\n          }\n          if (!_this3.actions[act.originalId].level || Number.isNaN(_this3.actions[act.originalId].level)) {\n            _this3.actions[act.originalId].level = 1;\n          }\n          if (_this3.actions[act.originalId].focus.time < _this3.getFocusCapTime(act.originalId)) {\n            _this3.actions[act.originalId].focus.time += delta * act.effort;\n          }\n          _this3.actions[act.originalId].timeInvested = (_this3.actions[act.originalId].timeInvested || 0) + delta * act.effort;\n          _this3.actions[act.originalId].focus.bonus = _this3.getFocusBonus(_this3.actions[act.originalId].focus.time);\n          var dxp = delta * _this3.getLearningRate(act.id);\n          // console.log('------------: ', act.id, dxp, delta, this.getLearningRate(act.id, undefined, true));\n          _this3.actions[act.originalId].xp += dxp;\n          _this3.actions[act.originalId].xpEarned = (_this3.actions[act.originalId].xpEarned || 0) + dxp;\n          var herbDrops = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAttribute(act.originalId, 'possibleRareHerbs', null);\n          if (herbDrops) {\n            if (!rareEvents['herbDrops']) {\n              rareEvents['herbDrops'] = {};\n            }\n            for (var _key in herbDrops) {\n              rareEvents['herbDrops'][_key] = (rareEvents['herbDrops'][_key] || 0) + herbDrops[_key];\n            }\n          }\n          // console.log('Attempt to level up: ', act.originalId, this.actions, this.getActionXPMax(act.originalId))\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.addResource('mage-xp', dxp);\n          if (_this3.actions[act.originalId].xp >= _this3.getActionXPMax(act.originalId)) {\n            _this3.actions[act.originalId].level++;\n            _this3.actions[act.originalId].xp = 0;\n            game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.setEntityLevel(act.originalId, _this3.actions[act.originalId].level, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.setEntityLevel(act.id, _this3.actions[act.originalId].level, true);\n            console.log('Leveled up: ', game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getLevel(act.id), game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getLevel(act.originalId));\n            _this3.actions[act.originalId].isLeveled = true;\n            if (game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.isCapped(act.originalId)) {\n              _this3.dropRunningAction(act.originalId);\n              _this3.reassertRunningEfforts();\n            }\n            game_framework__WEBPACK_IMPORTED_MODULE_2__.gameCore.getModule('unlock-notifications').generateNotifications();\n            _this3.sendActionsData(_this3.selectedFilterId, {\n              searchData: _this3.searchData\n            });\n          }\n        });\n      }\n      // check for rare loot\n      if (game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('rare_herbs_loot').balance > 0) {\n        var chanceMult = delta * game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('rare_herbs_loot').balance;\n        // console.log('Handling chances for rare loots: ', gameResources.getResource('rare_herbs_loot'), chanceMult);\n        if (Math.random() < chanceMult) {\n          var id = (0,_shared_utils_math__WEBPACK_IMPORTED_MODULE_4__.weightedRandomChoice)(rareEvents['herbDrops']);\n          console.log('Add: ', id, rareEvents['herbDrops']);\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.addResource(id, 1);\n        }\n      }\n      this.lists.tick(game, delta);\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        actions: this.actions,\n        activeActions: this.activeActions,\n        actionLists: this.lists.save(),\n        selectedFilterId: this.selectedFilterId,\n        searchData: this.searchData,\n        focus: this.focus\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {\n      var _this4 = this;\n      for (var key in this.actions) {\n        this.setAction(key, 0, true);\n      }\n      this.actions = {};\n      if (saveObject !== null && saveObject !== void 0 && saveObject.actions) {\n        for (var id in saveObject.actions) {\n          this.setAction(id, saveObject.actions[id].level, true);\n          this.actions[id].xp = saveObject.actions[id].xp;\n          this.actions[id].focus = saveObject.actions[id].focus;\n          this.actions[id].timeInvested = saveObject.actions[id].timeInvested || 0;\n          this.actions[id].xpEarned = saveObject.actions[id].xpEarned || 0;\n          this.actions[id].isHidden = saveObject.actions[id].isHidden || false;\n        }\n      }\n      this.stopRunningActions();\n      if (saveObject !== null && saveObject !== void 0 && saveObject.activeActions) {\n        this.stopRunningActions();\n        saveObject === null || saveObject === void 0 || saveObject.activeActions.forEach(function (a) {\n          _this4.addRunningAction(a.originalId, a.effort);\n        });\n      }\n      if (saveObject !== null && saveObject !== void 0 && saveObject.actionLists) {\n        this.lists.load(saveObject.actionLists);\n      } else {\n        this.lists.load({});\n      }\n      this.selectedFilterId = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.selectedFilterId) || 'all';\n      this.focus = saveObject === null || saveObject === void 0 ? void 0 : saveObject.focus;\n      this.searchData = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.searchData) || {\n        search: '',\n        selectedScopes: ['name', 'tags']\n      };\n      this.sendActionsData(this.selectedFilterId, {\n        searchData: this.searchData\n      });\n    }\n  }, {\n    key: \"setAction\",\n    value: function setAction(actionId, amount) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.setEntityLevel(actionId, amount, bForce);\n      if (!this.actions[actionId]) {\n        this.actions[actionId] = {\n          level: amount,\n          xp: 0\n        };\n      }\n      this.actions[actionId].level = amount;\n    }\n  }, {\n    key: \"getFocusCapTime\",\n    value: function getFocusCapTime(id) {\n      var _Math$pow, _this$isRunningAction;\n      return 15 + (game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('max_focus_time') - 15) * ((_Math$pow = Math.pow((_this$isRunningAction = this.isRunningAction(id)) === null || _this$isRunningAction === void 0 ? void 0 : _this$isRunningAction.effort, 0.25)) !== null && _Math$pow !== void 0 ? _Math$pow : 0);\n    }\n  }, {\n    key: \"getFocusBonus\",\n    value: function getFocusBonus(time) {\n      return 1 + Math.min(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('max_focus_time'), Math.max(0, time - 15)) * 0.1 * 5 / 285;\n    }\n  }, {\n    key: \"getLearningRate\",\n    value: function getLearningRate(id, eff) {\n      var bGetBreakdowns = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var entEff = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntityEfficiency(id);\n      var focusBonus = 1.;\n      var effortMult = 1.;\n      var breakDowns = {};\n      var isRunning = this.isRunningAction(id);\n      if (isRunning) {\n        var _this$actions$gameEnt, _this$actions$id2;\n        // console.log('EffMult: ', id, eff, entEff, eff == null);\n        focusBonus = ((_this$actions$gameEnt = this.actions[game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).copyFromId]) === null || _this$actions$gameEnt === void 0 || (_this$actions$gameEnt = _this$actions$gameEnt.focus) === null || _this$actions$gameEnt === void 0 ? void 0 : _this$actions$gameEnt.bonus) || ((_this$actions$id2 = this.actions[id]) === null || _this$actions$id2 === void 0 || (_this$actions$id2 = _this$actions$id2.focus) === null || _this$actions$id2 === void 0 ? void 0 : _this$actions$id2.bonus) || 1.;\n        if (Math.abs(1 - focusBonus) > game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER) {\n          breakDowns['focus'] = {\n            title: 'Focus',\n            value: focusBonus\n          };\n        }\n        if (Math.abs(1 - isRunning.effort) > game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER) {\n          breakDowns['effort'] = {\n            title: 'Effort',\n            value: isRunning.effort\n          };\n          effortMult = isRunning.effort;\n        }\n      }\n      if (eff == null) {\n        eff = entEff;\n      }\n      var baseXPRate = 1.;\n      if (game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).getLearnRate) {\n        var _gameEntity$getEntity;\n        baseXPRate = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).getLearnRate();\n        breakDowns['base'] = {\n          title: 'Base',\n          value: baseXPRate\n        };\n        // we should list breakdowns here\n        if ((_gameEntity$getEntity = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).learningEffects) !== null && _gameEntity$getEntity !== void 0 && _gameEntity$getEntity.length) {\n          var _iterator = _createForOfIteratorHelper(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).learningEffects),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var effect = _step.value;\n              baseXPRate *= game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue(effect);\n              if (Math.abs(1 - game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue(effect)) > game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER) {\n                breakDowns[effect] = {\n                  title: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffect(effect).name,\n                  value: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue(effect),\n                  breakDown: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffect(effect).breakDown\n                };\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n        }\n      }\n      var primaryEffect = 1.;\n      if (game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).getPrimaryEffect) {\n        var _gameEntity$getEntity2;\n        primaryEffect = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).getPrimaryEffect();\n        // baseXPRate *= gameEntity.getEntity(id).getPrimaryEffect();\n        var pAtt = (_gameEntity$getEntity2 = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).attributes) === null || _gameEntity$getEntity2 === void 0 ? void 0 : _gameEntity$getEntity2.primaryAttribute;\n        breakDowns['primaryAttribute'] = {\n          title: \"Primary Attribute: \".concat(pAtt ? game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffect(pAtt).name : ''),\n          value: primaryEffect\n        };\n      }\n      breakDowns['learning_rate'] = {\n        title: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffect('learning_rate').name,\n        value: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('learning_rate'),\n        breakDown: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffect('learning_rate').breakDown\n      };\n      if (Math.abs(1 - eff) > game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER) {\n        breakDowns['efficiency'] = {\n          title: 'Action Efficiency',\n          value: eff\n        };\n      }\n      var total = baseXPRate * primaryEffect * eff * game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('learning_rate') * focusBonus * effortMult;\n      if (bGetBreakdowns) {\n        console.log('EffMult: ', id, baseXPRate, primaryEffect, eff, game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('learning_rate'), focusBonus, effortMult, total);\n      }\n      if (bGetBreakdowns) {\n        return {\n          breakDowns: breakDowns,\n          total: total\n        };\n      }\n      return total;\n    }\n  }, {\n    key: \"isRunningAction\",\n    value: function isRunningAction(id) {\n      return this.activeActions && this.activeActions.find(function (one) {\n        return one.id === id || one.originalId === id;\n      });\n    }\n  }, {\n    key: \"isRunningActionWithTag\",\n    value: function isRunningActionWithTag(id) {\n      if (!this.activeActions) return false;\n      var _iterator2 = _createForOfIteratorHelper(this.activeActions),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var running = _step2.value;\n          var ent = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(running.originalId);\n          if (ent.tags.includes(id)) return true;\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      return false;\n    }\n  }, {\n    key: \"stopRunningActions\",\n    value: function stopRunningActions() {\n      var _iterator3 = _createForOfIteratorHelper(this.activeActions),\n        _step3;\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var act = _step3.value;\n          if (this.actions[act.originalId]) {\n            this.actions[act.originalId].focus = null;\n          }\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n      this.activeActions = [];\n      var runningEntities = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['runningActions']);\n      runningEntities.forEach(function (e) {\n        game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.unsetEntity(e.id);\n      });\n    }\n  }, {\n    key: \"addRunningAction\",\n    value: function addRunningAction(id, effort) {\n      var _this$actions$id$leve2, _this$actions$id3, _this$actions$id$leve3, _this$actions$id4;\n      if (!id) {\n        return;\n      }\n      var isCapped = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.isCapped(id);\n      if (isCapped) {\n        return;\n      }\n      var rn = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.registerGameEntity(\"runningAction_\".concat(id), {\n        copyFromId: id,\n        level: (_this$actions$id$leve2 = (_this$actions$id3 = this.actions[id]) === null || _this$actions$id3 === void 0 ? void 0 : _this$actions$id3.level) !== null && _this$actions$id$leve2 !== void 0 ? _this$actions$id$leve2 : 1,\n        allowedImpacts: ['resources'],\n        tags: ['running', 'runningActions'],\n        effectFactor: effort,\n        unlockedBy: undefined\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.setEntityLevel(\"runningAction_\".concat(id), (_this$actions$id$leve3 = (_this$actions$id4 = this.actions[id]) === null || _this$actions$id4 === void 0 ? void 0 : _this$actions$id4.level) !== null && _this$actions$id$leve3 !== void 0 ? _this$actions$id$leve3 : 1);\n      this.activeActions.push({\n        id: \"runningAction_\".concat(id),\n        originalId: id,\n        effort: effort\n      });\n      console.log('CLL: ', this.activeActions, rn);\n    }\n  }, {\n    key: \"dropRunningAction\",\n    value: function dropRunningAction(id) {\n      var _this$actions$id5;\n      if (!this.isRunningAction(id)) return;\n      var index = this.activeActions.findIndex(function (one) {\n        return one.originalId === id;\n      });\n      if (index < 0) {\n        throw new Error(\"Woops! Can't find action by originalId \".concat(id));\n      }\n      if ((_this$actions$id5 = this.actions[id]) !== null && _this$actions$id5 !== void 0 && _this$actions$id5.focus) {\n        this.actions[id].focus = null;\n      }\n      this.activeActions.splice(index, 1);\n      game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.unsetEntity(\"runningAction_\".concat(id));\n    }\n  }, {\n    key: \"setRunningAction\",\n    value: function setRunningAction(id) {\n      console.log('Running: ', id);\n      this.stopRunningActions();\n      this.addRunningAction(id, 1);\n    }\n  }, {\n    key: \"getActionsUnlocks\",\n    value: function getActionsUnlocks() {\n      var items = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['action']).filter(function (one) {\n        return one.isUnlocked && !one.isCapped && one.nextUnlock;\n      }).map(function (one) {\n        return _objectSpread(_objectSpread({}, one), {}, {\n          eta: (0,_shared_utils_math__WEBPACK_IMPORTED_MODULE_4__.calculateTimeToLevelUp)(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAttribute(one.id, 'baseXPCost'), 0.2, one.level, one.nextUnlock.level)\n        });\n      });\n      return items;\n    }\n  }, {\n    key: \"calculateAnalyticalETA\",\n    value: function calculateAnalyticalETA(currentLevel, targetLevel, baseCost) {\n      var xpRate = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var cxp = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n      if (!currentLevel) {\n        currentLevel = 1;\n      }\n      var ln = Math.log;\n      var a = baseCost;\n      var logFactor = ln(1.01);\n      function integralAtLevel(x) {\n        var term1 = Math.pow(1.01, x) / logFactor;\n        var term2 = 0.2 * x * Math.pow(1.01, x) / logFactor;\n        var term3 = 0.2 * Math.pow(1.01, x) / (logFactor * logFactor);\n        return a * (term1 + term2 - term3);\n      }\n\n      // Calculate the integral difference for levels U and L\n      var totalXP = integralAtLevel(targetLevel) - integralAtLevel(currentLevel);\n      var eta = (totalXP - cxp) / xpRate;\n      return eta;\n    }\n  }, {\n    key: \"findNextKeypoints\",\n    value: function findNextKeypoints(currentLevel, max) {\n      var keypoints = [];\n      [25, 50, 100].forEach(function (divisor) {\n        var nextKeypoint = Math.ceil(currentLevel / divisor) * divisor;\n        if (nextKeypoint === currentLevel) {\n          nextKeypoint += divisor;\n        }\n        if (keypoints.includes(nextKeypoint)) {\n          nextKeypoint += divisor;\n        }\n        if (max && nextKeypoint > max) {\n          nextKeypoint = max;\n        }\n        keypoints.push(nextKeypoint);\n      });\n      return _toConsumableArray(new Set(keypoints)).sort(function (a, b) {\n        return a - b;\n      });\n    }\n  }, {\n    key: \"getEtas\",\n    value: function getEtas(id) {\n      var _this5 = this;\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id);\n      var xpRate = this.isRunningAction(entity.id) ? this.getLearningRate(\"runningAction_\".concat(entity.id)) : this.getLearningRate(entity.id, 1);\n      var keypoints = this.findNextKeypoints(entity.level, game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntityMaxLevel(id));\n      var etaResults = {};\n      keypoints.forEach(function (keypoint) {\n        var _this5$actions$id;\n        var eta = _this5.calculateAnalyticalETA(entity.level, keypoint, entity.attributes.baseXPCost, xpRate, (_this5$actions$id = _this5.actions[id]) === null || _this5$actions$id === void 0 ? void 0 : _this5$actions$id.xp);\n        etaResults[keypoint] = eta;\n      });\n      return etaResults;\n    }\n  }, {\n    key: \"matchActionSearch\",\n    value: function matchActionSearch(one, searchData) {\n      var _one$searchableMeta, _one$searchableMeta2, _one$searchableMeta3, _one$searchableMeta4;\n      if (!searchData) return true;\n      var search = searchData.search,\n        selectedScopes = searchData.selectedScopes;\n      if (!search) return true;\n      if (selectedScopes.includes('name') && one.name.toLowerCase().includes(search)) return true;\n      if (selectedScopes.includes('tags') && one.tags && one.tags.some(function (tag) {\n        return tag.includes(search);\n      })) return true;\n      if (selectedScopes.includes('description') && one.description && one.description.toLowerCase().includes(search)) return true;\n      if (selectedScopes.includes('resources') && (_one$searchableMeta = one.searchableMeta) !== null && _one$searchableMeta !== void 0 && _one$searchableMeta['resources'] && (_one$searchableMeta2 = one.searchableMeta) !== null && _one$searchableMeta2 !== void 0 && _one$searchableMeta2['resources'].some(function (tag) {\n        return tag.includes(search.toLowerCase());\n      })) return true;\n      if (selectedScopes.includes('effects') && (_one$searchableMeta3 = one.searchableMeta) !== null && _one$searchableMeta3 !== void 0 && _one$searchableMeta3['effects'] && (_one$searchableMeta4 = one.searchableMeta) !== null && _one$searchableMeta4 !== void 0 && _one$searchableMeta4['effects'].some(function (tag) {\n        return tag.includes(search.toLowerCase());\n      })) return true;\n      return false;\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      // NOW - check for actions if they have any new notifications\n      this.filters.forEach(function (filter) {\n        var actions = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['action'].concat(_toConsumableArray(filter.tags)));\n        actions.forEach(function (action) {\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameCore.getModule('unlock-notifications').registerNewNotification('actions', filter.id, action.id, action.isUnlocked && !action.isCapped);\n        });\n      });\n    }\n  }, {\n    key: \"getActionsData\",\n    value: function getActionsData(filterId, options) {\n      var _this6 = this;\n      if (!filterId) {\n        filterId = 'all';\n      }\n      // const entities = gameEntity.listEntitiesByTags(['action']).filter(one => one.isUnlocked && !one.isCapped);\n      var perCats = this.filters.reduce(function (acc, filter) {\n        acc[filter.id] = {\n          id: filter.id,\n          name: filter.name,\n          tags: filter.tags,\n          items: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['action'].concat(_toConsumableArray(filter.tags))).filter(function (one) {\n            var _this6$actions;\n            return one.isUnlocked && !one.isCapped && ((options === null || options === void 0 ? void 0 : options.showHidden) || _this6.showHidden || !((_this6$actions = _this6.actions) !== null && _this6$actions !== void 0 && (_this6$actions = _this6$actions[one.id]) !== null && _this6$actions !== void 0 && _this6$actions.isHidden)) && _this6.matchActionSearch(one, options.searchData);\n          }),\n          isSelected: filterId === filter.id\n        };\n        return acc;\n      }, {});\n      if (!filterId) {\n        filterId = 'all';\n      }\n      var entities = perCats[filterId].items;\n      var available = entities.map(function (entity) {\n        var _this6$actions$entity, _this6$actions$entity2, _this6$actions$entity3, _this6$actions$entity4, _this6$actions$entity5, _this6$actions$entity6, _this6$actions$entity7, _this6$actions2;\n        return {\n          id: entity.id,\n          name: entity.name,\n          description: entity.description,\n          max: entity.getMaxLevel ? entity.getMaxLevel() : entity.maxLevel || 0,\n          level: ((_this6$actions$entity = _this6.actions[entity.id]) === null || _this6$actions$entity === void 0 ? void 0 : _this6$actions$entity.level) || 1,\n          affordable: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAffordable(entity.id),\n          // potentialEffects: gameEntity.getEffects(entity.id, gameEntity.getAttribute(entity.id, 'isTraining') ? 1 : 0, this.actions[entity.id]?.level || 1, true),\n          xp: ((_this6$actions$entity2 = _this6.actions[entity.id]) === null || _this6$actions$entity2 === void 0 ? void 0 : _this6$actions$entity2.xp) || 0,\n          maxXP: _this6.getActionXPMax(entity.id),\n          isActive: _this6.isRunningAction(entity.id),\n          xpRate: _this6.isRunningAction(entity.id) ? _this6.getLearningRate(\"runningAction_\".concat(entity.id)) : _this6.getLearningRate(entity.id, 1),\n          isLeveled: (_this6$actions$entity3 = _this6.actions[entity.id]) === null || _this6$actions$entity3 === void 0 ? void 0 : _this6$actions$entity3.isLeveled,\n          tags: entity.tags,\n          focused: _this6.isRunningAction(entity.id) && ((_this6$actions$entity4 = _this6.actions[entity.id]) === null || _this6$actions$entity4 === void 0 || (_this6$actions$entity4 = _this6$actions$entity4.focus) === null || _this6$actions$entity4 === void 0 ? void 0 : _this6$actions$entity4.bonus) > 1 ? {\n            isFocused: true,\n            focusTime: _this6.actions[entity.id].focus.time,\n            focusBonus: _this6.actions[entity.id].focus.bonus,\n            isCapped: _this6.actions[entity.id].focus.time >= _this6.getFocusCapTime(entity.id),\n            cap: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('max_focus_time') * _this6.isRunningAction(entity.id).effort\n          } : null,\n          actionEffect: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 0, ((_this6$actions$entity5 = _this6.actions[entity.id]) === null || _this6$actions$entity5 === void 0 ? void 0 : _this6$actions$entity5.level) || 1, true).filter(function (eff) {\n            return eff.type === 'resources';\n          }),\n          potentialEffects: _this6.packEffects(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 1, ((_this6$actions$entity6 = _this6.actions[entity.id]) === null || _this6$actions$entity6 === void 0 ? void 0 : _this6$actions$entity6.level) || 1, true), function (item) {\n            return item.type === 'effects';\n          }),\n          currentEffects: _this6.packEffects(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 0, ((_this6$actions$entity7 = _this6.actions[entity.id]) === null || _this6$actions$entity7 === void 0 ? void 0 : _this6$actions$entity7.level) || 1, true), function (item) {\n            return item.type === 'effects';\n          }),\n          isTraining: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAttribute(entity.id, 'isTraining'),\n          isHidden: (_this6$actions2 = _this6.actions) === null || _this6$actions2 === void 0 || (_this6$actions2 = _this6$actions2[entity.id]) === null || _this6$actions2 === void 0 ? void 0 : _this6$actions2.isHidden,\n          monitored: _this6.getMonitoredData(entity)\n        };\n      });\n      var current = this.activeActions ? available.filter(function (one) {\n        return _this6.activeActions.some(function (act) {\n          return act.originalId === one.id;\n        });\n      }) : null;\n      return {\n        available: available,\n        current: current,\n        showHidden: this.showHidden,\n        actionLists: this.lists.getLists(),\n        runningList: this.lists.runningList,\n        actionListsUnlocked: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getLevel('shop_item_notebook') > 0,\n        actionCategories: Object.values(perCats).filter(function (cat) {\n          return cat.items.length > 0;\n        }),\n        automationEnabled: this.lists.automationEnabled,\n        autotriggerIntervalSetting: this.lists.autotriggerIntervalSetting,\n        searchData: this.searchData,\n        selectedCategory: filterId\n      };\n    }\n  }, {\n    key: \"packEffects\",\n    value: function packEffects(effects) {\n      var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (item) {\n        return true;\n      };\n      var result = effects.filter(filter).reduce(function (acc, item) {\n        acc[item.id] = item;\n        return acc;\n      }, {});\n      return result;\n    }\n  }, {\n    key: \"getActionData\",\n    value: function getActionData(id) {\n      var _this$actions$entity$3, _this$actions$entity$4, _this$actions$entity$5, _this$actions$entity$6, _this$actions$entity$7, _this$actions$entity$8, _entity$attributes, _entity$attributes2, _this$actions$entity$9, _this$actions$entity$10;\n      if (!id) {\n        return null;\n      }\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['action']);\n      var entity = entities.find(function (one) {\n        return one.id === id;\n      });\n      var entityData = {\n        id: entity.id,\n        name: entity.name,\n        description: entity.description,\n        max: entity.getMaxLevel ? entity.getMaxLevel() : entity.maxLevel || 0,\n        level: ((_this$actions$entity$3 = this.actions[entity.id]) === null || _this$actions$entity$3 === void 0 ? void 0 : _this$actions$entity$3.level) || 1,\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAffordable(entity.id),\n        actionEffect: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 0, ((_this$actions$entity$4 = this.actions[entity.id]) === null || _this$actions$entity$4 === void 0 ? void 0 : _this$actions$entity$4.level) || 1, true).filter(function (eff) {\n          return eff.type === 'resources';\n        }),\n        potentialEffects: this.packEffects(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 1, ((_this$actions$entity$5 = this.actions[entity.id]) === null || _this$actions$entity$5 === void 0 ? void 0 : _this$actions$entity$5.level) || 1, true), function (item) {\n          return item.type === 'effects';\n        }),\n        currentEffects: this.packEffects(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 0, ((_this$actions$entity$6 = this.actions[entity.id]) === null || _this$actions$entity$6 === void 0 ? void 0 : _this$actions$entity$6.level) || 1, true), function (item) {\n          return item.type === 'effects';\n        }),\n        xp: ((_this$actions$entity$7 = this.actions[entity.id]) === null || _this$actions$entity$7 === void 0 ? void 0 : _this$actions$entity$7.xp) || 0,\n        maxXP: this.getActionXPMax(entity.id),\n        isActive: this.isRunningAction(entity.id),\n        xpRate: this.isRunningAction(entity.id) ? this.getLearningRate(\"runningAction_\".concat(entity.id)) * this.isRunningAction(entity.id).effort : this.getLearningRate(entity.id, 1),\n        isLeveled: (_this$actions$entity$8 = this.actions[entity.id]) === null || _this$actions$entity$8 === void 0 ? void 0 : _this$actions$entity$8.isLeveled,\n        tags: entity.tags,\n        primaryAttribute: (_entity$attributes = entity.attributes) !== null && _entity$attributes !== void 0 && _entity$attributes.primaryAttribute ? game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffect(entity.attributes.primaryAttribute) : null,\n        primaryAttributeEffect: (_entity$attributes2 = entity.attributes) !== null && _entity$attributes2 !== void 0 && _entity$attributes2.primaryAttribute ? entity.getPrimaryEffect() : 1,\n        isTraining: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAttribute(entity.id, 'isTraining'),\n        nextUnlock: entity.nextUnlock,\n        timeInvested: ((_this$actions$entity$9 = this.actions[entity.id]) === null || _this$actions$entity$9 === void 0 ? void 0 : _this$actions$entity$9.timeInvested) || 0,\n        xpEarned: ((_this$actions$entity$10 = this.actions[entity.id]) === null || _this$actions$entity$10 === void 0 ? void 0 : _this$actions$entity$10.xpEarned) || 0,\n        etas: this.getEtas(entity.id)\n      };\n      return entityData;\n    }\n  }, {\n    key: \"getEffectFromRunningAction\",\n    value: function getEffectFromRunningAction(id) {\n      var runningActions = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['runningActions']);\n      var results = [];\n      runningActions.forEach(function (entity) {\n        var effts = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id);\n        console.log('Queried effects: ', effts);\n        var suitable = effts.filter(function (u) {\n          return u.type === 'effects' && u.id === id;\n        });\n        // now that we have suitable action added - need to understand it inputs (effort, xpRate and so on...)\n\n        results.push(suitable);\n      });\n      return results;\n    }\n  }, {\n    key: \"getAllActions\",\n    value: function getAllActions() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['action']).map(function (one) {\n        return _objectSpread(_objectSpread({}, one), {}, {\n          isUnlocked: one.isUnlocked && !one.isCapped\n        });\n      });\n    }\n  }, {\n    key: \"sendAllActions\",\n    value: function sendAllActions(payload) {\n      var data = this.getAllActions();\n      var label = 'all-actions';\n      if (payload !== null && payload !== void 0 && payload.prefix) {\n        label = \"\".concat(label, \"-\").concat(payload === null || payload === void 0 ? void 0 : payload.prefix);\n      }\n      this.eventHandler.sendData(label, data);\n    }\n  }, {\n    key: \"getAllActionTags\",\n    value: function getAllActionTags() {\n      var allActions = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['action']);\n      var tagsByUnlocks = {};\n      allActions.forEach(function (a) {\n        a.tags.forEach(function (tag) {\n          var _tagsByUnlocks$tag;\n          tagsByUnlocks[tag] = {\n            id: tag,\n            name: tag,\n            isUnlocked: ((_tagsByUnlocks$tag = tagsByUnlocks[tag]) === null || _tagsByUnlocks$tag === void 0 ? void 0 : _tagsByUnlocks$tag.isUnlocked) || a.isUnlocked && !a.isCapped\n          };\n        });\n      });\n      return Object.values(tagsByUnlocks);\n    }\n  }, {\n    key: \"sendAllActionTags\",\n    value: function sendAllActionTags(payload) {\n      var data = this.getAllActionTags();\n      var label = 'all-action-tags';\n      if (payload !== null && payload !== void 0 && payload.prefix) {\n        label = \"\".concat(label, \"-\").concat(payload === null || payload === void 0 ? void 0 : payload.prefix);\n      }\n      this.eventHandler.sendData(label, data);\n    }\n  }, {\n    key: \"sendActionsData\",\n    value: function sendActionsData(filterId) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var data = this.getActionsData(filterId, options);\n      this.eventHandler.sendData('actions-data', data);\n    }\n  }, {\n    key: \"sendActionDetails\",\n    value: function sendActionDetails(id) {\n      var data = this.getActionData(id);\n      this.eventHandler.sendData('action-details', data);\n    }\n  }, {\n    key: \"sendActionsUnlocks\",\n    value: function sendActionsUnlocks() {\n      var data = this.getActionsUnlocks();\n      this.eventHandler.sendData('actions-unlocks', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_1__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/actions/actions.module.js?");

/***/ }),

/***/ "./src/worker/modules/attributes/attributes-db.js":
/*!********************************************************!*\
  !*** ./src/worker/modules/attributes/attributes-db.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerAttributes: () => (/* binding */ registerAttributes)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerAttributes = function registerAttributes() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_strength', {\n    name: 'Strength',\n    description: 'Strength impacts on physical activities efficiency and increase energy cap. Higher level unlocks more physical activities',\n    minValue: 1,\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'physical']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_stamina', {\n    name: 'Stamina',\n    description: 'Stamina impacts on how fast you can restore your energy',\n    minValue: 1,\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'physical']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_vitality', {\n    name: 'Vitality',\n    description: 'Vitality improves your health maximum',\n    minValue: 1,\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'physical']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_charisma', {\n    name: 'Charisma',\n    description: 'Charisma improves your communication skills and interaction with other people and decrease shop prices. Higher level unlocks more social activities',\n    minValue: 1,\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'mental']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_bargaining', {\n    name: 'Bargaining',\n    description: 'Bargaining attribute slightly increase your coins income from all sources',\n    minValue: 1,\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'mental']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_patience', {\n    name: 'Patience',\n    description: 'Patience impacts on your ability on focusing on routine tasks, increasing their learning speed. Higher level unlocks more gathering and routine activities',\n    minValue: 1,\n    defaultValue: 1,\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'mental']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_recovery', {\n    name: 'Recovery',\n    description: 'Improves your health regeneration',\n    minValue: 1,\n    defaultValue: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_anatomy_book') > 0 || game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_endurance_training') > 0;\n    },\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'physical']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_memory', {\n    name: 'Memory',\n    description: 'Improves your knowledge capacity',\n    minValue: 1,\n    defaultValue: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'mental']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_magic_ability', {\n    name: 'Magic Ability',\n    description: 'Improves your mana regeneration',\n    minValue: 1,\n    defaultValue: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'magical']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_magic_capability', {\n    name: 'Magic Capabilty',\n    description: 'Improves your mana capacity',\n    minValue: 1,\n    defaultValue: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_magic_training') > 0;\n    },\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'magical']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('attribute_spell_reading', {\n    name: 'Spell Reading ',\n    description: 'Improves your spell learning rate',\n    minValue: 1,\n    defaultValue: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_mages_handbook') > 0;\n    },\n    hasCap: false,\n    saveBalanceTree: true,\n    tags: ['attribute', 'magical']\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/attributes/attributes-db.js?");

/***/ }),

/***/ "./src/worker/modules/attributes/attributes.module.js":
/*!************************************************************!*\
  !*** ./src/worker/modules/attributes/attributes.module.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AttributesModule: () => (/* binding */ AttributesModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _attributes_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./attributes-db */ \"./src/worker/modules/attributes/attributes-db.js\");\n/* harmony import */ var game_framework_src_utils_unlocks__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! game-framework/src/utils/unlocks */ \"./node_modules/game-framework/src/utils/unlocks.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar AttributesModule = /*#__PURE__*/function (_GameModule) {\n  function AttributesModule() {\n    var _this;\n    _classCallCheck(this, AttributesModule);\n    _this = _callSuper(this, AttributesModule);\n    _this.eventHandler.registerHandler('query-attributes-data', function (payload) {\n      _this.sendAttributesData();\n    });\n    _this.eventHandler.registerHandler('query-attributes-unlocks', function (payload) {\n      _this.sendAttributesUnlocks();\n    });\n    return _this;\n  }\n  _inherits(AttributesModule, _GameModule);\n  return _createClass(AttributesModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      (0,_attributes_db__WEBPACK_IMPORTED_MODULE_2__.registerAttributes)();\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {}\n  }, {\n    key: \"save\",\n    value: function save() {}\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {}\n  }, {\n    key: \"getAttributesUnlocks\",\n    value: function getAttributesUnlocks() {\n      console.log('Attrs: ', game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.listEffectsByTags(['attribute']), game_framework_src_utils_unlocks__WEBPACK_IMPORTED_MODULE_3__.gameUnlocks.unlockMapping);\n      var items = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.listEffectsByTags(['attribute']).filter(function (one) {\n        return one.isUnlocked && one.nextUnlock;\n      }).map(function (one) {\n        // Here we should somehow get current increment of attribute\n        // first of all we should get current income from list\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').getEffectFromRunningAction(one.id);\n        console.log('Effects: ', one);\n        return _objectSpread({}, one);\n      });\n      return items;\n    }\n  }, {\n    key: \"getAttributesData\",\n    value: function getAttributesData() {\n      var effects = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.listEffectsByTags(['attribute']);\n      var list = effects.filter(function (one) {\n        return one.isUnlocked;\n      }).map(function (effect) {\n        return _objectSpread({}, effect);\n      });\n      return {\n        list: list\n      };\n    }\n  }, {\n    key: \"sendAttributesUnlocks\",\n    value: function sendAttributesUnlocks() {\n      var data = this.getAttributesUnlocks();\n      this.eventHandler.sendData('attributes-unlocks', data);\n    }\n  }, {\n    key: \"sendAttributesData\",\n    value: function sendAttributesData() {\n      var data = this.getAttributesData();\n      this.eventHandler.sendData('attributes-data', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/attributes/attributes.module.js?");

/***/ }),

/***/ "./src/worker/modules/general/random-events-db.js":
/*!********************************************************!*\
  !*** ./src/worker/modules/general/random-events-db.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   randomEventScalingFactor: () => (/* binding */ randomEventScalingFactor),\n/* harmony export */   registerRandomEventsDb: () => (/* binding */ registerRandomEventsDb)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar randomEventScalingFactor = function randomEventScalingFactor(id) {\n  var level = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(id);\n  var result = Math.pow(1 + level, 1.5);\n  if (level > 100) {\n    result *= Math.pow(1.03, level);\n  }\n  return result;\n};\nvar registerRandomEventsDb = function registerRandomEventsDb() {\n  var randomEventsDB = [];\n  randomEventsDB.push({\n    id: 'early_event1',\n    name: 'Lost Coin',\n    description: 'As you stroll through the forest, the sunlight catches something shiny beneath a pile of leaves. It appears to be an old, golden coin, its edges worn smooth by time. Do you take a closer look or move on?',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Pick it up',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'gain_gold',\n          probability: 0.7,\n          description: 'You gain 10 gold. The coin glows faintly as you pick it up, and a warm feeling spreads through your fingers. Its as if the coin is thanking you for finding it.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', 10);\n          }\n        }, {\n          id: 'gain_gold2',\n          probability: 0.2,\n          description: 'You gain 25 gold. As you brush off the dirt, you notice intricate carvings on the coins surface. It seems ancient and valuable, almost as if it has seen centuries of trade.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', 25);\n          }\n        }, {\n          id: 'gain_gold3',\n          probability: 0.1,\n          description: 'You gain 50 gold. You uncover a coin of remarkable craftsmanship, its edges sharp and gleaming. You cant help but wonder if its worth more than its weight in gold.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', 50);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Ignore it',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      },\n      option3: {\n        id: 'option3',\n        name: 'Inspect further',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'lose_gold',\n          probability: 0.5,\n          description: 'A hidden snare tightens around your leg! You lose some gold in your scramble to escape.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -0.5 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').amount);\n          }\n        }, {\n          id: 'gain_experience',\n          probability: 0.5,\n          description: 'With careful hands, you uncover a trap and disarm it. Your cleverness earns you some experience points.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mage-xp', 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('mage-xp').cap + 10);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event2',\n    name: 'Energy Surge',\n    description: 'A vibrant energy hums in the clearing before you, as though the earth itself were breathing. The air shimmers with a faint glow, and the pull of its power is undeniable. How will you respond?',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Embrace it',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'gain_energy',\n          probability: 0.7,\n          description: 'You draw the energy into yourself, feeling strength course through your veins. (+75% energy refill)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', 0.75 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n          }\n        }, {\n          id: 'lose_energy',\n          probability: 0.3,\n          description: 'The surge overwhelms you! Energy leaks from your body, leaving you weaker. (Lost all your energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.setResource('energy', 0);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Resist it',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      },\n      option3: {\n        id: 'option3',\n        name: 'Channel it',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'energy_regeneration_bonus',\n          probability: 1,\n          description: 'You focus the energy carefully, unlocking a steady flow of vitality. (+Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            // register entity with effect\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energized');\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event3',\n    name: 'Golden Opportunity',\n    description: 'At the edge of the bustling square, a merchant draped in colorful silks waves you over. His voice is silky and persuasive as he offers a deal that seems too good to be true.',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Take the deal',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'bonus_gold',\n          probability: 0.8,\n          description: 'The deal pays off handsomely! Your gold income increases for the next 5 minutes.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            console.log('Gold income bonus activated.');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_coins_bonus');\n          }\n        }, {\n          id: 'lose_gold',\n          probability: 0.2,\n          description: 'The merchant smirks and disappears into the crowd. You lose some of your coins.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -0.5 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').amount);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Refuse',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event4',\n    name: 'Fatigue',\n    description: 'The day wears on, and every step feels heavier than the last. The ground looks soft and inviting, while a nearby tree offers shade and calm. What will you do?',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Rest',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'energy_regeneration_bonus',\n          probability: 1,\n          description: 'You lie down and let sleep take you. You wake up refreshed, energy restored. (+Energy regeneration bonus)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energized');\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Meditate',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'gain_experience',\n          probability: 1,\n          description: 'You focus your mind and reflect on the journey. (Gained some experience)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            console.log('You gained 20 experience.');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mage-xp', 20 + 0.01 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('mage-xp').cap);\n          }\n        }, {\n          id: 'lose_energy',\n          probability: 1,\n          description: 'Meditation proves taxing, and you feel your energy drain away.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            console.log('You lost energy.');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.setResource('energy', 0.1);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event5',\n    name: 'Hidden Talent',\n    description: 'As you work, your hands move with unexpected precision, and ideas flow easily. Could this be a hidden talent emerging, or just a fleeting moment of clarity?',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Nurture it',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'learning_speed_bonus',\n          probability: 1,\n          description: 'You hone your new skill, gaining a temporary boost to your learning speed. (+Learning speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            console.log('Learning speed bonus activated.');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_learn_rate');\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Ignore it',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event6',\n    name: 'Ancient Shrine',\n    description: 'You come across an ancient shrine, covered in moss and glowing faintly. A voice whispers in your mind, asking for a sacrifice to unlock hidden potential. What will you do?',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Offer Gold',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 50 * randomEventScalingFactor('random_events_strength_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'gain_strength',\n          probability: 0.6,\n          description: 'The shrine accepts your offering, and you feel your muscles strengthen. (+1 Strength)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            // set permanent attribute modifier\n            // gameResources.addResource('strength', 1);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_strength_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_strength_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -50 * randomEventScalingFactor('random_events_strength_effect'));\n          }\n        }, {\n          id: 'fail_offering',\n          probability: 0.4,\n          description: 'The shrine remains silent, and your gold disappears into the void.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -50 * randomEventScalingFactor('random_events_strength_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Ignore the Shrine',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event7',\n    name: 'Cursed Mirror',\n    description: 'A beautifully ornate mirror lies shattered on the ground. A strange aura surrounds it. You sense a powerful presence that could grant you untold power... at a cost.',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Touch the Mirror',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 5 * randomEventScalingFactor('random_events_stamina_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'gain_stamina',\n          probability: 0.7,\n          description: 'The mirror binds to your soul, granting you increased stamina. (+1 Stamina, -50% energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_stamina_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_stamina_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -5 * randomEventScalingFactor('random_events_stamina_effect'));\n          }\n        }, {\n          id: 'mirror_shatters',\n          probability: 0.3,\n          description: 'The mirror shatters violently, draining your energy completely.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.setResource('energy', 0);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Walk Away',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event8',\n    name: 'The Wandering Monk',\n    description: 'A wandering monk approaches, offering to teach you a secret technique in exchange for some of your wealth. Do you accept?',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Pay the Monk',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 100,\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'permanent_learning_bonus',\n          probability: 0.5,\n          description: 'The monk shares his wisdom, and you feel your mind expand. Your learning rate temporarily increased',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_learn_rate', 4);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -100);\n          }\n        }, {\n          id: 'fraudulent_monk',\n          probability: 0.5,\n          description: 'The monk disappears after taking your gold. You gain nothing.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -100);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Refuse the Offer',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event9',\n    name: 'Trial of the Flame',\n    description: 'A ring of fire encircles you, and a booming voice challenges you to endure its heat to prove your worth.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 1;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Endure the Flames',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                health: {\n                  A: 0,\n                  B: 0.5 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap,\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'gain_strength',\n          probability: 0.2,\n          description: 'You endure the pain and emerge stronger. (+1 Strength, -50% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_strength_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_strength_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.5 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n          }\n        }, {\n          id: 'fail_trial',\n          probability: 0.8,\n          description: 'The heat is too much, and you collapse from exhaustion. (-75% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.75 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Retreat from the Challenge',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event10',\n    name: 'Healing Springs',\n    description: 'You discover a bubbling spring with sparkling, crystal-clear water. A sign nearby reads: \"Drink and be rejuvenated, but beware the cost.\"',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 1;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Drink the Water',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_health_regeneration',\n          probability: 0.8,\n          description: 'The water fills you with vitality. (+Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_regen');\n          }\n        }, {\n          id: 'negative_effect',\n          probability: 0.2,\n          description: 'The water was tainted, and you feel drained. (-50% energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.5 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Avoid the Spring',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event11',\n    name: 'Training Grounds',\n    description: 'An old warrior invites you to train with him, promising valuable insights into strength-building techniques.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 1;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Accept the Training',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_strength_training_bonus',\n          probability: 0.7,\n          description: 'The warriors advice sharpens your focus. (+Strength training speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_physical_training_rate');\n          }\n        }, {\n          id: 'injury',\n          probability: 0.3,\n          description: 'You overexert yourself and suffer a minor injury. (-10% HP, you are injured)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff');\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Decline the Offer',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event12',\n    name: 'Blessing of Endurance',\n    description: 'A wandering priest offers to bestow a blessing upon you, enhancing your ability to recover from wounds.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 1;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Receive the Blessing',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_recovery_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'permanent_recovery_bonus',\n          probability: 0.2,\n          description: 'The priests blessing fills you with resilience. (+1 Recovery)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_recovery_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_recovery_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }, {\n          id: 'refill',\n          probability: 0.6,\n          description: 'You feel yourself healthier than ever',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_regen');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }, {\n          id: 'blessing_fail',\n          probability: 0.2,\n          description: 'The blessing backfires, leaving you slightly weakened. (-10% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Politely Refuse',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event13',\n    name: 'Forgotten Altar',\n    description: 'Hidden among the trees, you find an ancient altar, etched with mysterious runes. A faint glow suggests untold power, but a voice in your mind warns of potential danger.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 1;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Offer a Prayer',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 5 * randomEventScalingFactor('random_events_recovery_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'permanent_recovery_bonus',\n          probability: 0.1,\n          description: 'Your prayer is answered, and you feel an inner strength awaken. (+1 Recovery)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_recovery_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_recovery_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -5 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }, {\n          id: 'minor_blessing',\n          probability: 0.2,\n          description: 'The altar grants a small boon, increasing your health regeneration temporarily. (+Health regen for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_regen');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -5 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }, {\n          id: 'negative_effect',\n          probability: 0.7,\n          description: 'The altar rejects your prayer, sapping your energy. (-20% energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -5 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Offer Gold',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: Math.max(50, 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'health_bonus',\n          probability: 0.5,\n          description: 'The altar accepts your offering, bestowing vitality upon you. (+Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_regen');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -Math.max(50, 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap));\n          }\n        }, {\n          id: 'altar_silence',\n          probability: 0.5,\n          description: 'The altar remains silent, and your gold vanishes.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -Math.max(50, 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap));\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Leave the Altar',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event14',\n    name: 'Challenger\\'s Duel',\n    description: 'A traveling warrior challenges you to a duel, promising great rewards for your courage.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 1;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Accept the Duel',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                health: {\n                  A: 0,\n                  B: 5 * randomEventScalingFactor('random_events_strength_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'strength_gain',\n          probability: 0.4,\n          description: 'You fight valiantly and emerge victorious. (+1 Strength)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_strength_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_strength_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -5 * randomEventScalingFactor('random_events_strength_effect'));\n          }\n        }, {\n          id: 'minor_injury',\n          probability: 0.4,\n          description: 'You lose the duel but gain valuable experience. (-10% HP, +Temporary strength training bonus, +Injury)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_physical_training_rate');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff');\n          }\n        }, {\n          id: 'severe_injury',\n          probability: 0.2,\n          description: 'You are defeated and badly injured. (-20% HP, +Injury)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 2);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -5 * randomEventScalingFactor('random_events_strength_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Decline the Challenge',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event15',\n    name: 'Charismatic Merchant',\n    description: 'A traveling merchant with a silver tongue offers you a deal. He claims his goods will make you more persuasive, for a price.',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Buy the Goods',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 100 * randomEventScalingFactor('random_events_charisma_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'permanent_charisma_bonus',\n          probability: 0.5,\n          description: 'The merchants goods grant you an air of confidence. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -100 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'worthless_purchase',\n          probability: 0.5,\n          description: 'The goods turn out to be useless trinkets. You feel cheated. (-100 coins)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -100 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Walk Away',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event16',\n    name: 'Charmed Audience',\n    description: 'You find yourself speaking before a small crowd. They hang on your every word, and you feel their admiration growing.',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Inspire the Crowd',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 4 * randomEventScalingFactor('random_events_charisma_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'permanent_charisma_bonus',\n          probability: 0.2,\n          description: 'Your words resonate deeply, leaving a lasting impression. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -4 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'exhaustion',\n          probability: 0.8,\n          description: 'Speaking passionately takes its toll on you. (-100% Energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Remain Silent',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event17',\n    name: 'Street Performers',\n    description: 'You stumble upon a lively square where street performers are enchanting the crowd with their music. Their melodies resonate through the air, drawing you closer.',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Donate to the Performers',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 125,\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'gold_bonus',\n          probability: 0.3,\n          description: 'The performers thank you, and their music attracts a wealthier crowd. (Increased gold income for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_coins_bonus');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -125);\n          }\n        }, {\n          id: 'nothing_happens',\n          probability: 0.7,\n          description: 'The performers thank you warmly, but nothing else happens.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -125);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Ask to Sing with Them',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_bonus',\n          probability: 0.05,\n          description: 'The crowd loves your performance! (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n          }\n        }, {\n          id: 'voice_strain',\n          probability: 0.65,\n          description: 'You strain your voice trying to match their skills. (-20% Energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1);\n          }\n        }, {\n          id: 'refusal',\n          probability: 0.3,\n          description: 'The performers politely refuse your request.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {}\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Sing Without Asking',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_penalty',\n          probability: 0.2,\n          description: 'The crowd boos you for your rude interruption. (-1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') - 1, true);\n          }\n        }, {\n          id: 'charisma_gain',\n          probability: 0.3,\n          description: 'The crowd surprisingly loves your boldness! (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n          }\n        }, {\n          id: 'injury',\n          probability: 0.5,\n          description: 'A scuffle breaks out over your antics, and you get hurt. (-10% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 2);\n          }\n        }]\n      },\n      option4: {\n        id: 'option4',\n        name: 'Walk Away',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event18',\n    name: 'The Fortune Teller',\n    description: 'A mysterious fortune teller beckons you over, promising insights into your future for a price.',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Pay for a Reading',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 50 * randomEventScalingFactor('random_events_charisma_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.4,\n          description: 'The fortune tellers words inspire confidence in you. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -50 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'vague_predictions',\n          probability: 0.5,\n          description: 'Her predictions are vague and unhelpful.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -50 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'bad_omen',\n          probability: 0.1,\n          description: 'She warns of a dark future, and you feel unnerved. (-10% Energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 2);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Decline the Offer',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event19',\n    name: 'The Lost Artifact',\n    description: 'While exploring an abandoned temple, you find a glowing artifact on a pedestal. Its power is undeniable, but a strange aura surrounds it.',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Take the Artifact',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                health: {\n                  A: 0,\n                  B: 5 * randomEventScalingFactor('random_events_strength_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'power_gain',\n          probability: 0.3,\n          description: 'The artifact bonds with you, granting a permanent boost to Strength. (+1 Strength)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_strength_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_strength_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -5 * randomEventScalingFactor('random_events_strength_effect'));\n          }\n        }, {\n          id: 'artifact_curse',\n          probability: 0.3,\n          description: 'A curse emanates from the artifact, draining your health. (You got major injury)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 3);\n          }\n        }, {\n          id: 'artifact_nothing',\n          probability: 0.4,\n          description: 'The artifact vanishes as soon as you touch it. Nothing happens.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {}\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Leave it Alone',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      },\n      option3: {\n        id: 'option3',\n        name: 'Attempt to Destroy it',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'artifact_destroyed',\n          probability: 0.5,\n          description: 'You destroy the artifact, and a wave of energy heals you. (+20% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_regen', 2);\n          }\n        }, {\n          id: 'artifact_backlash',\n          probability: 0.5,\n          description: 'The artifact explodes, injuring you. (-15% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.15 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event20',\n    name: 'A Mysterious Stranger',\n    description: 'A cloaked figure approaches you in the dark, offering a strange vial. \"Drink this,\" they say. \"It will change your life.\"',\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Drink the Vial',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.05,\n          description: 'You feel a surge of confidence coursing through you. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n          }\n        }, {\n          id: 'health_loss',\n          probability: 0.4,\n          description: 'You feel sick as the liquid burns your insides. (-20% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1);\n          }\n        }, {\n          id: 'vial_nothing',\n          probability: 0.55,\n          description: 'The liquid seems to do nothing at all.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {}\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Refuse the Offer',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      },\n      option3: {\n        id: 'option3',\n        name: 'Take the Vial but Dont Drink It',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'vial_analysis',\n          probability: 0.5,\n          description: 'You keep the vial for later analysis. Nothing happens for now.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {}\n        }, {\n          id: 'vial_analysis_success',\n          probability: 0.5,\n          description: 'You analyzed vial. You barely understand what its made of, but investigating it gave you inspiration to learn. You got bonus to learning bonus',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_learn_rate');\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event21',\n    name: 'Ancient Tome',\n    description: 'In the library, you discover an ancient tome glowing faintly on a dusty shelf. Its title is indecipherable, but you feel drawn to it.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Read the Tome',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              knowledge: {\n                coins: {\n                  A: 0,\n                  B: 5 * randomEventScalingFactor('random_events_memory_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.6,\n          description: 'The tome is full of arcane knowledge, enhancing your understanding. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -5 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'temporary_knowledge_debuff',\n          probability: 0.3,\n          description: 'The text is confusing and gives you a headache. (-Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_debuff');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -5 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'memory_boost',\n          probability: 0.1,\n          description: 'You decipher a hidden message, permanently enhancing your memory. (+1 Memory)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_memory_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_memory_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -5 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Put It Back',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event22',\n    name: 'Mysterious Scroll',\n    description: 'While browsing the library, a rolled-up scroll falls from a high shelf and lands at your feet. Its seal is broken.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Read the Scroll',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.7,\n          description: 'The scroll contains insights that briefly enhance your studies. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain');\n          }\n        }, {\n          id: 'temporary_knowledge_debuff',\n          probability: 0.2,\n          description: 'The scroll is riddled with errors, confusing your thoughts. (-Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_debuff');\n          }\n        }, {\n          id: 'memory_boost',\n          probability: 0.1,\n          description: 'The scroll teaches you a mnemonic trick, enhancing your memory. (+1 Memory)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_memory_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_memory_effect') + 1, true);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Leave It Alone',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event23',\n    name: 'Library Apparition',\n    description: 'As you explore the darker corners of the library, a faint apparition appears, pointing to a hidden alcove.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Follow the Apparition',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                knowledge: {\n                  A: 0,\n                  B: 8 * randomEventScalingFactor('random_events_memory_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.5,\n          description: 'The apparition leads you to a forgotten cache of knowledge. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -8 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'temporary_knowledge_debuff',\n          probability: 0.3,\n          description: 'The apparition misleads you, wasting your time. (-Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_debuff');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -8 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'memory_boost',\n          probability: 0.2,\n          description: 'The apparition shares a secret, permanently enhancing your memory. (+1 Memory)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_memory_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_memory_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -8 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Ignore It',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event24',\n    name: 'Speed Reading Bet',\n    description: 'A fellow library patron challenges you to a speed reading contest. Will you accept the challenge?',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Accept and Give Your Best',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 5 * randomEventScalingFactor('random_events_memory_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.2,\n          description: 'You win the bet and impress everyone! (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -5 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'knowledge_permanent_boost',\n          probability: 0.2,\n          description: 'You push your limits and learn efficiently. (+1 Memory)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_memory_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_memory_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -5 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'temporary_knowledge_debuff',\n          probability: 0.6,\n          description: 'You overexert yourself and feel drained. (-Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_debuff');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -5 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Accept Out of Curiosity',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_energy_regeneration_debuff',\n          probability: 0.5,\n          description: 'The stress of the bet hampers your energy recovery. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff');\n          }\n        }, {\n          id: 'temporary_knowledge_gain',\n          probability: 0.5,\n          description: 'You enjoy the challenge and learn a lot! (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 2);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Refuse the Bet',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event25',\n    name: 'Cryptic Riddle',\n    description: 'A strange librarian approaches you with a cryptic riddle, promising a reward if you solve it.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Attempt to Solve It',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                knowledge: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_memory_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'memory_boost',\n          probability: 0.4,\n          description: 'The riddle challenges your mind, enhancing your memory. (+1 Memory)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_memory_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_memory_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -10 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'temporary_energy_debuff',\n          probability: 0.3,\n          description: 'The riddle exhausts you mentally. (-20% Energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -10 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'gold_find',\n          probability: 0.3,\n          description: 'The librarian rewards you with a small pouch of coins.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -10 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Ask for a Hint',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.5,\n          description: 'The hint broadens your understanding. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain');\n          }\n        }, {\n          id: 'temporary_knowledge_debuff',\n          probability: 0.5,\n          description: 'The hint confuses you further. (-Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_debuff');\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Politely Decline',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'early_event26',\n    name: 'Unstable Experiment',\n    description: 'You find an old experiment log in the library. It describes a dangerous but potentially rewarding experiment.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Recreate the Experiment',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                knowledge: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_memory_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'knowledge_permanent_boost',\n          probability: 0.2,\n          description: 'The experiment succeeds, expanding your knowledge. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -10 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'temporary_energy_debuff',\n          probability: 0.3,\n          description: 'The experiment exhausts you physically. (-20% Energy)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -10 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.3,\n          description: 'The experiment goes awry, injuring you slightly. (-10% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -10 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }, {\n          id: 'memory_boost',\n          probability: 0.2,\n          description: 'The experiment teaches you new mnemonic techniques. (+1 Memory)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_memory_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_memory_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('knowledge', -10 * randomEventScalingFactor('random_events_memory_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Study the Log Carefully',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.7,\n          description: 'You learn useful details from the log. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain');\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.3,\n          description: 'The log contains dangerous warnings that unsettle you. (-10% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Leave It Alone',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event1',\n    name: 'The Overactive Spellbook',\n    description: 'While flipping through your spellbook in a quiet corner of the tavern, a poorly contained spell activates, filling the room with a shimmering, unstable energy. The barkeep glares at you, and the other patrons grow uneasy.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Try to Dispel the Energy',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.6,\n          description: 'Your efforts stabilize the energy, leaving you refreshed. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 2);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.4,\n          description: 'You fail to contain the spell, and it drains your energy. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff');\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Cast a Counterspell',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mental_training_rate',\n          probability: 0.5,\n          description: 'The counterspell enhances your focus. (+Mental training speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mental_training_rate');\n          }\n        }, {\n          id: 'temporary_knowledge_debuff',\n          probability: 0.3,\n          description: 'The counterspell backfires slightly, muddling your thoughts. (-Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_debuff');\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.2,\n          description: 'The unstable energy shocks you, causing a minor injury. (-10% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 2);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Apologize to the Tavern Patrons',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_charisma_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'temporary_energy_regeneration_debuff',\n          probability: 0.4,\n          description: 'The effort of calming everyone drains you. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff');\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'charisma_boost',\n          probability: 0.3,\n          description: 'Your sincerity wins over the crowd. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'gold_loss',\n          probability: 0.3,\n          description: 'The barkeep demands compensation for the disturbance.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').amount);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }]\n      },\n      option4: {\n        id: 'option4',\n        name: 'Flee the Scene',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_health_debuff',\n          probability: 0.5,\n          description: 'In your rush to escape, you trip and fall. (-10% HP)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n          }\n        }, {\n          id: 'gold_loss',\n          probability: 0.5,\n          description: 'In the chaos, someone picks your pocket. (-30 Coins)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -30);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event2',\n    name: 'Spilled Ale and Sparks',\n    description: 'A clumsy patron spills their ale on your spellbook, causing sparks to fly and minor chaos in the tavern. The barkeep looks furious, and the patron looks embarrassed.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Use Magic to Dry the Book',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.5,\n          description: 'The spell works perfectly, restoring calm. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 2);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.5,\n          description: 'The spell backfires, draining your energy further. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 1);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Demand Compensation from the Patron',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                health: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_charisma_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'gold_gain',\n          probability: 0.7,\n          description: 'The patron apologizes and offers you some gold.',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', 50 + 0.03 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -10 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'charisma_penalty',\n          probability: 0.3,\n          description: 'The patron refuses and spreads rumors about your temper. (-1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') - 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -10 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Let It Slide',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mental_training_rate',\n          probability: 1,\n          description: 'Your restraint impresses the crowd, enhancing your focus. (+Mental training speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mental_training_rate', 2);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event3',\n    name: 'A Dispute Over a Spell',\n    description: 'Two rival mages are arguing loudly in the market square over the correct incantation for a complex spell. The argument draws a crowd, and you are pulled into the fray.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Mediate Between Them',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_charisma_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.4,\n          description: 'Your calm demeanor and logic win the crowds approval. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }, {\n          id: 'temporary_energy_regeneration_debuff',\n          probability: 0.6,\n          description: 'The effort drains you significantly. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 2);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -10 * randomEventScalingFactor('random_events_charisma_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Join the Argument',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.5,\n          description: 'The heated debate sharpens your understanding. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 2);\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.5,\n          description: 'A stray spell hits you in the commotion, causing a minor injury. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 2);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Walk Away',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event4',\n    name: 'Magical Misfire',\n    description: 'During practice in the market square, your spell misfires, creating a harmless but embarrassing illusion of yourself.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Laugh It Off',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.1,\n          description: 'Your humor and humility charm the crowd. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n          }\n        }, {\n          id: 'gold_gain',\n          probability: 0.9,\n          description: 'The crowd finds your antics amusing and tosses some coins your way. (Refilled 10% of your coins storage)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Quickly Correct the Spell',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mental_training_rate',\n          probability: 0.7,\n          description: 'Your quick thinking improves your focus. (+Mental training speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mental_training_rate', 1);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.3,\n          description: 'The correction drains your mana. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 2);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Flee the Scene',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_health_debuff',\n          probability: 0.5,\n          description: 'In your haste to escape, you bump into someone, causing a minor injury. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event6',\n    name: 'The Wandering Sage',\n    description: 'An old sage approaches you, offering to share a fragment of his magical wisdom, but warns that it could be exhausting to comprehend.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Accept His Wisdom',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.6,\n          description: 'The sages wisdom broadens your understanding. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 4);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.4,\n          description: 'The mental effort drains your magical reserves. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 2);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Politely Decline',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.6,\n          description: 'Your respectful refusal earns the sages admiration. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n          }\n        }, {\n          id: 'charisma_debuff',\n          probability: 0.4,\n          description: 'Sage was very angry for your refusal. (-1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') - 1, true);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Ask for Practical Guidance',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.7,\n          description: 'The sage demonstrates a technique to replenish your mana. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 2);\n          }\n        }, {\n          id: 'temporary_mental_training_rate',\n          probability: 0.3,\n          description: 'The sages teachings improve your focus. (+Mental training speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mental_training_rate', 2);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event7',\n    name: 'An Enchanted Fountain',\n    description: 'You find a glowing fountain in the woods. The water sparkles with magical energy, and a faint humming fills the air.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Drink the Water',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.7,\n          description: 'The water revitalizes your magical reserves. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 1.5);\n          }\n        }, {\n          id: 'temporary_knowledge_debuff',\n          probability: 0.3,\n          description: 'The magical water overwhelms your thoughts. (-Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_debuff', 2);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Use the Water for Research',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.6,\n          description: 'The water enhances your research, deepening your understanding. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 3);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.4,\n          description: 'Using the water in experiments depletes your mana. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 1);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Leave It Alone',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event8',\n    name: 'A Mages Duel',\n    description: 'Two mages are locked in a duel, their spells lighting up the night sky. They invite you to join as a mediator or a participant.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Join as a Mediator',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.5,\n          description: 'Your efforts to mediate help you understand complex spell interactions. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 4);\n          }\n        }, {\n          id: 'temporary_energy_regeneration_debuff',\n          probability: 0.5,\n          description: 'Mediating the duel is exhausting. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Join the Duel',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.6,\n          description: 'The duel invigorates your magical energy. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 3);\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.4,\n          description: 'A stray spell injures you slightly. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 2);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Watch from the Sidelines',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event9',\n    name: 'Healing Light Ritual',\n    description: 'A group of traveling healers offers to perform a ritual that could enhance your recovery abilities, but they require a donation of magical energy or health.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Donate Mana',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                mana: {\n                  A: 0,\n                  B: 5 * randomEventScalingFactor('random_events_recovery_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'permanent_recovery_boost',\n          probability: 0.7,\n          description: 'The ritual succeeds, and you feel your bodys resilience improve. (+1 Recovery)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_recovery_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_recovery_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -5 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.3,\n          description: 'The ritual fails, leaving you drained. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 1.5);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -50 * randomEventScalingFactor('random_events_recovery_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Donate Health',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                health: {\n                  A: 0,\n                  B: 0.4 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap,\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.6,\n          description: 'Your sacrifice inspires a burst of clarity. (+Knowledge gain for 15 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 1.4);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.4 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.4,\n          description: 'The ritual strains your body, weakening your recovery temporarily. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1.3);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('health', -0.4 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('health').cap);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Decline Politely',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.5,\n          description: 'Your polite refusal earns their respect. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n          }\n        }, {\n          id: 'charisma_penalty',\n          probability: 0.5,\n          description: 'The healers take offense to your refusal. (-1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') - 1, true);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event10',\n    name: 'Forgotten Spell Scroll',\n    description: 'You stumble upon an ancient scroll half-buried in the ground. The script shimmers with faint arcane energy.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Attempt to Read It',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.6,\n          description: 'The scroll reveals techniques that restore your mana. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 1.5);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.4,\n          description: 'The scrolls magic backfires, sapping your strength. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 1.2);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Use the Scroll for Research',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.8,\n          description: 'The scroll deepens your understanding. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 1.6);\n          }\n        }, {\n          id: 'temporary_energy_debuff',\n          probability: 0.2,\n          description: 'The effort leaves you exhausted. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1.4);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Leave It Be',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event13',\n    name: 'The Arcane Merchant',\n    description: 'A mysterious merchant sets up a stall in the market, offering rare magical trinkets that could enhance your abilities, for a price.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Buy a Mana Crystal',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap,\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.8,\n          description: 'The crystal revitalizes your magical energy. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 1.5);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.2,\n          description: 'The crystal is flawed, sapping your mana instead. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 1.2);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', -0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').cap);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Inspect the Merchants Wares',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.7,\n          description: 'You learn something from the merchants collection. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 1.4);\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.3,\n          description: 'You cut yourself on a sharp artifact. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1.3);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Walk Away',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event14',\n    name: 'The Wandering Illusionist',\n    description: 'An illusionist captivates the crowd with his dazzling tricks and offers to teach you a secret for a price.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Pay for the Lesson',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 75 * randomEventScalingFactor('random_events_charisma_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'charisma_boost',\n          probability: 0.7,\n          description: 'The lesson enhances your stage presence. (+1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') + 1, true);\n          }\n        }, {\n          id: 'temporary_energy_debuff',\n          probability: 0.3,\n          description: 'The effort leaves you fatigued. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1.4);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Challenge His Tricks',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.5,\n          description: 'Dissecting his illusions sharpens your mind. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 1.6);\n          }\n        }, {\n          id: 'charisma_penalty',\n          probability: 0.5,\n          description: 'The crowd boos you for ruining the show. (-1 Charisma)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_charisma_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_charisma_effect') - 1, true);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Watch Silently',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.8,\n          description: 'Watching his tricks calms your mind. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 1.3);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event16',\n    name: 'Arcane Convergence',\n    description: 'A rare alignment of celestial bodies fills the air with arcane energy. A mysterious portal appears before you, pulsating with power.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Step Into the Portal',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                mana: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_magic_ability_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'magic_ability_boost',\n          probability: 0.5,\n          description: 'The arcane energies enhance your magical aptitude. (+1 Magic Ability)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_magic_ability_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_magic_ability_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -10 * randomEventScalingFactor('random_events_magic_ability_effect'));\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.5,\n          description: 'The portal destabilizes, sapping your vitality. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1.5);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -30 * randomEventScalingFactor('random_events_magic_ability_effect'));\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Observe from a Distance',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.7,\n          description: 'You glean insights from the portals behavior. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 2);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.3,\n          description: 'The portals energy interferes with your focus. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 1.3);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Close the Portal',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap,\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        effects: [{\n          id: 'temporary_mental_training_rate',\n          probability: 0.8,\n          description: 'Closing the portal sharpens your discipline. (+Mental training speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mental_training_rate', 1.5);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.2,\n          description: 'The portal lashes out, leaving you injured. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1.3);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('energy', -0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('energy').cap);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event17',\n    name: 'The Forgotten Archive',\n    description: 'You discover a hidden library filled with ancient texts. A glowing pedestal at its center beckons you forward.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Study the Ancient Texts',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 0.8,\n          description: 'The texts expand your understanding of magic. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 2);\n          }\n        }, {\n          id: 'temporary_mana_debuff',\n          probability: 0.2,\n          description: 'The effort drains your mana reserves. (-Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_debuff', 1.4);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Approach the Pedestal',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                mana: {\n                  A: 0,\n                  B: 10 * randomEventScalingFactor('random_events_magic_ability_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'magic_ability_boost',\n          probability: 0.5,\n          description: 'The pedestal imbues you with arcane knowledge. (+1 Magic Ability)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_magic_ability_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_magic_ability_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -10 * randomEventScalingFactor('random_events_magic_ability_effect'));\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.5,\n          description: 'The pedestals magic is unstable, causing minor harm. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1.2);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -20 * randomEventScalingFactor('random_events_magic_ability_effect'));\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Catalog the Librarys Contents',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mental_training_rate',\n          probability: 1,\n          description: 'Cataloging the texts improves your focus. (+Mental training speed for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mental_training_rate', 1.5);\n          }\n        }]\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event18',\n    name: 'The Crystal Cavern',\n    description: 'You stumble upon a hidden cavern filled with glowing crystals. Their hum resonates with magical energy.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Harvest the Crystals',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                mana: {\n                  A: 0,\n                  B: 40 * randomEventScalingFactor('random_events_magic_ability_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'magic_ability_boost',\n          probability: 0.6,\n          description: 'The crystals enhance your magical aptitude. (+1 Magic Ability)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_magic_ability_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_magic_ability_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -40 * randomEventScalingFactor('random_events_magic_ability_effect'));\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.4,\n          description: 'The crystals emit a sharp energy that drains your vitality. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1.5);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Meditate Among the Crystals',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_mana_regen',\n          probability: 0.8,\n          description: 'The crystals rejuvenate your magical reserves. (+Mana regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_mana_regen', 1.5);\n          }\n        }, {\n          id: 'temporary_energy_debuff',\n          probability: 0.2,\n          description: 'The hum of the crystals leaves you slightly fatigued. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1.2);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Leave the Cavern',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: []\n      }\n    }\n  });\n  randomEventsDB.push({\n    id: 'magic_event19',\n    name: 'The Arcane Ritual',\n    description: 'A group of mages invites you to join a ritual designed to enhance magical abilities, but warns of potential risks.',\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    probability: 1,\n    options: {\n      option1: {\n        id: 'option1',\n        name: 'Participate in the Ritual',\n        usageGain: {\n          get_consumption: function get_consumption() {\n            return {\n              resources: {\n                mana: {\n                  A: 0,\n                  B: 50 * randomEventScalingFactor('random_events_magic_ability_effect'),\n                  type: 0\n                }\n              }\n            };\n          }\n        },\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'magic_ability_boost',\n          probability: 0.7,\n          description: 'The ritual strengthens your magical connection. (+1 Magic Ability)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel('random_events_magic_ability_effect', game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('random_events_magic_ability_effect') + 1, true);\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('mana', -50 * randomEventScalingFactor('random_events_magic_ability_effect'));\n          }\n        }, {\n          id: 'temporary_health_debuff',\n          probability: 0.3,\n          description: 'The ritual drains your physical strength. (-Health regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_debuff', 1.5);\n          }\n        }]\n      },\n      option2: {\n        id: 'option2',\n        name: 'Observe the Ritual',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'temporary_knowledge_gain',\n          probability: 1,\n          description: 'Watching the ritual provides valuable insights. (+Knowledge gain for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_knowledge_gain', 1.8);\n          }\n        }]\n      },\n      option3: {\n        id: 'option3',\n        name: 'Politely Decline',\n        unlockCondition: function unlockCondition() {\n          return true;\n        },\n        effects: [{\n          id: 'health_blessings',\n          probability: 0.5,\n          description: 'The Gods appreciate your carefulness, giving you temporary boost to health',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_health_regen', 1.4);\n          }\n        }, {\n          id: 'temporary_energy_debuff',\n          probability: 0.5,\n          description: 'Refusing leaves you slightly uneasy. (-Energy regeneration for 5 minutes)',\n          unlockCondition: function unlockCondition() {\n            return true;\n          },\n          onTrigger: function onTrigger() {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('temporary-effects').triggerEffect('temporary_energy_debuff', 1.2);\n          }\n        }]\n      }\n    }\n  });\n  return randomEventsDB;\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/general/random-events-db.js?");

/***/ }),

/***/ "./src/worker/modules/general/random-events.module.js":
/*!************************************************************!*\
  !*** ./src/worker/modules/general/random-events.module.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RandomEventsModule: () => (/* binding */ RandomEventsModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _random_events_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./random-events-db */ \"./src/worker/modules/general/random-events-db.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _createForOfIteratorHelper(r, e) { var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t[\"return\"] || t[\"return\"](); } finally { if (u) throw o; } } }; }\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\nvar RandomEventsModule = /*#__PURE__*/function (_GameModule) {\n  function RandomEventsModule() {\n    var _this;\n    _classCallCheck(this, RandomEventsModule);\n    _this = _callSuper(this, RandomEventsModule);\n    _this.activeEvents = {}; // '  ,  - id \n    _this.isEventOpened = false; //   \n    _this.eventsDB = {}; //    \n    _this.openedEventId = null; // ID   \n    _this.revealedEffects = {};\n    _this.eventHandler.registerHandler('set-event-data-opened', function (_ref) {\n      var isOpened = _ref.isOpened,\n        eventId = _ref.eventId;\n      console.log('SettOpened: ', isOpened, eventId);\n      _this.openedEventId = isOpened ? eventId : null; //  ID  \n      if (eventId && _this.activeEvents[eventId]) {\n        _this.activeEvents[eventId].isOpened = isOpened;\n      }\n      _this.sendData();\n    });\n    _this.eventHandler.registerHandler('select-event-option', function (_ref2) {\n      var eventId = _ref2.eventId,\n        optionId = _ref2.optionId;\n      _this.selectOption(eventId, optionId);\n      _this.sendData();\n    });\n    _this.eventHandler.registerHandler('query-event-data', function (_ref3) {\n      var prefix = _ref3.prefix;\n      _this.sendData(prefix);\n    });\n    return _this;\n  }\n  _inherits(RandomEventsModule, _GameModule);\n  return _createClass(RandomEventsModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      this.eventsDB = (0,_random_events_db__WEBPACK_IMPORTED_MODULE_1__.registerRandomEventsDb)().reduce(function (acc, item) {\n        acc[item.id] = item;\n        return acc;\n      }, {});\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      //   \n      for (var _i = 0, _Object$entries = Object.entries(this.activeEvents); _i < _Object$entries.length; _i++) {\n        var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n          id = _Object$entries$_i[0],\n          event = _Object$entries$_i[1];\n        if (!this.activeEvents[id].expiresIn || this.activeEvents[id].expiresIn > 3600) {\n          this.activeEvents[id].expiresIn = 0;\n        }\n        this.activeEvents[id].expiresIn -= delta;\n        if (this.activeEvents[id].expiresIn <= 0) {\n          delete this.activeEvents[id];\n        }\n      }\n\n      //   ,       5\n      if (Object.keys(this.activeEvents).length < 5 && Math.random() < delta * 0.005) {\n        this.triggerRandomEvent();\n      }\n    }\n  }, {\n    key: \"triggerRandomEvent\",\n    value: function triggerRandomEvent() {\n      var _this2 = this;\n      var availableEvents = Object.values(this.eventsDB).filter(function (event) {\n        return event.unlockCondition() && !_this2.activeEvents[event.id];\n      } // ,       id\n      );\n      if (availableEvents.length === 0) return;\n      var totalProbability = availableEvents.reduce(function (sum, event) {\n        return sum + event.probability;\n      }, 0);\n      var randomValue = Math.random() * totalProbability;\n      var _iterator = _createForOfIteratorHelper(availableEvents),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var event = _step.value;\n          if (randomValue < event.probability) {\n            this.activeEvents[event.id] = {\n              expiresIn: 20 * 60,\n              //  20 \n              isOpened: false,\n              //   \n              selectedOptionId: null,\n              //  \n              triggeredEffect: null // ,  \n            };\n            if (!this.openedEventId) {\n              this.openedEventId = event.id;\n              this.activeEvents[event.id].isOpened = true;\n            }\n            this.sendData();\n            return;\n          }\n          randomValue -= event.probability;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }, {\n    key: \"selectOption\",\n    value: function selectOption(eventId, optionId) {\n      var event = this.activeEvents[eventId];\n      if (!event) return;\n      var eventData = this.eventsDB[eventId];\n      if (!eventData) return;\n      var option = eventData.options[optionId];\n      if (!option || !option.unlockCondition()) return;\n\n      //   \n      var availableEffects = option.effects.filter(function (effect) {\n        return effect.unlockCondition();\n      });\n      if (availableEffects.length === 0) {\n        event.selectedOptionId = optionId;\n        return;\n      }\n      var totalProbability = availableEffects.reduce(function (sum, effect) {\n        return sum + effect.probability;\n      }, 0);\n      var randomValue = Math.random() * totalProbability;\n      var triggeredEffect = null;\n      var _iterator2 = _createForOfIteratorHelper(availableEffects),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var effect = _step2.value;\n          if (randomValue < effect.probability) {\n            triggeredEffect = effect;\n            effect.onTrigger();\n            this.revealEffect(eventId, optionId, effect.id);\n            break;\n          }\n          randomValue -= effect.probability;\n        }\n\n        //     \n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      event.selectedOptionId = optionId;\n      event.triggeredEffect = triggeredEffect;\n      this.activeEvents[eventId].expiresIn = Math.min(this.activeEvents[eventId].expiresIn, 60);\n    }\n  }, {\n    key: \"checkRevealedEvent\",\n    value: function checkRevealedEvent(eventId) {\n      var wholeRevealed = true;\n      for (var oId in this.eventsDB[eventId].options) {\n        var _this$revealedEffects, _this$eventsDB$eventI;\n        if (!((_this$revealedEffects = this.revealedEffects[eventId][oId]) !== null && _this$revealedEffects !== void 0 && _this$revealedEffects.d) && (_this$eventsDB$eventI = this.eventsDB[eventId].options[oId]) !== null && _this$eventsDB$eventI !== void 0 && (_this$eventsDB$eventI = _this$eventsDB$eventI.effects) !== null && _this$eventsDB$eventI !== void 0 && _this$eventsDB$eventI.length) {\n          wholeRevealed = false;\n        }\n      }\n      if (wholeRevealed) {\n        this.revealedEffects[eventId] = {\n          // minimizing data, since event revealed\n          d: true\n        };\n      }\n      console.log('REVELATION_EVENT: ', eventId, wholeRevealed);\n      return wholeRevealed;\n    }\n  }, {\n    key: \"revealEffect\",\n    value: function revealEffect(eventId, optionId, effectId) {\n      console.log('REVELATION_CHECK: ', eventId, this.revealedEffects[eventId]);\n      if (!this.revealedEffects[eventId]) {\n        this.revealedEffects[eventId] = {};\n      }\n\n      // Everything is already revealed\n      if (this.revealedEffects[eventId].d) return;\n      if (!this.revealedEffects[eventId][optionId]) {\n        var _this$eventsDB$eventI2;\n        if (!((_this$eventsDB$eventI2 = this.eventsDB[eventId].options[optionId].effects) !== null && _this$eventsDB$eventI2 !== void 0 && _this$eventsDB$eventI2.length)) {\n          this.revealedEffects[eventId][optionId] = {\n            d: true\n          };\n          this.checkRevealedEvent(eventId);\n          return;\n        }\n        this.revealedEffects[eventId][optionId] = {\n          u: this.eventsDB[eventId].options[optionId].effects.reduce(function (acc, eff) {\n            return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, eff.id, true));\n          }, {}) // Implement storing unrevealed yet effects\n        };\n      }\n      // Everything is revealed for option\n      if (this.revealedEffects[eventId][optionId].d || !this.revealedEffects[eventId][optionId].u[effectId]) {\n        this.checkRevealedEvent(eventId);\n        return;\n      }\n      delete this.revealedEffects[eventId][optionId].u[effectId]; // deleting from unrevealed\n      console.log('REVELATION: ', eventId, optionId, effectId, this.revealedEffects[eventId][optionId]);\n      if (Object.values(this.revealedEffects[eventId][optionId].u).length <= 0) {\n        this.revealedEffects[eventId][optionId].d = true;\n        delete this.revealedEffects[eventId][optionId][\"u\"];\n        this.checkRevealedEvent(eventId);\n      }\n    }\n  }, {\n    key: \"getRevealedEffects\",\n    value: function getRevealedEffects(eventId, optionId) {\n      var _this$revealedEffects2,\n        _this$revealedEffects3,\n        _this3 = this;\n      var totalProbability = this.eventsDB[eventId].options[optionId].effects.reduce(function (sum, effect) {\n        return sum + effect.probability;\n      }, 0);\n      if (totalProbability <= 0) {\n        // no effects attached\n        return [{\n          id: 'nothing',\n          description: 'Nothing happens',\n          probability: 1\n        }];\n      }\n      if (!((_this$revealedEffects2 = this.revealedEffects[eventId]) !== null && _this$revealedEffects2 !== void 0 && _this$revealedEffects2.d) && !((_this$revealedEffects3 = this.revealedEffects[eventId]) !== null && _this$revealedEffects3 !== void 0 && _this$revealedEffects3[optionId])) return [];\n      return this.eventsDB[eventId].options[optionId].effects.filter(function (optionEffect) {\n        var _this3$revealedEffect, _this3$revealedEffect2, _this3$revealedEffect3, _this3$revealedEffect4;\n        if ((_this3$revealedEffect = _this3.revealedEffects[eventId]) !== null && _this3$revealedEffect !== void 0 && _this3$revealedEffect.d) return true;\n        if ((_this3$revealedEffect2 = _this3.revealedEffects[eventId]) !== null && _this3$revealedEffect2 !== void 0 && (_this3$revealedEffect2 = _this3$revealedEffect2[optionId]) !== null && _this3$revealedEffect2 !== void 0 && _this3$revealedEffect2.d) return true;\n        return ((_this3$revealedEffect3 = _this3.revealedEffects[eventId]) === null || _this3$revealedEffect3 === void 0 || (_this3$revealedEffect3 = _this3$revealedEffect3[optionId]) === null || _this3$revealedEffect3 === void 0 ? void 0 : _this3$revealedEffect3.u) && !(optionEffect.id in ((_this3$revealedEffect4 = _this3.revealedEffects[eventId]) === null || _this3$revealedEffect4 === void 0 || (_this3$revealedEffect4 = _this3$revealedEffect4[optionId]) === null || _this3$revealedEffect4 === void 0 ? void 0 : _this3$revealedEffect4.u));\n      }).map(function (optionEffect) {\n        return {\n          id: optionEffect.id,\n          description: optionEffect.description,\n          probability: optionEffect.probability / totalProbability\n        };\n      });\n    }\n  }, {\n    key: \"getOptionAffordable\",\n    value: function getOptionAffordable(option) {\n      var result = {\n        isAffordable: true,\n        consume: {}\n      };\n      if (option.usageGain) {\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_2__.resourceApi.unpackEffects(option.usageGain, 1);\n        if (effects.length) {\n          var resourcesToRemove = effects.filter(function (eff) {\n            return eff.scope === 'consumption' && eff.type === 'resources';\n          });\n          resourcesToRemove.forEach(function (resource) {\n            result.consume[resource.id] = resource.value;\n            if (result.consume[resource.id] > game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resource.id).amount) {\n              result.isAffordable = false;\n            }\n          });\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      var _this4 = this;\n      //     \n      var activeEventList = Object.entries(this.activeEvents).map(function (_ref4) {\n        var _ref5 = _slicedToArray(_ref4, 2),\n          id = _ref5[0],\n          event = _ref5[1];\n        return {\n          id: id,\n          expiresIn: event.expiresIn,\n          isOpened: event.isOpened,\n          selectedOptionId: event.selectedOptionId\n        };\n      }).sort(function (a, b) {\n        return a.expiresIn - b.expiresIn;\n      });\n\n      //     \n      var openedEventData = this.openedEventId && this.activeEvents[this.openedEventId] ? function () {\n        var eventData = _this4.eventsDB[_this4.openedEventId];\n        if (!eventData) return null;\n        return {\n          id: _this4.openedEventId,\n          name: eventData.name,\n          description: eventData.description,\n          options: Object.values(eventData.options).map(function (option) {\n            return {\n              id: option.id,\n              name: option.name,\n              description: option.description,\n              affordable: game_framework__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators.isAffordable(_this4.getOptionAffordable(option).consume),\n              revealedEffects: _this4.getRevealedEffects(_this4.openedEventId, option.id)\n            };\n          }),\n          selectedOption: _this4.activeEvents[_this4.openedEventId].selectedOptionId ? {\n            id: _this4.activeEvents[_this4.openedEventId].selectedOptionId,\n            name: eventData.options[_this4.activeEvents[_this4.openedEventId].selectedOptionId].name,\n            description: eventData.options[_this4.activeEvents[_this4.openedEventId].selectedOptionId].description,\n            triggeredEffect: _this4.activeEvents[_this4.openedEventId].triggeredEffect ? {\n              id: _this4.activeEvents[_this4.openedEventId].triggeredEffect.id,\n              name: _this4.activeEvents[_this4.openedEventId].triggeredEffect.name,\n              description: _this4.activeEvents[_this4.openedEventId].triggeredEffect.description\n            } : null\n          } : null\n        };\n      }() : null;\n      return {\n        list: activeEventList.map(function (event) {\n          var _this4$eventsDB$event;\n          return {\n            id: event.id,\n            name: (_this4$eventsDB$event = _this4.eventsDB[event.id]) === null || _this4$eventsDB$event === void 0 ? void 0 : _this4$eventsDB$event.name,\n            selectedOption: event.selectedOptionId,\n            expiresIn: event.expiresIn //   \n          };\n        }),\n        openedEventData: openedEventData\n      };\n    }\n  }, {\n    key: \"sendData\",\n    value: function sendData(prefix) {\n      var data = this.getData();\n      var label = 'random-events-data';\n      if (prefix) {\n        label = \"\".concat(label, \"-\").concat(prefix);\n      }\n      this.eventHandler.sendData(label, data);\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        activeEvents: this.activeEvents,\n        revealedEffects: this.revealedEffects\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      if (obj !== null && obj !== void 0 && obj.activeEvents) {\n        this.activeEvents = obj.activeEvents;\n      }\n      this.revealedEffects = (obj === null || obj === void 0 ? void 0 : obj.revealedEffects) || {};\n      this.sendData();\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/general/random-events.module.js?");

/***/ }),

/***/ "./src/worker/modules/general/temporary-effects-db.js":
/*!************************************************************!*\
  !*** ./src/worker/modules/general/temporary-effects-db.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerTemporaryEffectsDB: () => (/* binding */ registerTemporaryEffectsDB)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _magic_spells_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../magic/spells-db */ \"./src/worker/modules/magic/spells-db.js\");\n\n\nvar registerTemporaryEffectsDB = function registerTemporaryEffectsDB() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_energized', {\n    name: 'Energized',\n    description: 'Your energy income is boosted',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          energy: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_energy_debuff', {\n    name: 'Energy Debuff',\n    description: 'You fill weakened. Your energy regeneration is decreased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          energy: {\n            A: 0.8,\n            B: 0.8,\n            type: 1\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_health_regen', {\n    name: 'Health Regeneration',\n    description: 'Your health regeneration was increased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          health: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_health_debuff', {\n    name: 'Injury',\n    description: 'You are injured. Your health regeneration is decreased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          health: {\n            A: 0.8,\n            B: 0.8,\n            type: 1\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_mana_regen', {\n    name: 'Mana Regeneration',\n    description: 'Your mana regeneration was increased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          mana: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_mana_debuff', {\n    name: 'Mana Instability',\n    description: 'Your mana regeneration is decreased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          mana: {\n            A: 0.8,\n            B: 0.8,\n            type: 1\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_knowledge_gain', {\n    name: 'Knowledge Gain',\n    description: 'Your knowledge gain was increased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          knowledge: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_knowledge_debuff', {\n    name: 'Knowledge Debuff',\n    description: 'You feel yourself dummy. Your knowledge gain is decreased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          knowledge: {\n            A: 0.8,\n            B: 0.8,\n            type: 1\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_coins_bonus', {\n    name: 'Coins Earned Bonus',\n    description: 'Your coins income is boosted',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          coins: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_learn_rate', {\n    name: 'Learning Rate Bonus',\n    description: 'Your learning speed is increased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          learning_rate: {\n            A: 0.05,\n            B: 1.2,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_physical_training_rate', {\n    name: 'Physical Training Bonus',\n    description: 'Your learning speed for physical training is increased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          physical_training_learn_speed: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('temporary_mental_training_rate', {\n    name: 'Mental Training Bonus',\n    description: 'Your learning speed for mental training is increased',\n    hasCap: false,\n    tags: ['effect', 'temporary'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          mental_training_learning_rate: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      }\n    },\n    attributes: {\n      duration: 300\n    },\n    unlockCondition: function unlockCondition() {}\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/general/temporary-effects-db.js?");

/***/ }),

/***/ "./src/worker/modules/general/temporary-effects.module.js":
/*!****************************************************************!*\
  !*** ./src/worker/modules/general/temporary-effects.module.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TemporaryEffectsModule: () => (/* binding */ TemporaryEffectsModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _temporary_effects_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./temporary-effects-db */ \"./src/worker/modules/general/temporary-effects-db.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\nvar TemporaryEffectsModule = /*#__PURE__*/function (_GameModule) {\n  function TemporaryEffectsModule() {\n    var _this;\n    _classCallCheck(this, TemporaryEffectsModule);\n    _this = _callSuper(this, TemporaryEffectsModule);\n    _this.runningEffects = {};\n    return _this;\n  }\n  _inherits(TemporaryEffectsModule, _GameModule);\n  return _createClass(TemporaryEffectsModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      (0,_temporary_effects_db__WEBPACK_IMPORTED_MODULE_2__.registerTemporaryEffectsDB)();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        effects: this.runningEffects\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {\n      for (var key in this.runningEffects) {\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setEntityLevel(key, 0, true);\n      }\n      this.runningEffects = {};\n      if (saveObject !== null && saveObject !== void 0 && saveObject.effects) {\n        for (var id in saveObject.effects) {\n          this.runningEffects[id] = saveObject.effects[id];\n          if (!this.runningEffects[id].level) {\n            this.runningEffects[id].level = 1;\n          }\n          if (this.runningEffects[id].duration && this.runningEffects[id].duration > 0) {\n            this.runningEffects[id].isRunning = true;\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.registerGameEntity(\"active_\".concat(id), {\n              copyFromId: id,\n              isAbstract: false,\n              tags: ['active_temporary', 'active_effect'],\n              scope: 'events',\n              level: this.runningEffects[id].level\n            });\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setEntityLevel(\"active_\".concat(id), this.runningEffects[id].level, true);\n            this.runningEffects[id].duration = saveObject.effects[id].duration;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      for (var itemId in this.runningEffects) {\n        this.runningEffects[itemId].isCasted = false;\n        if (this.runningEffects[itemId].duration > 0) {\n          this.runningEffects[itemId].duration -= delta;\n          if (game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.entityExists(\"active_\".concat(itemId))) {\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setAttribute(\"active_\".concat(itemId), 'current_duration', this.runningEffects[itemId].duration);\n          }\n        }\n        if (this.runningEffects[itemId].duration <= 0 && this.runningEffects[itemId].isRunning) {\n          this.runningEffects[itemId].duration = 0;\n          this.runningEffects[itemId].isRunning = false;\n          if (game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.entityExists(\"active_\".concat(itemId))) {\n            game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.unsetEntity(\"active_\".concat(itemId));\n          }\n        }\n      }\n    }\n  }, {\n    key: \"triggerEffect\",\n    value: function triggerEffect(id) {\n      var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var effect = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEntity(id);\n      if (!this.runningEffects[id]) {\n        this.runningEffects[id] = {\n          duration: 0,\n          level: level\n        };\n      } else {\n        level = Math.max(level, this.runningEffects[id].level);\n      }\n      this.runningEffects[id].isRunning = true;\n      // this.runningEffects[id].duration = 0;\n\n      if (game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getAttribute(id, 'duration') && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.entityExists(\"active_\".concat(id))) {\n        var _level;\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.registerGameEntity(\"active_\".concat(id), {\n          copyFromId: id,\n          isAbstract: false,\n          level: level,\n          tags: ['active_temporary', 'active_effect'],\n          scope: 'events'\n        });\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setEntityLevel(\"active_\".concat(id), (_level = level) !== null && _level !== void 0 ? _level : 1, true);\n      }\n      this.runningEffects[id].duration = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getAttribute(id, 'duration');\n      this.runningEffects[id].isRunning = true;\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/general/temporary-effects.module.js?");

/***/ }),

/***/ "./src/worker/modules/inventory/inventory-items-db.js":
/*!************************************************************!*\
  !*** ./src/worker/modules/inventory/inventory-items-db.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerInventoryItems: () => (/* binding */ registerInventoryItems)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar updateLevelBy = function updateLevelBy(id, amount) {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(id, game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(id) + amount, true);\n};\nvar registerInventoryItems = function registerInventoryItems() {\n  var charismaMod = function charismaMod(attr) {\n    return attr > 0 ? 1. / (1. + 0.02 * Math.log2(attr * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('prices_discount'))) : 1.;\n  };\n  var metabolismMod = function metabolismMod(attr) {\n    return attr > 1 ? 1. / Math.pow(attr, 0.25) : 1.;\n  };\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_berry', {\n    name: 'Berry',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 5 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    usageGain: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            health: {\n              A: 1,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 5 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0;\n    },\n    sellPrice: 5,\n    rarity: 0,\n    allowedTileTypes: ['plain', 'forest', 'lakes', 'hills']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_bread', {\n    name: 'Bread',\n    hasCap: false,\n    tags: ['inventory', 'consumable'],\n    defaultCap: 0,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    usageGain: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            energy: {\n              A: 5,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 5 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0;\n    },\n    sellPrice: 2\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_fly_mushroom', {\n    name: 'Fly Mushroom',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    usageGain: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            knowledge: {\n              A: 3,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            health: {\n              A: 5,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0;\n    },\n    sellPrice: 40,\n    rarity: 0,\n    allowedTileTypes: ['swamp', 'forest', 'lakes']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_golden_algae', {\n    name: 'Golden Algae',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    usageGain: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'mage-xp': {\n              A: 500,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            energy: {\n              A: 1,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0;\n    },\n    sellPrice: 80,\n    rarity: 0.6\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_knowledge_moss', {\n    name: 'Knowledge Moss',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 20\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            learning_rate: {\n              A: 0.25,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0;\n    },\n    sellPrice: 350,\n    rarity: 0.6,\n    allowedTileTypes: ['plain', 'lakes', 'swamp']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_core_duckweed', {\n    name: 'Core Duckweed',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 20\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            physical_training_learn_speed: {\n              A: 0.5,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0;\n    },\n    sellPrice: 350,\n    rarity: 0.6,\n    allowedTileTypes: ['lakes', 'swamp', 'savanna']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_aloe_vera', {\n    name: 'Aloe Vera',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 20 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    usageGain: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            health: {\n              A: 10,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_1') > 0;\n    },\n    sellPrice: 120,\n    rarity: 1,\n    allowedTileTypes: ['plain', 'savanna']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_ginseng', {\n    name: 'Ginseng',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 20\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            health: {\n              A: 5,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          resources: {\n            energy: {\n              A: 0.2,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_1') > 0;\n    },\n    sellPrice: 150,\n    rarity: 1,\n    allowedTileTypes: ['plain', 'mountain', 'hills']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_nightshade', {\n    name: 'Nightshade',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 20\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            health: {\n              A: 15,\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          resources: {\n            mana: {\n              A: 0.2,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_1') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    sellPrice: 200,\n    rarity: 2,\n    allowedTileTypes: ['mountain', 'savanna']\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_mystic_bloom', {\n    name: 'Mystic Bloom',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 250 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 240\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            spell_xp_rate: {\n              A: 0.5,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_3') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    sellPrice: 20000,\n    rarity: 2,\n    allowedTileTypes: ['swamp', 'mountain', 'hills'],\n    lootAmountMult: 0.5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_ember_leaf', {\n    name: 'Ember Leaf',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 200 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 120\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            physical_training_learn_speed: {\n              A: 0.25,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_3') > 0;\n    },\n    sellPrice: 20000,\n    rarity: 2,\n    allowedTileTypes: ['plain', 'savanna'],\n    lootAmountMult: 0.5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_harmony_blossom', {\n    name: 'Harmony Blossom',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 200 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 120\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            social_training_learning_rate: {\n              A: 0.5,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_3') > 0;\n    },\n    sellPrice: 20000,\n    rarity: 2,\n    allowedTileTypes: ['mountain', 'forest'],\n    lootAmountMult: 0.5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_wood', {\n    name: 'Wood',\n    hasCap: false,\n    tags: ['inventory', 'material'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_woodcutter');\n    },\n    sellPrice: 1200,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 5000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_refined_wood', {\n    name: 'Refined Wood',\n    hasCap: false,\n    tags: ['inventory', 'material', 'craftable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    sellPrice: 5600,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 50000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_paper', {\n    name: 'Paper',\n    hasCap: false,\n    tags: ['inventory', 'material', 'craftable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_paper_working') > 0;\n    },\n    sellPrice: 14200,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 125000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_enchanted_paper', {\n    name: 'Enchanted Paper',\n    hasCap: false,\n    tags: ['inventory', 'material', 'craftable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_paper_enhance') > 0;\n    },\n    sellPrice: 320000,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 6400000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_herbal_fibers', {\n    name: 'Herbal Fibers',\n    hasCap: false,\n    tags: ['inventory', 'material', 'craftable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    sellPrice: 10000,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 75000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_stone', {\n    name: 'Stone',\n    hasCap: false,\n    tags: ['inventory', 'material'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockedBy: {\n      type: 'entity',\n      id: 'action_quarrying',\n      level: 1\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_quarrying');\n    },\n    sellPrice: 1625,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 12500 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_iron_ore', {\n    name: 'Iron Ore',\n    hasCap: false,\n    tags: ['inventory', 'material'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockedBy: {\n      type: 'entity',\n      id: 'action_mining',\n      level: 1\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_mining');\n    },\n    sellPrice: 15625,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 125000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_ruby', {\n    name: 'Ruby',\n    hasCap: false,\n    tags: ['inventory', 'material', 'craftable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_quarrying',\n      level: 2\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_quarrying');\n    },\n    sellPrice: 12000,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 800000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_sapphire', {\n    name: 'Sapphire',\n    hasCap: false,\n    tags: ['inventory', 'material', 'craftable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_quarrying',\n      level: 2\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_quarrying');\n    },\n    sellPrice: 16000,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 1000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_iron_plate', {\n    name: 'Iron Plate',\n    hasCap: false,\n    tags: ['inventory', 'material', 'craftable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    attributes: {},\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_mining',\n      level: 2\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_mining');\n    },\n    sellPrice: 160000,\n    get_cost: function get_cost() {\n      var amount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      return {\n        coins: amount * 10000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_small_endurance_flask', {\n    name: 'Small Endurance Flask',\n    hasCap: false,\n    tags: ['inventory', 'consumable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 150 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 150\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            energy: {\n              A: 0,\n              B: 5,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    sellPrice: 225\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_healing_potion', {\n    name: 'Small Healing Potion',\n    hasCap: false,\n    tags: ['inventory', 'consumable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 150 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 150\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            health: {\n              A: 0,\n              B: 5,\n              type: 0\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    sellPrice: 425\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_experience_potion', {\n    name: 'Small Experience Potion',\n    hasCap: false,\n    tags: ['inventory', 'consumable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 150 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      duration: 120\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          learning_rate: {\n            A: 1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          health: {\n            A: 10,\n            B: 0,\n            type: 0\n          },\n          mana: {\n            A: 5,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    sellPrice: 1500\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_insight_potion', {\n    name: 'Insight Potion',\n    hasCap: false,\n    tags: ['inventory', 'consumable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 20 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {},\n    usageGain: {\n      income: {\n        resources: {\n          'mage-xp': {\n            A: 25000,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    sellPrice: 1500\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_amnesia_potion', {\n    name: 'Amnesia Potion',\n    hasCap: false,\n    tags: ['inventory', 'consumable'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('mage').resetPerks();\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 3600 * 24;\n    },\n    attributes: {\n      duration: 24 * 3600\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          learning_rate: {\n            A: -0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    sellPrice: 15000\n  });\n\n  // Rare\n\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_titanleaf', {\n    name: 'Titanleaf',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_titanleaf_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_titanleaf_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_heartroot', {\n    name: 'Heartroot',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_heartroot_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_heartroot_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_energloom', {\n    name: 'Energloom',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_energloom_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_energloom_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_lifebloom', {\n    name: 'Lifebloom',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_lifebloom_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_lifebloom_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_stillfern', {\n    name: 'Stillfern',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_stillfern_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_stillfern_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_mindroot', {\n    name: 'Mindroot',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_mindroot_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_mindroot_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_azureblossom', {\n    name: 'Azureblossom',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_azureblossom_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_azureblossom_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_ironvine', {\n    name: 'Ironvine',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_ironvine_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_ironvine_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_mindspire', {\n    name: 'Mindspire',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_mindspire_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_mindspire_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('inventory_rare_verdant_coil', {\n    name: 'Verdant Coil',\n    hasCap: false,\n    tags: ['inventory', 'consumable', 'rare', 'gatherable', 'herb'],\n    defaultCap: 0,\n    isAbstract: true,\n    onUse: function onUse(amount) {\n      updateLevelBy('rare_verdant_coil_effect', amount);\n    },\n    getUsageCooldown: function getUsageCooldown() {\n      return 0.1 * metabolismMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('metabolism_rate'));\n    },\n    attributes: {\n      baseChanceMult: 1,\n      entityEffect: 'rare_verdant_coil_effect',\n      isRare: true,\n      allowMultiConsume: true\n    },\n    usageGain: {},\n    resourceModifier: {},\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_3') > 0;\n    },\n    sellPrice: 15000,\n    rarity: 5\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/inventory/inventory-items-db.js?");

/***/ }),

/***/ "./src/worker/modules/inventory/inventory.module.js":
/*!**********************************************************!*\
  !*** ./src/worker/modules/inventory/inventory.module.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InventoryModule: () => (/* binding */ InventoryModule)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _inventory_items_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./inventory-items-db */ \"./src/worker/modules/inventory/inventory-items-db.js\");\n/* harmony import */ var _shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/utils/rule-utils */ \"./src/worker/shared/utils/rule-utils.js\");\n/* harmony import */ var game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! game-framework/src/utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\n/* harmony import */ var _shared_utils_objects__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../shared/utils/objects */ \"./src/worker/shared/utils/objects.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\n\n\nvar InventoryModule = /*#__PURE__*/function (_GameModule) {\n  function InventoryModule() {\n    var _this;\n    _classCallCheck(this, InventoryModule);\n    _this = _callSuper(this, InventoryModule);\n    _this.inventoryItems = {};\n    _this.isUnlocked = false;\n    _this.autoConsumeCD = 2;\n    _this.selectedFilterId = 'all';\n    _this.filters = [{\n      id: 'all',\n      name: 'All',\n      tags: [],\n      isDefault: true\n    }, {\n      id: 'consumable',\n      name: 'Consumable',\n      tags: ['consumable'],\n      isDefault: true\n    }, {\n      id: 'materials',\n      name: 'Materials',\n      tags: ['material'],\n      isDefault: false\n    }];\n    _this.eventHandler.registerHandler('consume-inventory', function (payload) {\n      _this.consumeItem(payload.id, payload.amount);\n      if (payload.sendDetails) {\n        _this.sendItemDetails(payload.id);\n      }\n    });\n    _this.eventHandler.registerHandler('sell-inventory', function (payload) {\n      _this.sellItem(payload.id, payload.amount);\n    });\n    _this.eventHandler.registerHandler('query-inventory-data', function (payload) {\n      _this.sendInventoryData(_this.selectedFilterId, payload);\n    });\n    _this.eventHandler.registerHandler('query-inventory-details', function (payload) {\n      _this.sendItemDetails(payload.id);\n    });\n    _this.eventHandler.registerHandler('query-sell-details', function (payload) {\n      _this.sendSellDetails(payload.id);\n    });\n    _this.eventHandler.registerHandler('save-inventory-settings', function (payload) {\n      _this.saveSettings(payload);\n    });\n    _this.eventHandler.registerHandler('set-selected-inventory-filter', function (_ref) {\n      var filterId = _ref.filterId;\n      _this.selectedFilterId = filterId;\n    });\n    return _this;\n  }\n  _inherits(InventoryModule, _GameModule);\n  return _createClass(InventoryModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n\n      // registerInventoryItems();\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      this.autoConsumeCD -= delta;\n\n      // trigger autoconsume\n      for (var itemId in this.inventoryItems) {\n        var _this$inventoryItems$, _this$inventoryItems$4;\n        this.inventoryItems[itemId].isConsumed = false;\n        if (this.inventoryItems[itemId].duration > 0) {\n          this.inventoryItems[itemId].duration -= delta;\n          if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.entityExists(\"active_\".concat(itemId))) {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setAttribute(\"active_\".concat(itemId), 'current_duration', this.inventoryItems[itemId].duration);\n          }\n        }\n        if (this.inventoryItems[itemId].duration <= 0) {\n          this.inventoryItems[itemId].duration = 0;\n          if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.entityExists(\"active_\".concat(itemId))) {\n            var _gameResources$getRes;\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.unsetEntity(\"active_\".concat(itemId));\n            this.inventoryItems[itemId].cooldown = (_gameResources$getRes = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(itemId).getUsageCooldown()) !== null && _gameResources$getRes !== void 0 ? _gameResources$getRes : 0;\n          }\n        }\n        if (this.inventoryItems[itemId].cooldown > 0) {\n          this.inventoryItems[itemId].cooldown -= delta;\n        }\n        if (this.inventoryItems[itemId].stockCapacity < game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('shop_max_stock')) {\n          this.inventoryItems[itemId].stockCapacity += delta * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('shop_stock_renew_rate');\n        }\n        if (this.autoConsumeCD > 0) {\n          continue;\n        }\n        if ((_this$inventoryItems$ = this.inventoryItems[itemId]) !== null && _this$inventoryItems$ !== void 0 && (_this$inventoryItems$ = _this$inventoryItems$.autoconsume) !== null && _this$inventoryItems$ !== void 0 && (_this$inventoryItems$ = _this$inventoryItems$.rules) !== null && _this$inventoryItems$ !== void 0 && _this$inventoryItems$.length) {\n          var _this$inventoryItems$2, _this$inventoryItems$3;\n          // check if matching rules\n          var isMatching = (0,_shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_3__.checkMatchingRules)((_this$inventoryItems$2 = this.inventoryItems[itemId]) === null || _this$inventoryItems$2 === void 0 || (_this$inventoryItems$2 = _this$inventoryItems$2.autoconsume) === null || _this$inventoryItems$2 === void 0 ? void 0 : _this$inventoryItems$2.rules, (_this$inventoryItems$3 = this.inventoryItems[itemId]) === null || _this$inventoryItems$3 === void 0 || (_this$inventoryItems$3 = _this$inventoryItems$3.autoconsume) === null || _this$inventoryItems$3 === void 0 ? void 0 : _this$inventoryItems$3.pattern);\n\n          // console.log('RULES MATCHED: ', isMatching);\n          if (isMatching) {\n            this.consumeItem(itemId, 1);\n          }\n        }\n        if ((_this$inventoryItems$4 = this.inventoryItems[itemId]) !== null && _this$inventoryItems$4 !== void 0 && (_this$inventoryItems$4 = _this$inventoryItems$4.autosell) !== null && _this$inventoryItems$4 !== void 0 && (_this$inventoryItems$4 = _this$inventoryItems$4.rules) !== null && _this$inventoryItems$4 !== void 0 && _this$inventoryItems$4.length) {\n          var _this$inventoryItems$5, _this$inventoryItems$6;\n          var _isMatching = (0,_shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_3__.checkMatchingRules)((_this$inventoryItems$5 = this.inventoryItems[itemId]) === null || _this$inventoryItems$5 === void 0 || (_this$inventoryItems$5 = _this$inventoryItems$5.autosell) === null || _this$inventoryItems$5 === void 0 ? void 0 : _this$inventoryItems$5.rules, (_this$inventoryItems$6 = this.inventoryItems[itemId]) === null || _this$inventoryItems$6 === void 0 || (_this$inventoryItems$6 = _this$inventoryItems$6.autosell) === null || _this$inventoryItems$6 === void 0 ? void 0 : _this$inventoryItems$6.pattern);\n          if (_isMatching) {\n            this.sellItem(itemId, 1);\n          }\n        }\n      }\n      if (this.autoConsumeCD <= 0) {\n        this.autoConsumeCD = 2;\n      }\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        inventory: this.inventoryItems,\n        selectedFilterId: this.selectedFilterId\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {\n      var _saveObject$inventory;\n      for (var key in this.inventoryItems) {\n        if (this.inventoryItems[key].duration && this.inventoryItems[key].duration > 0) {\n          // we should unset existing\n          if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.entityExists(\"active_\".concat(key))) {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.unsetEntity(\"active_\".concat(key));\n          }\n        }\n      }\n      this.inventoryItems = (_saveObject$inventory = saveObject === null || saveObject === void 0 ? void 0 : saveObject.inventory) !== null && _saveObject$inventory !== void 0 ? _saveObject$inventory : {};\n      this.selectedFilterId = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.selectedFilterId) || 'all';\n      for (var _key in this.inventoryItems) {\n        if (!('stockCapacity' in this.inventoryItems[_key])) {\n          this.inventoryItems[_key].stockCapacity = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('shop_max_stock');\n        }\n        if (this.inventoryItems[_key].duration && this.inventoryItems[_key].duration > 0) {\n          var _gameResources$getRes2;\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(\"active_\".concat(_key), {\n            originalId: _key,\n            name: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(_key).name,\n            isAbstract: false,\n            tags: ['active_consumable', 'active_effect'],\n            scope: 'resources',\n            level: 1,\n            resourceModifier: (_gameResources$getRes2 = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(_key).resourceModifier) !== null && _gameResources$getRes2 !== void 0 ? _gameResources$getRes2 : undefined\n          });\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(\"active_\".concat(_key), 1);\n        }\n      }\n      this.sendInventoryData(this.selectedFilterId);\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.load({});\n    }\n  }, {\n    key: \"getConsumeAffordable\",\n    value: function getConsumeAffordable(resource, realCons) {\n      var result = {\n        isAffordable: true,\n        consume: {}\n      };\n      if (resource.usageGain) {\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(resource.usageGain, realCons);\n        if (effects.length) {\n          var rsToRemove = effects.filter(function (eff) {\n            return eff.scope === 'consumption' && eff.type === 'resources';\n          });\n          console.log('IIII: ', effects, rsToRemove, realCons);\n          rsToRemove.forEach(function (rs) {\n            result.consume[rs.id] = rs.value;\n            if (result.consume[rs.id] > game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(rs.id).amount) {\n              result.isAffordable = false;\n            }\n          });\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"consumeItem\",\n    value: function consumeItem(id, amount) {\n      var resource = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(id);\n      var realCons = Math.min(amount, resource.amount);\n      if (this.inventoryItems[id] && (this.inventoryItems[id].cooldown > 0 || this.inventoryItems[id].duration > 0)) return;\n      if (realCons < 1) return;\n      if (resource.usageGain || resource.resourceModifier) {\n        var _resource$attributes;\n        var aff = this.getConsumeAffordable(resource, realCons);\n        if (!aff.isAffordable) {\n          return;\n        }\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(resource.usageGain || {}, realCons);\n        if (effects.length) {\n          var rsToAdd = effects.filter(function (eff) {\n            return eff.scope === 'income' && eff.type === 'resources';\n          });\n\n          // console.log('consAddR: ', effects, rsToAdd, realCons);\n\n          rsToAdd.forEach(function (rs) {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(rs.id, rs.value);\n          });\n        }\n        for (var key in aff.consume) {\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(key, -aff.consume[key]);\n        }\n        if (!this.inventoryItems[id]) {\n          this.inventoryItems[id] = {\n            stockCapacity: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('shop_max_stock')\n          };\n        }\n        this.inventoryItems[id].isConsumed = true;\n        if ((_resource$attributes = resource.attributes) !== null && _resource$attributes !== void 0 && _resource$attributes.duration && resource.resourceModifier) {\n          var _resource$resourceMod;\n          // has active effect\n\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(\"active_\".concat(id), {\n            originalId: id,\n            name: resource.name,\n            isAbstract: false,\n            level: 1,\n            tags: ['active_consumable', 'active_effect'],\n            scope: 'resources',\n            resourceModifier: (_resource$resourceMod = resource.resourceModifier) !== null && _resource$resourceMod !== void 0 ? _resource$resourceMod : undefined\n          });\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(\"active_\".concat(id), 1);\n          this.inventoryItems[id].duration = resource.attributes.duration;\n        } else {\n          var _resource$getUsageCoo;\n          this.inventoryItems[id].cooldown = (_resource$getUsageCoo = resource.getUsageCooldown()) !== null && _resource$getUsageCoo !== void 0 ? _resource$getUsageCoo : 0;\n        }\n      }\n      if (resource.onUse) {\n        resource.onUse(realCons);\n      }\n      this.inventoryItems[id].numConsumed = (this.inventoryItems[id].numConsumed || 0) + realCons;\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(id, -realCons);\n      this.sendInventoryData(this.selectedFilterId);\n    }\n  }, {\n    key: \"sellItem\",\n    value: function sellItem(id, amount) {\n      var _this$inventoryItems$7;\n      var resource = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(id);\n      var realCons = Math.min(amount, resource.amount, ((_this$inventoryItems$7 = this.inventoryItems[id]) === null || _this$inventoryItems$7 === void 0 ? void 0 : _this$inventoryItems$7.stockCapacity) || 10);\n      if (this.inventoryItems[id] && this.inventoryItems[id].stockCapacity <= 0) return;\n      if (realCons < 1) return;\n      if (resource.sellPrice) {\n        if (!this.inventoryItems[id]) {\n          this.inventoryItems[id] = {\n            stockCapacity: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('shop_max_stock')\n          };\n        }\n        this.inventoryItems[id].stockCapacity -= realCons;\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(id, -realCons);\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource('coins', realCons * resource.sellPrice);\n      }\n      this.sendInventoryData(this.selectedFilterId);\n    }\n  }, {\n    key: \"saveSettings\",\n    value: function saveSettings(payload) {\n      if (payload.id) {\n        this.inventoryItems[payload.id] = _objectSpread(_objectSpread({}, this.inventoryItems[payload.id]), {}, {\n          autoconsume: payload.autoconsume,\n          autosell: payload.autosell\n        });\n      }\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      // NOW - check for actions if they have any new notifications\n\n      this.filters.forEach(function (filter) {\n        var items = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.listResourcesByTags(['inventory'].concat(_toConsumableArray(filter.tags)));\n        items.forEach(function (item) {\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('inventory', filter.id, \"inventory_\".concat(item.id), item.isUnlocked && (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(item.id).amount >= 1 || Math.abs(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(item.id).income) >= game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER));\n        });\n      });\n    }\n  }, {\n    key: \"getItemsData\",\n    value: function getItemsData(filterId, pl) {\n      var _this2 = this;\n      var perCats = this.filters.reduce(function (acc, filter) {\n        acc[filter.id] = {\n          id: filter.id,\n          name: filter.name,\n          tags: filter.tags,\n          items: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.listResourcesByTags(['inventory'].concat(_toConsumableArray(filter.tags))).filter(function (one) {\n            var _this2$inventoryItems, _this2$inventoryItems2;\n            return one.isUnlocked && !one.isCapped && (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(one.id).amount >= 1 || Math.abs(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(one.id).income) >= game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER || ((_this2$inventoryItems = _this2.inventoryItems[one.id]) === null || _this2$inventoryItems === void 0 || (_this2$inventoryItems = _this2$inventoryItems.autoconsume) === null || _this2$inventoryItems === void 0 || (_this2$inventoryItems = _this2$inventoryItems.rules) === null || _this2$inventoryItems === void 0 ? void 0 : _this2$inventoryItems.length) || ((_this2$inventoryItems2 = _this2.inventoryItems[one.id]) === null || _this2$inventoryItems2 === void 0 || (_this2$inventoryItems2 = _this2$inventoryItems2.autosell) === null || _this2$inventoryItems2 === void 0 || (_this2$inventoryItems2 = _this2$inventoryItems2.rules) === null || _this2$inventoryItems2 === void 0 ? void 0 : _this2$inventoryItems2.length));\n          }),\n          isSelected: filterId === filter.id\n        };\n        return acc;\n      }, {});\n      if (!filterId) {\n        filterId = 'all';\n      }\n      var entities = perCats[filterId].items;\n      var presentItems = entities;\n      if (pl !== null && pl !== void 0 && pl.filterAutomatedSell) {\n        presentItems = presentItems.filter(function (p) {\n          var _this2$inventoryItems3;\n          return (_this2$inventoryItems3 = _this2.inventoryItems[p.id]) === null || _this2$inventoryItems3 === void 0 || (_this2$inventoryItems3 = _this2$inventoryItems3.autosell) === null || _this2$inventoryItems3 === void 0 || (_this2$inventoryItems3 = _this2$inventoryItems3.rules) === null || _this2$inventoryItems3 === void 0 ? void 0 : _this2$inventoryItems3.length;\n        });\n      }\n      if (pl !== null && pl !== void 0 && pl.filterAutomatedConsume) {\n        presentItems = presentItems.filter(function (p) {\n          var _this2$inventoryItems4;\n          return (_this2$inventoryItems4 = _this2.inventoryItems[p.id]) === null || _this2$inventoryItems4 === void 0 || (_this2$inventoryItems4 = _this2$inventoryItems4.autoconsume) === null || _this2$inventoryItems4 === void 0 || (_this2$inventoryItems4 = _this2$inventoryItems4.rules) === null || _this2$inventoryItems4 === void 0 ? void 0 : _this2$inventoryItems4.length;\n        });\n      }\n      if (pl !== null && pl !== void 0 && pl.includeAutomations) {\n        presentItems = presentItems.map(function (item) {\n          var _this2$inventoryItems5, _this2$inventoryItems6, _this2$inventoryItems7, _this2$inventoryItems8;\n          return _objectSpread(_objectSpread({}, item), {}, {\n            autoconsume: (_this2$inventoryItems5 = (_this2$inventoryItems6 = _this2.inventoryItems[item.id]) === null || _this2$inventoryItems6 === void 0 ? void 0 : _this2$inventoryItems6.autoconsume) !== null && _this2$inventoryItems5 !== void 0 ? _this2$inventoryItems5 : {\n              rules: []\n            },\n            autosell: (_this2$inventoryItems7 = (_this2$inventoryItems8 = _this2.inventoryItems[item.id]) === null || _this2$inventoryItems8 === void 0 ? void 0 : _this2$inventoryItems8.autosell) !== null && _this2$inventoryItems7 !== void 0 ? _this2$inventoryItems7 : {\n              rules: []\n            }\n          });\n        });\n      }\n      return {\n        available: presentItems.map(function (resource) {\n          var _resource$attributes2, _this2$inventoryItems9, _this2$inventoryItems10, _this2$inventoryItems11, _this2$inventoryItems12, _this2$inventoryItems13, _resource$attributes3;\n          return _objectSpread(_objectSpread({}, resource), {}, {\n            isRare: (_resource$attributes2 = resource.attributes) === null || _resource$attributes2 === void 0 ? void 0 : _resource$attributes2.isRare,\n            isConsumable: resource.tags.includes('consumable'),\n            isConsumed: (_this2$inventoryItems9 = _this2.inventoryItems[resource.id]) === null || _this2$inventoryItems9 === void 0 ? void 0 : _this2$inventoryItems9.isConsumed,\n            cooldown: (_this2$inventoryItems10 = (_this2$inventoryItems11 = _this2.inventoryItems[resource.id]) === null || _this2$inventoryItems11 === void 0 ? void 0 : _this2$inventoryItems11.cooldown) !== null && _this2$inventoryItems10 !== void 0 ? _this2$inventoryItems10 : 0,\n            cooldownProg: resource.getUsageCooldown ? (resource.getUsageCooldown() - ((_this2$inventoryItems12 = (_this2$inventoryItems13 = _this2.inventoryItems[resource.id]) === null || _this2$inventoryItems13 === void 0 ? void 0 : _this2$inventoryItems13.cooldown) !== null && _this2$inventoryItems12 !== void 0 ? _this2$inventoryItems12 : 0)) / resource.getUsageCooldown() : 1,\n            allowMultiConsume: (_resource$attributes3 = resource.attributes) === null || _resource$attributes3 === void 0 ? void 0 : _resource$attributes3.allowMultiConsume\n          });\n        }),\n        itemCategories: Object.values(perCats).filter(function (cat) {\n          return cat.items.length > 0;\n        }),\n        payload: pl,\n        selectedFilterId: filterId\n      };\n    }\n  }, {\n    key: \"sendInventoryData\",\n    value: function sendInventoryData(filter, pl) {\n      var data = this.getItemsData(filter, pl);\n      var label = 'inventory-data';\n      if (pl !== null && pl !== void 0 && pl.prefix) {\n        label = \"\".concat(label, \"-\").concat(pl.prefix);\n      }\n      this.eventHandler.sendData(label, data);\n    }\n  }, {\n    key: \"getItemDetails\",\n    value: function getItemDetails(id) {\n      var _resource$attributes4, _resource$attributes7, _this$inventoryItems$8, _this$inventoryItems$9, _this$inventoryItems$10, _this$inventoryItems$11, _this$inventoryItems$12, _this$inventoryItems$13, _this$inventoryItems$14, _resource$attributes8, _this$inventoryItems$15;\n      if (!id) return null;\n      var resource = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(id);\n      var effects = [];\n      if (resource.usageGain) {\n        effects = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(resource.usageGain, 1);\n      }\n\n      // const currentEffects = resource.attributes?.entityEffect ? gameEntity.getEffects(resource.attributes?.entityEffect) : null;\n      // let potentialEffects = resource.resourceModifier ? resourceApi.unpackEffects(resource.resourceModifier, 1) : [];\n\n      var permanentEffects;\n      var potentialPermanentEffects;\n      if ((_resource$attributes4 = resource.attributes) !== null && _resource$attributes4 !== void 0 && _resource$attributes4.entityEffect) {\n        var _resource$attributes5, _resource$attributes6;\n        permanentEffects = (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_5__.packEffects)(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects((_resource$attributes5 = resource.attributes) === null || _resource$attributes5 === void 0 ? void 0 : _resource$attributes5.entityEffect));\n        potentialPermanentEffects = (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_5__.packEffects)(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects((_resource$attributes6 = resource.attributes) === null || _resource$attributes6 === void 0 ? void 0 : _resource$attributes6.entityEffect, 1));\n      }\n      console.log('EEFF: ', (_resource$attributes7 = resource.attributes) === null || _resource$attributes7 === void 0 ? void 0 : _resource$attributes7.entityEffect, permanentEffects, potentialPermanentEffects);\n      return {\n        id: resource.id,\n        name: resource.name,\n        description: resource.description,\n        breakdown: resource.breakdown,\n        amount: Math.floor(resource.amount || 0),\n        effects: effects,\n        tags: resource.tags || [],\n        autoconsume: (_this$inventoryItems$8 = (_this$inventoryItems$9 = this.inventoryItems[resource.id]) === null || _this$inventoryItems$9 === void 0 ? void 0 : _this$inventoryItems$9.autoconsume) !== null && _this$inventoryItems$8 !== void 0 ? _this$inventoryItems$8 : {\n          rules: []\n        },\n        autosell: (_this$inventoryItems$10 = (_this$inventoryItems$11 = this.inventoryItems[resource.id]) === null || _this$inventoryItems$11 === void 0 ? void 0 : _this$inventoryItems$11.autosell) !== null && _this$inventoryItems$10 !== void 0 ? _this$inventoryItems$10 : {\n          rules: []\n        },\n        isConsumed: (_this$inventoryItems$12 = this.inventoryItems[resource.id]) === null || _this$inventoryItems$12 === void 0 ? void 0 : _this$inventoryItems$12.isConsumed,\n        isSellable: !!resource.sellPrice,\n        sellPrice: resource.sellPrice,\n        maxSell: Math.min((_this$inventoryItems$13 = (_this$inventoryItems$14 = this.inventoryItems[resource.id]) === null || _this$inventoryItems$14 === void 0 ? void 0 : _this$inventoryItems$14.stockCapacity) !== null && _this$inventoryItems$13 !== void 0 ? _this$inventoryItems$13 : game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('shop_max_stock'), Math.floor(resource.amount)),\n        duration: ((_resource$attributes8 = resource.attributes) === null || _resource$attributes8 === void 0 ? void 0 : _resource$attributes8.duration) || 0,\n        potentialEffects: resource.resourceModifier ? game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(resource.resourceModifier, 1) : [],\n        consumptionCooldown: resource.getUsageCooldown ? resource.getUsageCooldown() : 0,\n        permanentEffects: permanentEffects,\n        potentialPermanentEffects: potentialPermanentEffects,\n        numConsumed: ((_this$inventoryItems$15 = this.inventoryItems[resource.id]) === null || _this$inventoryItems$15 === void 0 ? void 0 : _this$inventoryItems$15.numConsumed) || 0\n      };\n    }\n  }, {\n    key: \"sendItemDetails\",\n    value: function sendItemDetails(id) {\n      var data = this.getItemDetails(id);\n      this.eventHandler.sendData('inventory-details', data);\n    }\n  }, {\n    key: \"sendSellDetails\",\n    value: function sendSellDetails(id) {\n      var _this$inventoryItems$16, _this$inventoryItems$17;\n      if (!id) return null;\n      var resource = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(id);\n      var data = {\n        id: id,\n        isSellable: !!resource.sellPrice,\n        sellPrice: resource.sellPrice,\n        maxSell: Math.min((_this$inventoryItems$16 = (_this$inventoryItems$17 = this.inventoryItems[resource.id]) === null || _this$inventoryItems$17 === void 0 ? void 0 : _this$inventoryItems$17.stockCapacity) !== null && _this$inventoryItems$16 !== void 0 ? _this$inventoryItems$16 : game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('shop_max_stock'), Math.floor(resource.amount))\n      };\n      this.eventHandler.sendData('sell-details', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_1__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/inventory/inventory.module.js?");

/***/ }),

/***/ "./src/worker/modules/items/shop-db.js":
/*!*********************************************!*\
  !*** ./src/worker/modules/items/shop-db.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   charismaMod: () => (/* binding */ charismaMod),\n/* harmony export */   registerShopItemsStage1: () => (/* binding */ registerShopItemsStage1)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar charismaMod = function charismaMod(attr) {\n  return attr > 0 ? 1. / (1. + 0.02 * Math.log2(attr * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('prices_discount'))) : 1.;\n};\nvar registerShopItemsStage1 = function registerShopItemsStage1() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_hat', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Hat',\n    description: 'Purchase a hat to collect more coins from begging and have a bit more place to store them',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'begging_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      rawCap: {\n        resources: {\n          'coins': {\n            A: 8,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 2 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_notebook', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Notebook',\n    description: 'Allows you for planning your actions. Unlocks actions list',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_hat') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 5 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_bag', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Bag',\n    description: 'Purchase a bag to store more coins',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_hat') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      rawCap: {\n        resources: {\n          'coins': {\n            A: 10,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 10 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          B: 5 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_slippers', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Repair Slippers',\n    description: 'Your slippers are old, but better than nothing. If you repair it, it could make you feel more comfortable and warm',\n    level: 0,\n    maxLevel: 6,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_hat') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'walking_learning_rate': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.4,\n          B: 5 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_dairy', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Diary',\n    description: 'Use your diary to write up what you have learned everyday. Improves learning rate',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_notebook') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 10 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'learning_rate': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_book_of_motivation', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Book of Motivation',\n    description: 'Purchase a book that you can read when you have time. Maybe you will find something useful there',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_dairy') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 20 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_book_of_math', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Book of Math',\n    description: 'Allows you doing some primitive math exercises to train your brain in calculating coins',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_book_of_motivation') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 30 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_panpipe', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Panpipe',\n    description: 'Perform some primitive show to improve begging efficiency',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_bag') > 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'begging_efficiency': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 25 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_shovel', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Shovel',\n    description: 'Primitive tool to increase your working at stable efficiency',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_bag') > 1 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_clean_stable') > 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'clean_stable_efficiency': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 30 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_better_tools', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Tools',\n    description: 'Purchase better tools, improve your performance at any job. Increase coins income',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_shovel') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'coins': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 125 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_backpack', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Backpack',\n    description: 'Unlocks inventory and items',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_bag') > 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 30 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_tent', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Tent',\n    description: 'Purchase your very first living property. Not really comfortable, but better than nothing',\n    level: 0,\n    maxLevel: 5,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_bag') > 2;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 3,\n            type: 0\n          }\n        }\n      },\n      get_capMult: function get_capMult() {\n        return {\n          resources: {\n            coins: {\n              A: 0,\n              B: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('coins_cap_bonus'),\n              type: 0\n            }\n          }\n        };\n      },\n      effectDeps: ['coins_cap_bonus']\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 40 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_better_urns', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Better Urns',\n    description: 'Purchase better urns to increase their capacity',\n    level: 0,\n    maxLevel: 3,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'urn_storage_bonus': {\n            A: 0.5,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 120 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_library_entrance', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Entrance To Library',\n    description: 'Invest some coins you have earned into your own development',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 200 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_purchase_manager', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Purchase Manager',\n    description: 'An efficient tool that automates the process of buying upgrades in the shop.',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 10000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_anatomy_book', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Anatomy Book',\n    description: 'Purchase book that can improve your understanding of your body',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 2,\n          B: 5 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        },\n        'coins': {\n          A: 2,\n          B: 250 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_glasses', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Glasses',\n    description: 'Purchase glasses to read better and gather knowledge faster',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'read_books_efficiency': {\n            A: 0.5,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 350 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_yoga_manual', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Yoga Manual',\n    description: 'Purchase yoga manual to train your patience and improve gathering and routine tasks performance',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 400 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_vocabulary', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Vocabulary',\n    description: 'Most of books are written in old and obscure languages. Purchase vocabulary and start learning languages to make your book reading more efficient',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 2,\n          B: 10 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        },\n        'coins': {\n          A: 2,\n          B: 1000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_handbook', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Handbook',\n    description: 'Contains useful information regarding ancient civilizations languages.',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_vocabulary') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'knowledge': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 20 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 1250 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_spellbook', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Spellbook',\n    description: 'Contains some basic magic knowledge.',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_vocabulary') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 40 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 2500 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_knife', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Knife',\n    description: 'Its barely a good weapon, but it can be used to cut things you found more efficiently',\n    level: 0,\n    maxLevel: 1,\n    unlockedBy: [{\n      type: 'entity',\n      id: 'action_gather_carefully',\n      level: 2\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'gathering_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 750 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_gathering_equipment', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Gathering Equipment',\n    description: 'Purchase Basic Gathering equipment to increase probability of finding regular items and herbs',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_knife');\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'gathering_low_chance': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 1250 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_herbs_handbook_1', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Herbs Handbook I',\n    description: 'Learn new herbs and their effects',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_knife') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 3000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_herbs_handbook_2', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Herbs Handbook II',\n    description: 'Learn more sophisticated and rare herbs',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_1') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 400000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_herbs_handbook_3', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Herbs Handbook III',\n    description: 'Learn even better recipes based on more rare plants',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 100000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_storeroom', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Storeroom',\n    description: 'Purchase bigger storeroom to store your goods',\n    level: 0,\n    maxLevel: 3,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 4;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'living_space': {\n            A: 5,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      effectDeps: ['coins_cap_bonus']\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 1250 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_meditation', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Meditation Book',\n    description: 'Learn how to meditate to increase your magic abilities.',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 60 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 5000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_less_restoration', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Lesser Restoration',\n    description: 'Learn some basic restoration spells.',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_meditation') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 90 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 8000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_less_illusion', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Lesser Illusion',\n    description: 'Learn some basic illusion spells.',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_meditation') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 90 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 8000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_spellcraft', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Spellcraft',\n    description: 'Learn how to improve your spells by analyzing your mistakes and earning experience. Spells now can be leveled',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_meditation') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 120 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 15000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_magic_training', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Magic Training Book',\n    description: 'Reveal the secrets of magic flowing through your body by learning new practices of training your magic capability',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellcraft') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 160 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 60000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_spiritualism', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Spiritualism Book',\n    description: 'Unlocks way to improve your spiritual activities by consuming magic knowledge. Also, unlocks new furniture',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellcraft') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 180 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 110000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_mages_handbook', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Apprentice Handbook',\n    description: 'Finally, your knowledge is sufficient to read the title of the book. It appears to contain secrets of ancient magic. Although, youre not entirely sure youll be able to read its contents Still, your hand reaches for the shelf to take it.',\n    level: 0,\n    maxLevel: 1,\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_magic_ability',\n      level: 120\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spiritualism') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 500 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 2000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_herbalists_handbook', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Herbalists Handbook',\n    description: 'Learn how to gather seeds and plant different kind of flora near your home. Now you\\'ll be able to purchase new furniture for it!',\n    level: 0,\n    maxLevel: 1,\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_patience',\n      level: 250\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 500 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 2000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_soil_manual', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Soil Types Handbook',\n    description: 'Learn more about soil types that might be suitable for your plants. Increase plantations efficiency and unlock new furniture',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbalists_handbook') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          plantations_efficiency: {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 800 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 8000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_better_stashes', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Better Stashes',\n    description: 'Purchase better stashes to increase coins capacity even more',\n    level: 0,\n    maxLevel: 5,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_storeroom') > 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'urn_storage_bonus': {\n            A: 0.5,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 3000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_land', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Purchase Land',\n    description: 'Purchase some land for even more space',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_storeroom') > 2;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'living_space': {\n            A: 5,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      effectDeps: ['coins_cap_bonus']\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.3,\n          B: 15000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_crafting_courses', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Crafting Courses',\n    description: 'Unlocks crafting and materials processing',\n    level: 0,\n    maxLevel: 1,\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 100\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_strength') >= 100;\n      //||  gameEntity.getLevel('shop_item_conjuration_magic') > 0\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 100000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_alchemy_courses', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Alchemy Courses',\n    description: 'Learn how to create useful potions from your herbs and other ingredients',\n    level: 0,\n    maxLevel: 1,\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_patience',\n      level: 100\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_patience') >= 100;\n      //||  gameEntity.getLevel('shop_item_conjuration_magic') > 0\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 100000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_paper_working', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Paper Working',\n    description: 'Unlocks new resource',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n      //||  gameEntity.getLevel('shop_item_conjuration_magic') > 0\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 5500000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_metaphysics_handbook', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Metaphysics Book',\n    description: 'Learn new ways of boosting your mental stats using improved meditative practices',\n    level: 0,\n    maxLevel: 1,\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_magic_ability',\n      level: 275\n    }],\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_mages_handbook') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 1300 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 11000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_paper_enhance', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Paper Enhancement',\n    description: 'Learn new ways of doing cool stuff from your papers',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_paper_working') > 0;\n      //||  gameEntity.getLevel('shop_item_conjuration_magic') > 0\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2.25,\n          B: 30000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_minor_illusion', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Minor Illusion',\n    description: 'Learn some better illusion spells.',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_less_illusion') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'knowledge': {\n          A: 1.5,\n          B: 9000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'coins': {\n          A: 1.5,\n          B: 40000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('shop_item_geography_book', {\n    tags: [\"shop\", \"upgrade\", \"purchaseable\"],\n    name: 'Geography Basics Book',\n    description: 'Learn basic geography course for better understanding where to search for resources',\n    level: 0,\n    maxLevel: 1,\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_patience',\n      level: 1250\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 1.e+8 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 0\n        }\n      };\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/items/shop-db.js?");

/***/ }),

/***/ "./src/worker/modules/items/shop.module.js":
/*!*************************************************!*\
  !*** ./src/worker/modules/items/shop.module.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ShopModule: () => (/* binding */ ShopModule)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _shop_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shop-db */ \"./src/worker/modules/items/shop-db.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\nvar ShopModule = /*#__PURE__*/function (_GameModule) {\n  function ShopModule() {\n    var _this;\n    _classCallCheck(this, ShopModule);\n    _this = _callSuper(this, ShopModule);\n    _this.purchasedItems = {};\n    _this.isUnlocked = false;\n    _this.leveledId = null;\n    _this.purchaseMultiplier = 1;\n    _this.autoPurchase = {};\n    _this.autoPurchaseCd = 0;\n    _this.eventHandler.registerHandler('set-shop-autopurchase', function (_ref) {\n      var id = _ref.id,\n        flag = _ref.flag;\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['shop']).filter(function (one) {\n        return one.isUnlocked && !one.isCapped;\n      });\n      entities.forEach(function (e) {\n        if (!id || id === e.id) {\n          _this.autoPurchase[e.id] = flag;\n        }\n      });\n      _this.sendItemsData();\n    });\n    _this.eventHandler.registerHandler('set-purchase-multiplier', function (payload) {\n      _this.setPurchaseMultiplier(payload.amount);\n    });\n    _this.eventHandler.registerHandler('purchase-item', function (payload) {\n      _this.purchaseItem(payload.id);\n    });\n    _this.eventHandler.registerHandler('purchase-resource', function (payload) {\n      _this.purchaseResource(payload.id, payload.amount);\n    });\n    _this.eventHandler.registerHandler('query-items-data', function (payload) {\n      _this.sendItemsData();\n    });\n    _this.eventHandler.registerHandler('query-item-details', function (payload) {\n      _this.sendItemDetails(payload.id);\n    });\n    _this.eventHandler.registerHandler('query-items-resources-data', function (payload) {\n      _this.sendPurchaseableItemsData();\n    });\n    _this.eventHandler.registerHandler('query-item-resource-details', function (payload) {\n      _this.sendPurchaseableItemDetails(payload.id);\n    });\n    _this.eventHandler.registerHandler('query-general-shop-stats', function (payload) {\n      _this.sendGeneralShopStats(payload);\n    });\n    return _this;\n  }\n  _inherits(ShopModule, _GameModule);\n  return _createClass(ShopModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      (0,_shop_db__WEBPACK_IMPORTED_MODULE_2__.registerShopItemsStage1)();\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      if (!this.isUnlocked && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('coins').amount >= 2) {\n        this.isUnlocked = true;\n      }\n      this.leveledId = null;\n      if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_purchase_manager') > 0) {\n        if (!this.autoPurchaseCd) {\n          this.autoPurchaseCd = 10;\n        }\n        this.autoPurchaseCd -= delta;\n        if (this.autoPurchaseCd <= 0) {\n          this.autoPurchaseCd = 10;\n          for (var key in this.autoPurchase) {\n            if (this.autoPurchase[key]) {\n              if (!game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked(key)) {\n                this.autoPurchase[key] = false;\n                continue;\n              }\n              if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isCapped(key)) {\n                this.autoPurchase[key] = false;\n                continue;\n              }\n              var newEnt = this.purchaseItem(key);\n              console.log('Purchase Auto: ', key, newEnt);\n              if (newEnt.success) {\n                return;\n              }\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        items: this.purchasedItems,\n        isUnlocked: this.isUnlocked,\n        purchaseMultiplier: this.purchaseMultiplier,\n        autoPurchase: this.autoPurchase\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {\n      for (var key in this.purchasedItems) {\n        this.setItem(key, 0, true);\n      }\n      this.purchasedItems = {};\n      if (saveObject !== null && saveObject !== void 0 && saveObject.items) {\n        for (var id in saveObject.items) {\n          this.setItem(id, saveObject.items[id], true);\n        }\n      }\n      this.isUnlocked = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.isUnlocked) || false;\n      this.purchaseMultiplier = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.purchaseMultiplier) || 1;\n      this.autoPurchase = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.autoPurchase) || {};\n      this.sendItemsData();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.load({});\n    }\n  }, {\n    key: \"setItem\",\n    value: function setItem(itemId, amount) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(itemId, amount, bForce);\n      this.purchasedItems[itemId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(itemId);\n    }\n  }, {\n    key: \"setPurchaseMultiplier\",\n    value: function setPurchaseMultiplier(amount) {\n      this.purchaseMultiplier = Math.max(1, amount);\n      console.log('Set to: ', this.purchaseMultiplier);\n      this.sendPurchaseableItemsData();\n    }\n  }, {\n    key: \"purchaseItem\",\n    value: function purchaseItem(itemId) {\n      var newEnt = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.levelUpEntity(itemId);\n      console.log('Purchase: ', itemId, newEnt);\n      if (newEnt.success) {\n        this.purchasedItems[itemId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(itemId);\n        this.leveledId = itemId;\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').generateNotifications();\n        this.sendItemsData();\n      }\n      return newEnt.success;\n    }\n  }, {\n    key: \"purchaseResource\",\n    value: function purchaseResource(itemId) {\n      var amount = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var res = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(itemId);\n      var cost = res.get_cost();\n      var aff = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceCalculators.isAffordable(cost);\n      console.log('Affb: ', aff);\n      amount = Math.min(amount, aff.max);\n      if (aff.isAffordable) {\n        for (var key in cost) {\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(key, -cost[key] * amount);\n        }\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(itemId, amount);\n        this.leveledId = itemId;\n        this.sendPurchaseableItemsData();\n      }\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      // NOW - check for actions if they have any new notifications\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['shop']);\n      entities.forEach(function (entity) {\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('shop', 'upgrades', \"shop_\".concat(entity.id), entity.isUnlocked && !entity.isCapped);\n      });\n      var items = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.listResourcesByTags(['inventory']);\n      var presentItems = items.filter(function (item) {\n        return item.isUnlocked && item.get_cost;\n      });\n      presentItems.forEach(function (entity) {\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('shop', 'inventory', \"shop_\".concat(entity.id), entity.isUnlocked);\n      });\n    }\n  }, {\n    key: \"sendGeneralShopStats\",\n    value: function sendGeneralShopStats(payload) {\n      var stats = [];\n      stats.push(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffect('prices_discount'));\n      stats.push({\n        name: 'Charisma Price Discount',\n        value: (0,_shop_db__WEBPACK_IMPORTED_MODULE_2__.charismaMod)(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma'))\n      });\n      stats.push(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffect('shop_max_stock'));\n      stats.push(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffect('shop_stock_renew_rate'));\n      this.eventHandler.sendData('general-shop-stats', {\n        stats: stats\n      });\n    }\n  }, {\n    key: \"getItemsData\",\n    value: function getItemsData() {\n      var _this2 = this;\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['shop']);\n      return {\n        available: entities.filter(function (one) {\n          return one.isUnlocked && !one.isCapped;\n        }).map(function (entity) {\n          var _this2$autoPurchase$e;\n          return {\n            id: entity.id,\n            name: entity.name,\n            description: entity.description,\n            max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n            level: _this2.purchasedItems[entity.id] || 0,\n            affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n            potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n            isLeveled: _this2.leveledId === entity.id,\n            isAutoPurchase: (_this2$autoPurchase$e = _this2.autoPurchase[entity.id]) !== null && _this2$autoPurchase$e !== void 0 ? _this2$autoPurchase$e : false\n          };\n        }),\n        purchaseMultiplier: this.purchaseMultiplier,\n        isAutomationUnlocked: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_purchase_manager') > 0\n      };\n    }\n  }, {\n    key: \"sendItemsData\",\n    value: function sendItemsData() {\n      var data = this.getItemsData();\n      this.eventHandler.sendData('items-data', data);\n    }\n  }, {\n    key: \"getItemDetails\",\n    value: function getItemDetails(id) {\n      if (!id) return null;\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(id);\n      return {\n        id: entity.id,\n        name: entity.name,\n        description: entity.description,\n        max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n        level: this.purchasedItems[entity.id] || 0,\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n        potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n        currentEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id),\n        tags: entity.tags,\n        purchaseMultiplier: 1\n      };\n    }\n  }, {\n    key: \"sendItemDetails\",\n    value: function sendItemDetails(id) {\n      var data = this.getItemDetails(id);\n      this.eventHandler.sendData('item-details', data);\n    }\n  }, {\n    key: \"getPurchaseableItemsData\",\n    value: function getPurchaseableItemsData() {\n      var _this3 = this;\n      var items = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.listResourcesByTags(['inventory']);\n      // console.log('items: ', items);\n      var presentItems = items.filter(function (item) {\n        return item.isUnlocked && item.get_cost;\n      });\n      return {\n        available: presentItems.map(function (resource) {\n          var affordable = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceCalculators.isAffordable(resource.get_cost());\n          return _objectSpread(_objectSpread({}, resource), {}, {\n            affordable: affordable,\n            isLeveled: _this3.leveledId === resource.id,\n            purchaseMultiplier: Math.max(1, Math.min(_this3.purchaseMultiplier, affordable.max))\n          });\n        }),\n        purchaseMultiplier: this.purchaseMultiplier\n      };\n    }\n  }, {\n    key: \"sendPurchaseableItemsData\",\n    value: function sendPurchaseableItemsData() {\n      var data = this.getPurchaseableItemsData();\n      this.eventHandler.sendData('items-resources-data', data);\n    }\n  }, {\n    key: \"getPurchaseableItemDetails\",\n    value: function getPurchaseableItemDetails(id) {\n      if (!id) return null;\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(id);\n      var affordable = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceCalculators.isAffordable(entity.get_cost());\n      var potPurchase = Math.max(1, Math.min(this.purchaseMultiplier, affordable.max));\n      return {\n        id: entity.id,\n        name: entity.name,\n        description: entity.description,\n        max: entity.max,\n        level: this.purchasedItems[entity.id] || 0,\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceCalculators.isAffordable(entity.get_cost(potPurchase)),\n        potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(entity.usageGain || {}, 1),\n        tags: entity.tags,\n        purchaseMultiplier: potPurchase\n      };\n    }\n  }, {\n    key: \"sendPurchaseableItemDetails\",\n    value: function sendPurchaseableItemDetails(id) {\n      var data = this.getPurchaseableItemDetails(id);\n      this.eventHandler.sendData('item-details', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_1__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/items/shop.module.js?");

/***/ }),

/***/ "./src/worker/modules/mage/mage.module.js":
/*!************************************************!*\
  !*** ./src/worker/modules/mage/mage.module.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MageModule: () => (/* binding */ MageModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _skills_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./skills-db */ \"./src/worker/modules/mage/skills-db.js\");\n/* harmony import */ var _permanent_bonuses_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./permanent-bonuses-db */ \"./src/worker/modules/mage/permanent-bonuses-db.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar MageModule = /*#__PURE__*/function (_GameModule) {\n  function MageModule() {\n    var _this;\n    _classCallCheck(this, MageModule);\n    _this = _callSuper(this, MageModule);\n    _this.mageLevel = 0;\n    _this.mageExp = 0;\n    _this.skillUpgrades = {};\n    _this.bankedTime = {\n      current: 0,\n      max: 3600 * 24 * 1000,\n      speedUpFactor: 1\n    };\n    /*\n    this.eventHandler.registerHandler('feed-dragon', (data) => {\n        this.feedDragon();\n     })\n    this.eventHandler.registerHandler('hunt', (data) => {\n        const rs = gameResources.getResource('meat');\n        gameResources.addResource('meat', 1*rs.multiplier);\n    })\n     */\n    _this.eventHandler.registerHandler('query-mage-data', function () {\n      var data = _this.getMageData();\n      _this.eventHandler.sendData('mage-data', data);\n    });\n    _this.eventHandler.registerHandler('query-skills-data', function () {\n      var data = _this.getSkillsData();\n      _this.eventHandler.sendData('skills-data', data);\n    });\n    _this.eventHandler.registerHandler('purchase-skill', function (_ref) {\n      var id = _ref.id;\n      _this.purchaseItem(id);\n    });\n    _this.eventHandler.registerHandler('toggle-speedup', function () {\n      _this.bankedTime.speedUpFactor = 5 - _this.bankedTime.speedUpFactor;\n    });\n    _this.eventHandler.registerHandler('query-active-effects', function () {\n      _this.sendActiveEffectsData();\n    });\n    _this.eventHandler.registerHandler('query-statistics', function () {\n      var data = _this.getStatistics();\n      _this.eventHandler.sendData('statistics', data);\n    });\n    return _this;\n  }\n  _inherits(MageModule, _GameModule);\n  return _createClass(MageModule, [{\n    key: \"purchaseItem\",\n    value: function purchaseItem(itemId) {\n      var newEnt = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.levelUpEntity(itemId);\n      if (newEnt.success) {\n        this.skillUpgrades[itemId] = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel(itemId);\n        this.leveledId = itemId;\n        var data = this.getSkillsData();\n        this.eventHandler.sendData('skills-data', data);\n      }\n      return newEnt.success;\n    }\n  }, {\n    key: \"initialize\",\n    value: function initialize() {\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('mage-xp', {\n        name: 'XP',\n        hasCap: true,\n        tags: ['mage', 'xp'],\n        defaultCap: 0\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('skill-points', {\n        name: 'Skill Points',\n        hasCap: true,\n        tags: ['mage', 'skill'],\n        defaultCap: 0,\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.registerEffect('mageLevel', {\n        name: 'Mage Level',\n        defaultValue: 0,\n        hasCap: false\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.registerEffect('mage_levelup_requirement', {\n        name: 'Mage Levelup Requirement',\n        defaultValue: 1\n      });\n      (0,_skills_db__WEBPACK_IMPORTED_MODULE_2__.registerSkillsStage1)();\n      (0,_permanent_bonuses_db__WEBPACK_IMPORTED_MODULE_3__.registerPermanentBonuses)();\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.registerGameEntity('mage', {\n        tags: [\"mage\", \"general\"],\n        name: 'Mage',\n        level: 1,\n        resourceModifier: {\n          get_rawCap: function get_rawCap() {\n            return {\n              resources: {\n                'mage-xp': {\n                  A: 1.3,\n                  B: 200,\n                  type: 1\n                },\n                'energy': {\n                  A: 1,\n                  B: 9 + game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_strength'),\n                  type: 0\n                },\n                'health': {\n                  A: 1,\n                  B: 9 + game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_vitality'),\n                  type: 1\n                },\n                'knowledge': {\n                  A: 1,\n                  B: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_memory'),\n                  type: 0\n                },\n                mana: {\n                  A: 0,\n                  B: 0.5 * (game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_magic_capability') - 1),\n                  type: 0\n                }\n              }\n            };\n          },\n          get_income: function get_income() {\n            return {\n              resources: {\n                energy: {\n                  A: 0,\n                  B: 0.01 + 0.01 * game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_stamina'),\n                  type: 0\n                },\n                health: {\n                  A: 0,\n                  B: 0.01 * (0.5 + game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_recovery')),\n                  type: 0\n                },\n                mana: {\n                  A: 0,\n                  B: 0.01 * (5 + game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_magic_ability')),\n                  type: 0\n                },\n                'skill-points': {\n                  A: 1,\n                  B: -1,\n                  type: 0\n                }\n              }\n            };\n          },\n          get_multiplier: function get_multiplier() {\n            return {\n              resources: {\n                coins: {\n                  A: 0,\n                  B: 0.99 + 0.01 * game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffectValue('attribute_bargaining'),\n                  type: 0\n                }\n              }\n            };\n          },\n          effectDeps: ['workersEfficiencyPerDragonLevel', 'mage_levelup_requirement', 'attribute_stamina', 'attribute_strength', 'attribute_vitality', 'attribute_recovery', 'attribute_memory', 'attribute_magic_ability', 'attribute_magic_capability', 'attribute_bargaining']\n        },\n        get_cost: function get_cost() {\n          return {\n            'mage-xp': {\n              A: 1.3,\n              B: 200,\n              type: 1\n            }\n          };\n        }\n      });\n    }\n  }, {\n    key: \"topValues\",\n    value: function topValues(data) {\n      return (data || []).sort(function (a, b) {\n        return b.value - a.value;\n      }).slice(0, 10);\n    }\n  }, {\n    key: \"getStatistics\",\n    value: function getStatistics() {\n      var result = {};\n      result.totalTimePlayed = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.globalTime;\n      result.mageLevel = this.mageLevel;\n      result.actionsUnlocked = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.listEntitiesByTags(['action']).filter(function (one) {\n        return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(one.id);\n      }).length;\n      result.actionTimes = this.topValues(Object.entries(game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').actions).map(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n          id = _ref3[0],\n          action = _ref3[1];\n        return {\n          name: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEntity(id).name,\n          value: action.timeInvested\n        };\n      }));\n      result.actionXP = this.topValues(Object.entries(game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').actions).map(function (_ref4) {\n        var _ref5 = _slicedToArray(_ref4, 2),\n          id = _ref5[0],\n          action = _ref5[1];\n        return {\n          name: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEntity(id).name,\n          value: action.xpEarned\n        };\n      }));\n      result.spellsCasted = this.topValues(Object.entries(game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('magic').spells).map(function (_ref6) {\n        var _ref7 = _slicedToArray(_ref6, 2),\n          id = _ref7[0],\n          spell = _ref7[1];\n        return {\n          name: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEntity(id).name,\n          value: spell.numCasted\n        };\n      }));\n      console.log('RS: ', result);\n      return result;\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, dT) {\n      var _this$bankedTime;\n      this.leveledId = null;\n      this.isLeveledUp = false;\n      var rs = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('mage-xp');\n      if (rs.amount >= rs.cap) {\n        var rslt = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.levelUpEntity('mage');\n        console.log('levelUp: ', rslt);\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.addResource('skill-points', 1);\n        this.isLeveledUp = true;\n        var data = this.getMageData();\n        this.eventHandler.sendData('mage-data', data);\n      }\n\n      // console.log('B_TICK: ', this.bankedTime)\n      if (!this.bankedTime.current) {\n        this.bankedTime.current = 0;\n      }\n      if (((_this$bankedTime = this.bankedTime) === null || _this$bankedTime === void 0 ? void 0 : _this$bankedTime.speedUpFactor) > 1) {\n        var _this$bankedTime2, _this$bankedTime3;\n        this.bankedTime.current -= dT * (((_this$bankedTime2 = this.bankedTime) === null || _this$bankedTime2 === void 0 ? void 0 : _this$bankedTime2.speedUpFactor) - 1) * 1000;\n        if (((_this$bankedTime3 = this.bankedTime) === null || _this$bankedTime3 === void 0 ? void 0 : _this$bankedTime3.current) <= 0) {\n          this.bankedTime.current = 0;\n          this.bankedTime.speedUpFactor = 1;\n        }\n      }\n      // console.log('A_TICK: ', this.bankedTime);\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        mageLevel: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('mage'),\n        skillUpgrades: this.skillUpgrades,\n        permanentBonuses: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.listEntitiesByTags(['bonus', 'permanent']).map(function (one) {\n          return {\n            id: one.id,\n            level: one.level\n          };\n        }),\n        bankedTime: _objectSpread(_objectSpread({}, this.bankedTime), {}, {\n          lastSave: Date.now()\n        })\n      };\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.load({});\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      this.mageLevel = (obj === null || obj === void 0 ? void 0 : obj.mageLevel) || 1;\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setEntityLevel('mage', this.mageLevel);\n      for (var key in this.skillUpgrades) {\n        this.setSkill(key, 0, true);\n      }\n      this.skillUpgrades = {};\n      if (obj !== null && obj !== void 0 && obj.skillUpgrades) {\n        for (var id in obj.skillUpgrades) {\n          this.setSkill(id, obj.skillUpgrades[id], true);\n        }\n      }\n      var permanent = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.listEntitiesByTags(['bonus', 'permanent']).map(function (one) {\n        return {\n          id: one.id,\n          level: one.level\n        };\n      });\n      permanent.forEach(function (one) {\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setEntityLevel(one.id, 0, true);\n      });\n      if (obj !== null && obj !== void 0 && obj.permanentBonuses) {\n        obj.permanentBonuses.forEach(function (_ref8) {\n          var id = _ref8.id,\n            level = _ref8.level;\n          game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setEntityLevel(id, level, true);\n        });\n      }\n      this.bankedTime = {\n        current: 0,\n        max: 3600 * 24 * 1000,\n        speedUpFactor: 1\n      };\n      if (obj !== null && obj !== void 0 && obj.bankedTime) {\n        this.bankedTime = obj === null || obj === void 0 ? void 0 : obj.bankedTime;\n        if (this.bankedTime.max < 3600 * 24 * 1000) {\n          this.bankedTime.max = 3600 * 24 * 1000;\n        }\n        if (Date.now() > this.bankedTime.lastSave + 60000) {\n          var delta = Date.now() - (this.bankedTime.lastSave + 60000);\n          this.bankedTime.current = Math.min(this.bankedTime.max, this.bankedTime.current + delta);\n        }\n        console.log('loadedBankedTime: ', this.bankedTime, Date.now(), Date.now() - (this.bankedTime.lastSave + 60000));\n      }\n    }\n  }, {\n    key: \"setSkill\",\n    value: function setSkill(skillId, amount) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.setEntityLevel(skillId, amount, bForce);\n      this.skillUpgrades[skillId] = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel(skillId);\n    }\n  }, {\n    key: \"resetPerks\",\n    value: function resetPerks() {\n      console.log('resetPerks');\n      for (var id in this.skillUpgrades) {\n        this.setSkill(id, 0, true);\n      }\n    }\n  }, {\n    key: \"getMageData\",\n    value: function getMageData() {\n      var rs = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('mage-xp');\n      var skills = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('skill-points');\n      return {\n        mageLevel: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('mage'),\n        mageXP: rs.amount,\n        mageMaxXP: rs.cap,\n        skillPoints: skills.amount,\n        timeSpent: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.globalTime,\n        isLeveledUp: this.isLeveledUp,\n        bankedTime: this.bankedTime\n      };\n    }\n  }, {\n    key: \"getSkillsData\",\n    value: function getSkillsData() {\n      var _this2 = this;\n      var skills = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.listEntitiesByTags(['skill']);\n      var skillsRs = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('skill-points');\n      return {\n        available: skills.filter(function (one) {\n          return one.isUnlocked && !one.isCapped;\n        }).map(function (entity) {\n          return {\n            id: entity.id,\n            name: entity.name,\n            description: entity.description,\n            max: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEntityMaxLevel(entity.id) || 0,\n            level: _this2.skillUpgrades[entity.id] || 0,\n            affordable: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getAffordable(entity.id),\n            effects: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEffects(entity.id, 1),\n            currentEffects: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEffects(entity.id, 0),\n            isLeveled: _this2.leveledId === entity.id\n          };\n        }),\n        sp: {\n          total: skillsRs.amount,\n          max: skillsRs.income\n        }\n      };\n    }\n  }, {\n    key: \"getActiveEffectsData\",\n    value: function getActiveEffectsData() {\n      var items = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.listEntitiesByTags(['active_effect']);\n      // const presentSpells = items.filter(item => item.isUnlocked);\n\n      return {\n        list: items.map(function (item) {\n          var _item$originalId;\n          return _objectSpread(_objectSpread({}, item), {}, {\n            originalId: (_item$originalId = item.originalId) !== null && _item$originalId !== void 0 ? _item$originalId : item.copyFromId,\n            effects: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEffects(item.id, item.level, 0, false, 1, item.modifier.efficiency),\n            duration: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getAttribute(item.id, 'current_duration'),\n            durationProg: 1\n          });\n        })\n      };\n    }\n  }, {\n    key: \"sendActiveEffectsData\",\n    value: function sendActiveEffectsData() {\n      var activeEffectsData = this.getActiveEffectsData();\n      this.eventHandler.sendData('active-effects', activeEffectsData);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/mage/mage.module.js?");

/***/ }),

/***/ "./src/worker/modules/mage/permanent-bonuses-db.js":
/*!*********************************************************!*\
  !*** ./src/worker/modules/mage/permanent-bonuses-db.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerPermanentBonuses: () => (/* binding */ registerPermanentBonuses)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerPermanentBonuses = function registerPermanentBonuses() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_titanleaf_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Titan Leaf',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_strength': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_heartroot_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Heartroot',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_vitality': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_energloom_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Energloom',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_stamina': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_lifebloom_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Lifebloom',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_recovery': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_stillfern_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Stillfern',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_patience': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_mindroot_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Mindroot',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_memory': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_azureblossom_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Azureblossom',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_magic_ability': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_ironvine_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Ironvine',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'physical_training_learn_speed': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_mindspire_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Mindspire',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'mental_training_learning_rate': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('rare_verdant_coil_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Verdant Coil',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbs_handbook_3') > 0;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'routine_learning_speed': {\n            A: 0.0005,\n            B: 100,\n            C: 1,\n            type: 4\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('random_events_strength_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Random Events Bonus',\n    level: 0,\n    unlockCondition: function unlockCondition() {},\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_strength': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('random_events_stamina_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Random Events Bonus',\n    level: 0,\n    unlockCondition: function unlockCondition() {},\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_stamina': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('random_events_recovery_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Random Events Bonus',\n    level: 0,\n    unlockCondition: function unlockCondition() {},\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_recovery': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('random_events_charisma_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Random Events Bonus',\n    level: 0,\n    unlockCondition: function unlockCondition() {},\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_charisma': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('random_events_memory_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Random Events Bonus',\n    level: 0,\n    unlockCondition: function unlockCondition() {},\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_memory': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('random_events_magic_ability_effect', {\n    tags: [\"bonus\", \"permanent\", \"herbal\"],\n    name: 'Random Events Bonus',\n    level: 0,\n    unlockCondition: function unlockCondition() {},\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      income: {\n        effects: {\n          'attribute_magic_ability': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/mage/permanent-bonuses-db.js?");

/***/ }),

/***/ "./src/worker/modules/mage/skills-db.js":
/*!**********************************************!*\
  !*** ./src/worker/modules/mage/skills-db.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerSkillsStage1: () => (/* binding */ registerSkillsStage1)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerSkillsStage1 = function registerSkillsStage1() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_scholar', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Scholar',\n    description: 'Increase your learning ability',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'learning_rate': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_energizer', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Energizer',\n    description: 'Increase your stamina',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'attribute_stamina': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'energy': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_treasurer', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Treasurer',\n    description: 'Increase your coins cap',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'coins': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'coins': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_oak_heart', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Oak Heart',\n    description: 'Increase your HP regen',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      // console.log('ACTLVL: ', )\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'health': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'health': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_metabolism', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Metabolism',\n    description: 'Decrease cooldown of consumable items usage',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      // console.log('ACTLVL: ', )\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') >= 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'metabolism_rate': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_merchant', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Merchant',\n    description: 'Increase amount of items you can sell',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      // console.log('ACTLVL: ', )\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_backpack') >= 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'shop_max_stock': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          },\n          'shop_stock_renew_rate': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_highbrow', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Highbrow',\n    description: 'Increase your knowledge capacity and regeneration',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      // console.log('ACTLVL: ', )\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') >= 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'knowledge': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'knowledge': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('skill_sorcer', {\n    tags: [\"skill\", \"upgrade\", \"purchaseable\"],\n    name: 'Sorcer',\n    description: 'Increase your mana regen and capacity',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      // console.log('ACTLVL: ', )\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') >= 1;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'mana': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'mana': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'skill-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'skill-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/mage/skills-db.js?");

/***/ }),

/***/ "./src/worker/modules/magic/spells-db.js":
/*!***********************************************!*\
  !*** ./src/worker/modules/magic/spells-db.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCostReduction: () => (/* binding */ getCostReduction),\n/* harmony export */   getMasteryId: () => (/* binding */ getMasteryId),\n/* harmony export */   getMaxId: () => (/* binding */ getMaxId),\n/* harmony export */   initSpellsDB1: () => (/* binding */ initSpellsDB1),\n/* harmony export */   registerSpell: () => (/* binding */ registerSpell)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n\nvar getMasteryId = function getMasteryId(id) {\n  return \"\".concat(id, \"_mastery\");\n};\nvar getMaxId = function getMaxId(id) {\n  return \"\".concat(id, \"_max\");\n};\nvar getCostReduction = function getCostReduction(id) {\n  var effId = getMasteryId(id);\n  /*if(!gameEffects.effects[id]) {\n      gameEffects.registerEffect(effId, {\n          name: `Cost reduction`,\n          defaultValue: 1,\n      })\n  }*/\n  var effect = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue(effId);\n  return effect;\n};\nvar registerSpell = function registerSpell(id, options) {\n  var cost_reduction_effect_id = getMasteryId(id);\n  var max_level_id = getMaxId(id);\n\n  // register effect\n  if (!game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.effects[id]) {\n    game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect(cost_reduction_effect_id, {\n      name: \"\".concat(options.name, \" cost\"),\n      defaultValue: 1.,\n      minValue: 0\n    });\n  }\n\n  //register cap\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(max_level_id, {\n    name: \"\".concat(options.name, \" cap\"),\n    tags: ['spell_cap'],\n    isUnlocked: options.isUnlocked,\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    resourceModifier: {\n      multiplier: {\n        effects: _defineProperty({}, cost_reduction_effect_id, {\n          A: 0.975,\n          B: 1,\n          type: 1\n        })\n      }\n    }\n  });\n\n  //register spell itself\n  if (options.resourceModifier) {\n    options.resourceModifier.effectDeps = [].concat(_toConsumableArray(options.resourceModifier.effectDeps || []), [getMasteryId(id)]);\n  }\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(id, _objectSpread({}, options));\n};\nvar initSpellsDB1 = function initSpellsDB1() {\n  registerSpell('spell_magic_insight', {\n    name: 'Magic Insight',\n    description: 'Use your magic capabilities to understand world better',\n    hasCap: false,\n    tags: ['spell', 'magic', 'mental', 'mental_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10;\n    },\n    usageGain: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            knowledge: {\n              A: 1.2,\n              B: 5,\n              type: 1\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 3 * getCostReduction('spell_magic_insight'),\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    attributes: {\n      xpOnCast: 20\n    }\n  });\n  registerSpell('spell_focus', {\n    name: 'Focus',\n    description: 'Improve your learning capabilities using magic',\n    hasCap: false,\n    tags: ['spell', 'magic', 'mental', 'mental_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          learning_rate: {\n            A: 0.1,\n            B: 1.4,\n            type: 0\n          }\n        }\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 1 * getCostReduction('spell_focus'),\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 2 * getCostReduction('spell_focus'),\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      duration: 10,\n      xpOnCast: 20\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    }\n  });\n  registerSpell('spell_harvest_vision', {\n    name: 'Harvest Vision',\n    description: 'Temporarily enhances the caster\\'s ability to locate valuable resources on the map. A glowing aura sharpens perception, increasing the likelihood of discovery.',\n    hasCap: false,\n    tags: ['spell', 'magic', 'mental', 'mental_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'gathering_low_chance': {\n            A: 0.05,\n            B: 1.7,\n            type: 0\n          }\n        }\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 1. * getCostReduction('spell_harvest_vision'),\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 2 * getCostReduction('spell_harvest_vision'),\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      duration: 10,\n      xpOnCast: 20\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    }\n  });\n  registerSpell('spell_magic_recovery', {\n    name: 'Less Magic Recovery',\n    description: 'Heal yourself using magic',\n    hasCap: false,\n    tags: ['spell', 'magic', 'restoration', 'restoration_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10;\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 4 * getCostReduction('spell_magic_recovery'),\n              type: 1\n            }\n          }\n        };\n      },\n      get_income: function get_income() {\n        return {\n          resources: {\n            health: {\n              A: 1.2,\n              B: 10 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('restoration_spells_efficiency'),\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      xpOnCast: 20\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_less_restoration') > 0;\n    }\n  });\n  registerSpell('spell_small_regeneration', {\n    name: 'Less Magic Regeneration',\n    description: 'Enchant your body for faster recovery',\n    hasCap: false,\n    tags: ['spell', 'magic', 'restoration', 'restoration_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 10;\n    },\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            health: {\n              A: 1.2,\n              B: 1.0 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('restoration_spells_efficiency'),\n              type: 1\n            },\n            energy: {\n              A: 1.2,\n              B: 2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('restoration_spells_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 2 * getCostReduction('spell_small_regeneration'),\n              type: 1\n            }\n          }\n        };\n      },\n      effectDeps: ['restoration_spells_efficiency']\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 5 * getCostReduction('spell_small_regeneration') / 1.5,\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      duration: 10,\n      xpOnCast: 20\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_less_restoration') > 0;\n    }\n  });\n  registerSpell('spell_perfection_illusion', {\n    name: 'Perfection Illusion',\n    description: 'Use magic to create illusion that you are perfect worker. Increases coins income from jobs',\n    hasCap: false,\n    tags: ['spell', 'magic', 'mental', 'illusion_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30;\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            coins_earned_bonus: {\n              A: 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              B: 1.0 + 0.4 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 1 * getCostReduction('spell_perfection_illusion'),\n              type: 1\n            }\n          }\n        };\n      },\n      effectDeps: ['illusion_spells_efficiency']\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 4 * getCostReduction('spell_perfection_illusion'),\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      duration: 20,\n      xpOnCast: 50\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_less_illusion') > 0;\n    }\n  });\n  registerSpell('spell_dancing_fairy', {\n    name: 'Dancing Fairy',\n    description: 'Summon illusion of dancing fairy, inspiring you while performing routine actions. Improves learning rate for all routine tasks',\n    hasCap: false,\n    tags: ['spell', 'magic', 'mental', 'illusion_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30;\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            routine_learning_speed: {\n              A: 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              B: 1.0 + 0.8 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 1.0 * getCostReduction('spell_dancing_fairy') / 1.5,\n              type: 1\n            }\n          }\n        };\n      },\n      effectDeps: ['illusion_spells_efficiency']\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 5. * getCostReduction('spell_dancing_fairy') / 1.5,\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      duration: 20,\n      xpOnCast: 50\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_less_illusion') > 0;\n    }\n  });\n  registerSpell('spell_friendliness_mask', {\n    name: 'Mask of Friendliness',\n    description: 'Cast a spell on your face to appear more friendly to others',\n    hasCap: false,\n    tags: ['spell', 'magic', 'mental', 'illusion_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30;\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            social_training_learning_rate: {\n              A: 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              B: 1.0 + 0.8 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 10.0 * getCostReduction('spell_friendliness_mask') / 1.5,\n              type: 1\n            }\n          }\n        };\n      },\n      effectDeps: ['illusion_spells_efficiency']\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 25. * getCostReduction('spell_friendliness_mask') / 1.5,\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      duration: 20,\n      xpOnCast: 50\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_minor_illusion') > 0;\n    }\n  });\n  registerSpell('spell_illusory_hammer', {\n    name: 'Illusory Hammer',\n    description: 'Create an duplicated hammer. Of course, its just an imagination, but still it chops wood nice.',\n    hasCap: false,\n    tags: ['spell', 'magic', 'mental', 'illusion_magic'],\n    defaultCap: 0,\n    isAbstract: true,\n    level: 1,\n    onUse: function onUse(amount) {},\n    getUsageCooldown: function getUsageCooldown() {\n      return 30;\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            crafting_efficiency: {\n              A: 0.05 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              B: 1.0 + 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('illusion_spells_efficiency'),\n              type: 0\n            }\n          }\n        };\n      },\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 25.0 * getCostReduction('spell_illusory_hammer') / 1.5,\n              type: 1\n            }\n          }\n        };\n      },\n      effectDeps: ['illusion_spells_efficiency']\n    },\n    usageGain: {\n      get_consumption: function get_consumption() {\n        return {\n          resources: {\n            mana: {\n              A: 1.5,\n              B: 80. * getCostReduction('spell_illusory_hammer') / 1.5,\n              type: 1\n            }\n          }\n        };\n      }\n    },\n    attributes: {\n      duration: 20,\n      xpOnCast: 50\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_minor_illusion') > 0;\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/magic/spells-db.js?");

/***/ }),

/***/ "./src/worker/modules/magic/spells.module.js":
/*!***************************************************!*\
  !*** ./src/worker/modules/magic/spells.module.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SpellModule: () => (/* binding */ SpellModule)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _spells_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./spells-db */ \"./src/worker/modules/magic/spells-db.js\");\n/* harmony import */ var _shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/utils/rule-utils */ \"./src/worker/shared/utils/rule-utils.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar SpellModule = /*#__PURE__*/function (_GameModule) {\n  function SpellModule() {\n    var _this;\n    _classCallCheck(this, SpellModule);\n    _this = _callSuper(this, SpellModule);\n    _this.spells = {};\n    _this.isUnlocked = false;\n    _this.autoConsumeCD = 2;\n    _this.eventHandler.registerHandler('use-spell', function (payload) {\n      _this.useSpell(payload.id, payload.amount);\n    });\n    _this.eventHandler.registerHandler('query-spell-data', function (payload) {\n      _this.sendSpellData(payload);\n    });\n    _this.eventHandler.registerHandler('query-spell-details', function (payload) {\n      _this.sendSpellDetails(payload.id);\n    });\n    _this.eventHandler.registerHandler('save-spell-settings', function (payload) {\n      _this.saveSettings(payload);\n    });\n    _this.eventHandler.registerHandler('get-spell-level-effects', function (payload) {\n      var effects = _this.querySpellEffects(payload.id, payload.level);\n      _this.eventHandler.sendData('spell-level-effects', effects);\n    });\n    return _this;\n  }\n  _inherits(SpellModule, _GameModule);\n  return _createClass(SpellModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('restoration_spells_efficiency', {\n        name: 'Restoration Magic Efficiency',\n        defaultValue: 1,\n        minValue: 1\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('illusion_spells_efficiency', {\n        name: 'Illusion Magic Efficiency',\n        defaultValue: 1,\n        minValue: 1\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('spell_xp_rate', {\n        name: 'Spell XP Gain',\n        defaultValue: 1,\n        minValue: 1\n      });\n      (0,_spells_db__WEBPACK_IMPORTED_MODULE_2__.initSpellsDB1)();\n    }\n  }, {\n    key: \"isSpellLevelingAvailable\",\n    value: function isSpellLevelingAvailable() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellcraft') > 0;\n    }\n  }, {\n    key: \"getMaxXP\",\n    value: function getMaxXP(id, level) {\n      if (!level) {\n        var _this$spells$id;\n        level = ((_this$spells$id = this.spells[id]) === null || _this$spells$id === void 0 ? void 0 : _this$spells$id.level) || 1;\n      }\n      return 100 * Math.pow(3, level);\n    }\n  }, {\n    key: \"getXPPerCast\",\n    value: function getXPPerCast(id, level) {\n      if (!level) {\n        var _this$spells$id2;\n        level = ((_this$spells$id2 = this.spells[id]) === null || _this$spells$id2 === void 0 ? void 0 : _this$spells$id2.actualLevel) || 1;\n      }\n      var sp = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAttribute(id, 'xpOnCast', 0);\n      return sp * Math.pow(1.4, level) * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('spell_xp_rate') * Math.pow(1.025, game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_spell_reading'));\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      this.autoConsumeCD -= delta;\n\n      // trigger autocast\n      for (var itemId in this.spells) {\n        var _this$spells$itemId, _this$spells$itemId2, _this$spells$itemId3, _this$spells$itemId4;\n        this.spells[itemId].isCasted = false;\n        if (this.spells[itemId].duration > 0) {\n          // console.log('SPELL: ', itemId, this.spells[itemId].duration);\n          this.spells[itemId].duration -= delta;\n          if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.entityExists(\"active_\".concat(itemId))) {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setAttribute(\"active_\".concat(itemId), 'current_duration', this.spells[itemId].duration);\n          }\n        }\n        if (this.spells[itemId].duration <= 0 && this.spells[itemId].isRunning) {\n          var _gameEntity$getEntity;\n          this.spells[itemId].duration = 0;\n          this.spells[itemId].isRunning = false;\n          this.spells[itemId].cooldown = (_gameEntity$getEntity = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(itemId).getUsageCooldown()) !== null && _gameEntity$getEntity !== void 0 ? _gameEntity$getEntity : 0;\n          console.log('Set cooldown of ' + itemId, this.spells[itemId].cooldown);\n          if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.entityExists(\"active_\".concat(itemId))) {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.unsetEntity(\"active_\".concat(itemId));\n          }\n        }\n        if (this.spells[itemId].cooldown > 0) {\n          this.spells[itemId].cooldown -= delta;\n        }\n        if (this.autoConsumeCD > 0) {\n          continue;\n        }\n        if (!((_this$spells$itemId = this.spells[itemId]) !== null && _this$spells$itemId !== void 0 && (_this$spells$itemId = _this$spells$itemId.autocast) !== null && _this$spells$itemId !== void 0 && (_this$spells$itemId = _this$spells$itemId.rules) !== null && _this$spells$itemId !== void 0 && _this$spells$itemId.length)) {\n          continue;\n        }\n\n        // check if matching rules\n        var isMatching = (0,_shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_3__.checkMatchingRules)((_this$spells$itemId2 = this.spells[itemId]) === null || _this$spells$itemId2 === void 0 || (_this$spells$itemId2 = _this$spells$itemId2.autocast) === null || _this$spells$itemId2 === void 0 ? void 0 : _this$spells$itemId2.rules, (_this$spells$itemId3 = this.spells[itemId]) === null || _this$spells$itemId3 === void 0 || (_this$spells$itemId3 = _this$spells$itemId3.autocast) === null || _this$spells$itemId3 === void 0 ? void 0 : _this$spells$itemId3.pattern);\n\n        // console.log('RULES MATCHED: ', isMatching);\n        if (isMatching && (((_this$spells$itemId4 = this.spells[itemId]) === null || _this$spells$itemId4 === void 0 ? void 0 : _this$spells$itemId4.cooldown) || 0) <= 0) {\n          this.useSpell(itemId, 1);\n        }\n      }\n      if (this.autoConsumeCD <= 0) {\n        this.autoConsumeCD = 2;\n      }\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        spells: this.spells\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {\n      for (var key in this.purchasedItems) {\n        this.setSpell(key, 0, true);\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel((0,_spells_db__WEBPACK_IMPORTED_MODULE_2__.getMaxId)(id), 0, true);\n      }\n      this.spells = {};\n      if (saveObject !== null && saveObject !== void 0 && saveObject.spells) {\n        for (var _id in saveObject.spells) {\n          this.spells[_id] = saveObject.spells[_id];\n          if (!this.spells[_id].level) {\n            this.spells[_id].level = 1;\n          }\n          if (!this.spells[_id].actualLevel) {\n            this.spells[_id].actualLevel = 1;\n            this.spells[_id].xp = 0;\n          }\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel((0,_spells_db__WEBPACK_IMPORTED_MODULE_2__.getMaxId)(_id), this.spells[_id].level - 1, true);\n          this.setSpell(_id, saveObject.spells[_id].actualLevel || 1, true);\n          this.spells[_id].duration = saveObject.spells[_id].duration;\n          if (this.spells[_id].duration && this.spells[_id].duration > 0) {\n            this.spells[_id].isRunning = true;\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(\"active_\".concat(_id), {\n              copyFromId: _id,\n              isAbstract: false,\n              tags: ['active_spell', 'active_effect'],\n              scope: 'spells',\n              level: saveObject.spells[_id].actualLevel\n            });\n          }\n        }\n      }\n      this.isUnlocked = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.isUnlocked) || false;\n      this.sendSpellData();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.load({});\n    }\n  }, {\n    key: \"setSpell\",\n    value: function setSpell(spellId, amount) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      if (amount < 1) amount = 1;\n      if (amount > this.spells[spellId].level) {\n        amount = this.spells[spellId].level;\n      }\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(spellId, amount, bForce);\n      this.spells[spellId].actualLevel = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(spellId);\n    }\n  }, {\n    key: \"getConsumeAffordable\",\n    value: function getConsumeAffordable(entity, level) {\n      var result = {\n        isAffordable: true,\n        consume: {}\n      };\n      if (!level) {\n        level = entity.level;\n      }\n      if (entity.usageGain) {\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(entity.usageGain, level);\n        if (effects.length) {\n          var rsToRemove = effects.filter(function (eff) {\n            return eff.scope === 'consumption' && eff.type === 'resources';\n          });\n          rsToRemove.forEach(function (rs) {\n            result.consume[rs.id] = rs.value; // *this.getSpellMaxLvlDiscount(entity.id);\n            if (result.consume[rs.id] > game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(rs.id).amount) {\n              result.isAffordable = false;\n            }\n          });\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"getSpellMaxLvlDiscount\",\n    value: function getSpellMaxLvlDiscount(id) {\n      var _this$spells$id3;\n      return Math.pow(0.975, ((_this$spells$id3 = this.spells[id]) === null || _this$spells$id3 === void 0 ? void 0 : _this$spells$id3.level) || 0);\n    }\n  }, {\n    key: \"useSpell\",\n    value: function useSpell(id) {\n      var _this$spells$id4, _this$spells$id5;\n      var spell = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(id);\n      if (!this.spells[id]) {\n        this.spells[id] = {\n          duration: 0,\n          cooldown: 0,\n          level: 1,\n          actualLevel: 1,\n          numCasted: 0,\n          xp: 0\n        };\n      }\n      if ((((_this$spells$id4 = this.spells[id]) === null || _this$spells$id4 === void 0 ? void 0 : _this$spells$id4.duration) || 0) > 0) {\n        return;\n      }\n      if ((((_this$spells$id5 = this.spells[id]) === null || _this$spells$id5 === void 0 ? void 0 : _this$spells$id5.cooldown) || 0) > 0) {\n        return;\n      }\n      if (spell.usageGain) {\n        var aff = this.getConsumeAffordable(spell);\n        if (!aff.isAffordable) {\n          return;\n        }\n      }\n      this.spells[id].isRunning = true;\n      this.spells[id].duration = 0;\n      if (this.isSpellLevelingAvailable()) {\n        var dXP = this.getXPPerCast(id);\n        this.spells[id].xp += dXP;\n        if (this.spells[id].xp >= this.getMaxXP(id)) {\n          this.spells[id].xp = 0;\n          // level-up spell\n          this.spells[id].level++;\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel((0,_spells_db__WEBPACK_IMPORTED_MODULE_2__.getMaxId)(id), this.spells[id].level - 1, true);\n        }\n      }\n      if (spell.usageGain) {\n        var _aff = this.getConsumeAffordable(spell);\n        if (!_aff.isAffordable) {\n          return;\n        }\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(spell.usageGain, spell.level);\n        if (effects.length) {\n          var rsToAdd = effects.filter(function (eff) {\n            return eff.scope === 'income' && eff.type === 'resources';\n          });\n          rsToAdd.forEach(function (rs) {\n            game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(rs.id, rs.value);\n          });\n        }\n        for (var key in _aff.consume) {\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(key, -_aff.consume[key]);\n        }\n        if (game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAttribute(spell.id, 'duration')) {\n          var _spell$level;\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(\"active_\".concat(id), {\n            copyFromId: id,\n            isAbstract: false,\n            level: spell.level,\n            tags: ['active_spell', 'active_effect'],\n            scope: 'spells'\n          });\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(\"active_\".concat(id), (_spell$level = spell === null || spell === void 0 ? void 0 : spell.level) !== null && _spell$level !== void 0 ? _spell$level : 1);\n          this.spells[id].duration = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAttribute(spell.id, 'duration');\n        }\n        if (!this.spells[id]) {\n          this.spells[id] = {};\n        }\n        this.spells[id].isCasted = true;\n        this.spells[id].numCasted = (this.spells[id].numCasted || 0) + 1;\n      }\n      this.sendSpellData();\n    }\n  }, {\n    key: \"saveSettings\",\n    value: function saveSettings(payload) {\n      if (payload.id) {\n        // check if level was changed\n        if (!this.spells[payload.id]) {\n          this.spells[payload.id] = {\n            duration: 0,\n            cooldown: 0,\n            level: 1,\n            actualLevel: 1,\n            xp: 0\n          };\n        }\n        if (payload.actualLevel && payload.actualLevel !== this.spells[payload.id].actualLevel) {\n          this.setSpell(payload.id, payload.actualLevel, true);\n        }\n        this.spells[payload.id] = _objectSpread(_objectSpread({}, this.spells[payload.id] || {}), {}, {\n          autocast: payload.autocast\n        });\n      }\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['spell']);\n      entities.forEach(function (item) {\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('spellbook', 'spellbook', \"spell_\".concat(item.id), item.isUnlocked);\n      });\n    }\n  }, {\n    key: \"getSpellsData\",\n    value: function getSpellsData(payload) {\n      var _this2 = this;\n      var items = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['spell']);\n      var presentSpells = items.filter(function (item) {\n        return item.isUnlocked;\n      });\n      if (payload !== null && payload !== void 0 && payload.filterAutomated) {\n        presentSpells = presentSpells.filter(function (one) {\n          var _this2$spells$one$id;\n          return (_this2$spells$one$id = _this2.spells[one.id]) === null || _this2$spells$one$id === void 0 || (_this2$spells$one$id = _this2$spells$one$id.autocast) === null || _this2$spells$one$id === void 0 || (_this2$spells$one$id = _this2$spells$one$id.rules) === null || _this2$spells$one$id === void 0 ? void 0 : _this2$spells$one$id.length;\n        });\n      }\n      if (payload !== null && payload !== void 0 && payload.includeAutomations) {\n        presentSpells = presentSpells.map(function (spell) {\n          var _this2$spells$spell$i;\n          return _objectSpread(_objectSpread({}, spell), {}, {\n            autocast: (_this2$spells$spell$i = _this2.spells[spell.id]) === null || _this2$spells$spell$i === void 0 ? void 0 : _this2$spells$spell$i.autocast\n          });\n        });\n      }\n      return {\n        available: presentSpells.map(function (spell) {\n          var _this2$spells$spell$i2, _this2$spells$spell$i3, _this2$spells$spell$i4, _this2$spells$spell$i5, _this2$spells$spell$i6, _this2$spells$spell$i7, _this2$spells$spell$i8;\n          return _objectSpread(_objectSpread({}, spell), {}, {\n            currentDuration: (_this2$spells$spell$i2 = _this2.spells[spell.id]) === null || _this2$spells$spell$i2 === void 0 ? void 0 : _this2$spells$spell$i2.duration,\n            isActive: ((_this2$spells$spell$i3 = _this2.spells[spell.id]) === null || _this2$spells$spell$i3 === void 0 ? void 0 : _this2$spells$spell$i3.duration) > 0,\n            isCasted: (_this2$spells$spell$i4 = _this2.spells[spell.id]) === null || _this2$spells$spell$i4 === void 0 ? void 0 : _this2$spells$spell$i4.isCasted,\n            cooldown: (_this2$spells$spell$i5 = (_this2$spells$spell$i6 = _this2.spells[spell.id]) === null || _this2$spells$spell$i6 === void 0 ? void 0 : _this2$spells$spell$i6.cooldown) !== null && _this2$spells$spell$i5 !== void 0 ? _this2$spells$spell$i5 : 0,\n            cooldownProg: spell.getUsageCooldown ? (spell.getUsageCooldown() - ((_this2$spells$spell$i7 = (_this2$spells$spell$i8 = _this2.spells[spell.id]) === null || _this2$spells$spell$i8 === void 0 ? void 0 : _this2$spells$spell$i8.cooldown) !== null && _this2$spells$spell$i7 !== void 0 ? _this2$spells$spell$i7 : 0)) / spell.getUsageCooldown() : 1\n          });\n        }),\n        isSpellLevelingAvailable: this.isSpellLevelingAvailable()\n      };\n    }\n  }, {\n    key: \"sendSpellData\",\n    value: function sendSpellData(payload) {\n      var data = this.getSpellsData(payload);\n      var label = 'spell-data';\n      if (payload !== null && payload !== void 0 && payload.prefix) {\n        label = \"\".concat(label, \"-\").concat(payload.prefix);\n      }\n      this.eventHandler.sendData(label, data);\n    }\n  }, {\n    key: \"querySpellEffects\",\n    value: function querySpellEffects(id, level) {\n      var spell = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(id);\n      var effects = [];\n      if (spell.usageGain) {\n        effects = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(spell.usageGain, level);\n      }\n      return {\n        effects: effects,\n        potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(id, 0, level, true),\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceCalculators.isAffordable(this.getConsumeAffordable(spell, level).consume),\n        xpRate: this.getXPPerCast(id, level)\n      };\n    }\n  }, {\n    key: \"getSpellDetails\",\n    value: function getSpellDetails(id) {\n      var _this$spells$id6, _this$spells$id$autoc, _this$spells$id7, _this$spells$id8, _this$spells$id9, _this$spells$id10;\n      if (!id) return null;\n      var spell = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(id);\n      var effects = [];\n      if (spell.usageGain) {\n        effects = game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceApi.unpackEffects(spell.usageGain, spell.level);\n      }\n      return {\n        id: spell.id,\n        name: spell.name,\n        description: spell.description,\n        breakdown: spell.breakdown,\n        amount: spell.amount,\n        effects: effects,\n        duration: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAttribute(id, 'duration'),\n        currentDuration: (_this$spells$id6 = this.spells[id]) === null || _this$spells$id6 === void 0 ? void 0 : _this$spells$id6.duration,\n        potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(id, 0, spell.level, true),\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.resourceCalculators.isAffordable(this.getConsumeAffordable(spell).consume),\n        tags: spell.tags || [],\n        autocast: (_this$spells$id$autoc = (_this$spells$id7 = this.spells[id]) === null || _this$spells$id7 === void 0 ? void 0 : _this$spells$id7.autocast) !== null && _this$spells$id$autoc !== void 0 ? _this$spells$id$autoc : {\n          rules: []\n        },\n        isCasted: (_this$spells$id8 = this.spells[id]) === null || _this$spells$id8 === void 0 ? void 0 : _this$spells$id8.isCasted,\n        maxLevel: ((_this$spells$id9 = this.spells[id]) === null || _this$spells$id9 === void 0 ? void 0 : _this$spells$id9.level) || 1,\n        maxLevelCostReduction: (0,_spells_db__WEBPACK_IMPORTED_MODULE_2__.getCostReduction)(id),\n        maxXP: this.getMaxXP(id),\n        xp: ((_this$spells$id10 = this.spells[id]) === null || _this$spells$id10 === void 0 ? void 0 : _this$spells$id10.xp) || 0,\n        xpRate: this.getXPPerCast(id),\n        actualLevel: spell.level,\n        isSpellLevelingAvailable: this.isSpellLevelingAvailable(),\n        cooldown: spell.getUsageCooldown()\n      };\n    }\n  }, {\n    key: \"sendSpellDetails\",\n    value: function sendSpellDetails(id) {\n      var data = this.getSpellDetails(id);\n      this.eventHandler.sendData('spell-details', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_1__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/magic/spells.module.js?");

/***/ }),

/***/ "./src/worker/modules/map/map-tile-lists.submodule.js":
/*!************************************************************!*\
  !*** ./src/worker/modules/map/map-tile-lists.submodule.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MapTileListsSubmodule: () => (/* binding */ MapTileListsSubmodule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/utils/rule-utils */ \"./src/worker/shared/utils/rule-utils.js\");\n/* harmony import */ var _shared_utils_objects__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/utils/objects */ \"./src/worker/shared/utils/objects.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _createForOfIteratorHelper(r, e) { var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t[\"return\"] || t[\"return\"](); } finally { if (u) throw o; } } }; }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar MapTileListsSubmodule = /*#__PURE__*/function (_GameModule) {\n  function MapTileListsSubmodule() {\n    var _this;\n    _classCallCheck(this, MapTileListsSubmodule);\n    _this = _callSuper(this, MapTileListsSubmodule);\n    _this.mapLists = {};\n    _this.runningList = null;\n    _this.listsAutotrigger = [];\n    _this.autotriggerCD = 0;\n    _this.automationEnabled = false;\n    _this.combineLists = true;\n    _this.autotriggerIntervalSetting = 10;\n    _this.eventHandler.registerHandler('save-map-tile-list', function (payload) {\n      _this.saveMapTilesList(payload);\n    });\n    _this.eventHandler.registerHandler('delete-map-tile-list', function (_ref) {\n      var id = _ref.id;\n      _this.deleteMapTilesList(id);\n    });\n    _this.eventHandler.registerHandler('load-map-tile-list', function (_ref2) {\n      var id = _ref2.id;\n      _this.sendListData(id);\n    });\n    _this.eventHandler.registerHandler('query-map-tile-lists', function (pl) {\n      var lists = _this.getLists(pl);\n      _this.eventHandler.sendData('map-tile-lists', lists);\n    });\n    _this.eventHandler.registerHandler('run-map-tile-list', function (_ref3) {\n      var id = _ref3.id;\n      _this.runList(id);\n    });\n    _this.eventHandler.registerHandler('stop-map-tile-list', function (_ref4) {\n      var id = _ref4.id;\n      _this.stopList(id);\n    });\n    _this.eventHandler.registerHandler('set-map-automation-enabled', function (_ref5) {\n      var flag = _ref5.flag;\n      _this.automationEnabled = !!flag;\n    });\n    _this.eventHandler.registerHandler('set-map-autotrigger-interval', function (_ref6) {\n      var interval = _ref6.interval;\n      _this.autotriggerIntervalSetting = interval;\n    });\n    _this.eventHandler.registerHandler('query-map-tile-list-effects', function (_ref7) {\n      var id = _ref7.id,\n        listData = _ref7.listData;\n      var potentialDrops = _this.getListEffects(null, listData);\n      var costs = _this.getListCosts(null, listData);\n      _this.eventHandler.sendData('map-tile-list-effects', {\n        id: id,\n        potentialDrops: potentialDrops,\n        costs: costs\n      });\n    });\n    return _this;\n  }\n  _inherits(MapTileListsSubmodule, _GameModule);\n  return _createClass(MapTileListsSubmodule, [{\n    key: \"runList\",\n    value: function runList(id) {\n      if (!id) {\n        this.stopList();\n        return;\n      }\n      this.runningList = {\n        id: id,\n        name: this.mapLists[id].name,\n        actionIndex: 0,\n        actionTimer: 0\n      };\n      this.runCombinedList(id);\n    }\n  }, {\n    key: \"stopList\",\n    value: function stopList() {\n      this.runningList = null;\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('map').stopRunningTiles();\n    }\n  }, {\n    key: \"saveMapTilesList\",\n    value: function saveMapTilesList(payload) {\n      var _this$runningList, _this$runningList2;\n      var isNew = !payload.id;\n      var list = _objectSpread({}, payload);\n      delete list['isReopenEdit'];\n      var isReopenEdit = payload.isReopenEdit;\n      if (!list.id) {\n        list.id = \"\".concat(Math.random() * 1000000);\n      }\n      if (list.autotriggerCD && !list.autotrigger.priority) {\n        list.autotrigger.priority = 0;\n      }\n      this.mapLists[list.id] = list;\n      this.mapLists[list.id].tiles = (this.mapLists[list.id].tiles || []).filter(function (one) {\n        return one.time > 0;\n      });\n      console.log('Saved List: ', list, payload);\n      if (isReopenEdit) {\n        this.sendListData(list.id, true);\n      }\n      this.regenerateListsPriorityMap();\n      if ((_this$runningList = this.runningList) !== null && _this$runningList !== void 0 && _this$runningList.id && ((_this$runningList2 = this.runningList) === null || _this$runningList2 === void 0 ? void 0 : _this$runningList2.id) === payload.id) {\n        var listToRun = this.mapLists[this.runningList.id];\n        this.runList(this.runningList.id);\n      }\n    }\n  }, {\n    key: \"deleteMapTilesList\",\n    value: function deleteMapTilesList(id) {\n      delete this.mapLists[id];\n      this.regenerateListsPriorityMap();\n    }\n  }, {\n    key: \"regenerateListsPriorityMap\",\n    value: function regenerateListsPriorityMap() {\n      var listsBeingAutotrigger = Object.values(this.mapLists).filter(function (one) {\n        var _one$autotrigger;\n        return !!((_one$autotrigger = one.autotrigger) !== null && _one$autotrigger !== void 0 && (_one$autotrigger = _one$autotrigger.rules) !== null && _one$autotrigger !== void 0 && _one$autotrigger.length);\n      });\n      this.listsAutotrigger = listsBeingAutotrigger.map(function (one) {\n        var _one$autotrigger$prio;\n        return {\n          id: one.id,\n          priority: (_one$autotrigger$prio = one.autotrigger.priority) !== null && _one$autotrigger$prio !== void 0 ? _one$autotrigger$prio : 0\n        };\n      }).sort(function (a, b) {\n        return a.priority - b.priority;\n      });\n    }\n  }, {\n    key: \"getLists\",\n    value: function getLists(pl) {\n      var _this$runningList3;\n      var ls = Object.values(this.mapLists);\n      if (pl !== null && pl !== void 0 && pl.filterAutomated) {\n        ls = ls.filter(function (one) {\n          var _one$autotrigger2;\n          return (_one$autotrigger2 = one.autotrigger) === null || _one$autotrigger2 === void 0 || (_one$autotrigger2 = _one$autotrigger2.rules) === null || _one$autotrigger2 === void 0 ? void 0 : _one$autotrigger2.length;\n        });\n      }\n      return {\n        lists: ls,\n        runningList: (_this$runningList3 = this.runningList) !== null && _this$runningList3 !== void 0 && _this$runningList3.id ? this.mapLists[this.runningList.id] : null,\n        automationEnabled: this.automationEnabled,\n        autotriggerIntervalSetting: this.autotriggerIntervalSetting\n      };\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        list: (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_3__.mapObject)(this.mapLists, function (one) {\n          return {\n            id: one.id,\n            name: one.name,\n            tiles: one.tiles,\n            autotrigger: one.autotrigger\n          };\n        }),\n        runningList: this.runningList,\n        automationEnabled: this.automationEnabled,\n        autotriggerIntervalSetting: this.autotriggerIntervalSetting\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      var _obj$list, _obj$runningList;\n      this.mapLists = (_obj$list = obj === null || obj === void 0 ? void 0 : obj.list) !== null && _obj$list !== void 0 ? _obj$list : [];\n      this.runningList = (_obj$runningList = obj === null || obj === void 0 ? void 0 : obj.runningList) !== null && _obj$runningList !== void 0 ? _obj$runningList : null;\n      this.automationEnabled = obj === null || obj === void 0 ? void 0 : obj.automationEnabled;\n      this.autotriggerIntervalSetting = (obj === null || obj === void 0 ? void 0 : obj.autotriggerIntervalSetting) || 10;\n      if (this.mapLists) {\n        for (var key in this.mapLists) {\n          this.mapLists[key].tiles = (this.mapLists[key].tiles || []).filter(function (one) {\n            return one.time > 0;\n          });\n        }\n      }\n      this.regenerateListsPriorityMap();\n      console.log('RNN: ', this.runningList);\n      if (obj !== null && obj !== void 0 && obj.runningList && Object.keys(obj === null || obj === void 0 ? void 0 : obj.runningList).length) {\n        this.stopList();\n        this.runList(obj === null || obj === void 0 ? void 0 : obj.runningList.id);\n      }\n    }\n  }, {\n    key: \"getAutotriggerList\",\n    value: function getAutotriggerList() {\n      var _iterator = _createForOfIteratorHelper(this.listsAutotrigger),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _this$mapLists$list$i, _this$mapLists$list$i2;\n          var list = _step.value;\n          if ((0,_shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_2__.checkMatchingRules)((_this$mapLists$list$i = this.mapLists[list.id]) === null || _this$mapLists$list$i === void 0 || (_this$mapLists$list$i = _this$mapLists$list$i.autotrigger) === null || _this$mapLists$list$i === void 0 ? void 0 : _this$mapLists$list$i.rules, (_this$mapLists$list$i2 = this.mapLists[list.id]) === null || _this$mapLists$list$i2 === void 0 || (_this$mapLists$list$i2 = _this$mapLists$list$i2.autotrigger) === null || _this$mapLists$list$i2 === void 0 ? void 0 : _this$mapLists$list$i2.pattern)) {\n            return list.id;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return null;\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      // Here we checking autotrigger\n      // console.log('Autotrigger map', this.automationEnabled, this.listsAutotrigger, this.autotriggerCD);\n      if (this.automationEnabled && this.listsAutotrigger.length && this.autotriggerCD <= 0) {\n        var _this$runningList4;\n        this.autotriggerCD = this.autotriggerIntervalSetting || 10;\n        var autotrigger = this.getAutotriggerList();\n        if (autotrigger && ((_this$runningList4 = this.runningList) === null || _this$runningList4 === void 0 ? void 0 : _this$runningList4.id) !== autotrigger) {\n          var _this$runningList5;\n          console.log('Run list autotrigger: ', autotrigger, (_this$runningList5 = this.runningList) === null || _this$runningList5 === void 0 ? void 0 : _this$runningList5.id, this.listsAutotrigger);\n          this.runList(autotrigger);\n        }\n      }\n      this.autotriggerCD -= delta;\n    }\n  }, {\n    key: \"packEffects\",\n    value: function packEffects(effects) {\n      var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (item) {\n        return true;\n      };\n      var result = effects.filter(filter).reduce(function (acc, item) {\n        acc[item.id] = item;\n        return acc;\n      }, {});\n      return result;\n    }\n  }, {\n    key: \"runCombinedList\",\n    value: function runCombinedList(id) {\n      var data = this.mapLists[id];\n      var totalTime = data.tiles.reduce(function (acc, item) {\n        return acc += item.time;\n      }, 0);\n      var tileFractions = data.tiles.map(function (tile) {\n        return _objectSpread(_objectSpread({}, tile), {}, {\n          effortFraction: tile.time / totalTime\n        });\n      });\n\n      // now registering entities for every action\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('map').stopRunningTiles();\n      tileFractions.forEach(function (tileToRun) {\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('map').setTileRunning(tileToRun.i, tileToRun.j, true, tileToRun.effortFraction);\n      });\n    }\n  }, {\n    key: \"sendListData\",\n    value: function sendListData(id) {\n      var bForceOpen = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var data = this.mapLists[id];\n      data.drops = this.getListEffects(id);\n      data.costs = this.getListCosts(id);\n      data.bForceOpen = bForceOpen;\n\n      // console.log('SendingData: ', JSON.stringify(data.prevEffects), JSON.stringify(data.resourcesEffects));\n\n      this.eventHandler.sendData('map-tile-list-data', data);\n    }\n  }, {\n    key: \"getListEffects\",\n    value: function getListEffects(id, listData) {\n      var list = this.mapLists[id];\n      if (!list) {\n        if (!listData) {\n          throw new Error(\"List with id \".concat(id, \" not found\"));\n        }\n        list = listData;\n      }\n      var totalTime = list.tiles.reduce(function (acc, item) {\n        return acc += item.time;\n      }, 0);\n      var totalEffects = {};\n      list.tiles.forEach(function (tile) {\n        var weight = tile.time / totalTime;\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('map').mapTilesProcessed[tile.i][tile.j].drops.filter(function (d, index) {\n          var _gameCore$getModule$m;\n          return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.isResourceUnlocked(d.id) && ((_gameCore$getModule$m = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('map').mapTilesProcessed[tile.i][tile.j].r) === null || _gameCore$getModule$m === void 0 ? void 0 : _gameCore$getModule$m.includes(index));\n        }).map(function (d) {\n          return _objectSpread(_objectSpread({}, d), {}, {\n            probability: d.probability * weight,\n            weightedAmountMin: d.probability * weight * d.amountMin,\n            weightedAmountMax: d.probability * weight * d.amountMax\n          });\n        });\n        effects.forEach(function (drop) {\n          if (!totalEffects[drop.id]) {\n            totalEffects[drop.id] = {\n              id: drop.id,\n              probability: 0,\n              amountMin: 0,\n              amountMax: 0,\n              resource: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource(drop.id)\n            };\n          }\n\n          //     \n          totalEffects[drop.id].probability += drop.probability;\n          totalEffects[drop.id].amountMin += drop.weightedAmountMin;\n          totalEffects[drop.id].amountMax += drop.weightedAmountMax;\n        });\n      });\n\n      //  `amountMin`  `amountMax`  \n      Object.values(totalEffects).forEach(function (effect) {\n        if (effect.probability > 0) {\n          effect.amountMin /= effect.probability;\n          effect.amountMax /= effect.probability;\n        }\n      });\n      return Object.values(totalEffects);\n    }\n  }, {\n    key: \"getListCosts\",\n    value: function getListCosts(id, listData) {\n      var list = this.mapLists[id];\n      if (!list) {\n        if (!listData) {\n          throw new Error(\"List with id \".concat(id, \" not found\"));\n        }\n        list = listData;\n      }\n      var totalTime = list.tiles.reduce(function (acc, item) {\n        return acc += item.time;\n      }, 0);\n      var totalCosts = {};\n      list.tiles.forEach(function (tile) {\n        var weight = tile.time / totalTime;\n        var costs = (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_3__.mapObject)(game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('map').mapTilesProcessed[tile.i][tile.j].cost, function (c, id) {\n          return {\n            id: id,\n            value: c.value * weight\n          };\n        });\n        console.log('ProcessingCosts: ', costs, game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('map').mapTilesProcessed[tile.i][tile.j].cost);\n        Object.values(costs).forEach(function (cost) {\n          if (!totalCosts[cost.id]) {\n            totalCosts[cost.id] = {\n              id: cost.id,\n              name: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource(cost.id).name,\n              cost: 0\n            };\n          }\n\n          //     \n          totalCosts[cost.id].cost += cost.value || 0;\n        });\n      });\n      return Object.values(totalCosts);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/map/map-tile-lists.submodule.js?");

/***/ }),

/***/ "./src/worker/modules/map/map.module.js":
/*!**********************************************!*\
  !*** ./src/worker/modules/map/map.module.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MapModule: () => (/* binding */ MapModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _tile_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tile-db */ \"./src/worker/modules/map/tile-db.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _map_tile_lists_submodule__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./map-tile-lists.submodule */ \"./src/worker/modules/map/map-tile-lists.submodule.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar MapModule = /*#__PURE__*/function (_GameModule) {\n  function MapModule() {\n    var _this;\n    _classCallCheck(this, MapModule);\n    _this = _callSuper(this, MapModule);\n    _this.tileTypes = [];\n    _this.mapTiles = [];\n    _this.mapTilesProcessed = [];\n    _this.refreshTimeout = 0;\n    _this.highlightResources = {};\n    _this.lists = new _map_tile_lists_submodule__WEBPACK_IMPORTED_MODULE_3__.MapTileListsSubmodule();\n    _this.eventHandler.registerHandler('query-map-data', function () {\n      _this.sendData();\n    });\n    _this.eventHandler.registerHandler('map-highlight-resources', function (payload) {\n      console.log('setHighLight: ', payload);\n      _this.highlightResources = {};\n      payload.ids.forEach(function (id) {\n        _this.highlightResources[id] = true;\n      });\n      _this.sendData();\n    });\n    _this.eventHandler.registerHandler('query-map-tile-details', function (_ref) {\n      var i = _ref.i,\n        j = _ref.j;\n      _this.sendDetails({\n        i: i,\n        j: j\n      });\n    });\n    _this.eventHandler.registerHandler('toggle-map-tile-running', function (_ref2) {\n      var i = _ref2.i,\n        j = _ref2.j,\n        flag = _ref2.flag;\n      if (flag) {\n        _this.stopRunningTiles(); // only one tile in single tile mode\n      }\n      _this.setTileRunning(i, j, flag);\n    });\n    return _this;\n  }\n  _inherits(MapModule, _GameModule);\n  return _createClass(MapModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      this.tileTypes = (0,_tile_db__WEBPACK_IMPORTED_MODULE_1__.registerTileTypesDB)();\n      this.generateMap();\n    }\n  }, {\n    key: \"generateMap\",\n    value: function generateMap() {\n      for (var i = 0; i < 15; i++) {\n        this.mapTiles[i] = [];\n        for (var j = 0; j < 15; j++) {\n          if (i === 7 && j === 7) {\n            this.mapTiles[i][j] = {\n              i: i,\n              j: j,\n              distance: 0,\n              metaData: {\n                id: 'settlement',\n                name: 'Settlement',\n                color: '#666'\n              },\n              drops: [],\n              costMult: 0,\n              r: []\n            };\n          } else {\n            this.mapTiles[i][j] = this.generateRandomTile(i, j);\n          }\n        }\n      }\n      this.processTiles();\n    }\n  }, {\n    key: \"generateRandomTile\",\n    value: function generateRandomTile(i, j) {\n      var expectType = Math.floor(Math.pow(Math.random(), 1.5) * this.tileTypes.length);\n      var distance = Math.sqrt(Math.pow(i - 7, 2) + Math.pow(j - 7, 2));\n      var metaData = this.tileTypes[expectType];\n      var resources = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.listResourcesByTags(['gatherable']);\n      var complexity = Math.max(1, distance - 2 + Math.random() * (distance - 2));\n      return {\n        distance: distance,\n        i: i,\n        j: j,\n        metaData: metaData,\n        drops: this.generateRandomDrop(distance, complexity, metaData.id, resources),\n        costMult: Math.pow(complexity, 1.75)\n      };\n    }\n  }, {\n    key: \"stopRunningTiles\",\n    value: function stopRunningTiles() {\n      var _this2 = this;\n      var activeEntities = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['exploration']);\n      activeEntities.forEach(function (ent) {\n        _this2.setTileRunning(ent.attributes.i, ent.attributes.j, false, 1);\n      });\n    }\n  }, {\n    key: \"setTileRunning\",\n    value: function setTileRunning(i, j, flag) {\n      var effort = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n      var runningEntityId = \"tile_\".concat(i, \"_\").concat(j, \"_exploration\");\n      var tileData = this.mapTilesProcessed[i][j];\n      var isRunning = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.entityExists(runningEntityId);\n      this.mapTiles[i][j].isRunning = flag;\n      this.mapTiles[i][j].effort = effort;\n      if (!flag) {\n        if (isRunning) {\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.unsetEntity(runningEntityId);\n        }\n      }\n      if (flag) {\n        if (!isRunning) {\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.registerGameEntity(runningEntityId, {\n            name: \"Map Exploration: \".concat(i, \":\").concat(j),\n            tags: [\"map\", \"tile\", \"exploration\"],\n            unlockCondition: function unlockCondition() {\n              return true;\n            },\n            level: 1,\n            maxLevel: 1,\n            attributes: {\n              i: i,\n              j: j\n            },\n            effectFactor: effort,\n            resourceModifier: {\n              consumption: {\n                resources: {\n                  'gathering_effort': {\n                    A: 0,\n                    B: tileData.cost.gathering_effort.value,\n                    type: 0\n                  }\n                }\n              },\n              effectDeps: ['gathering_efficiency']\n            }\n          });\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.setEntityLevel(runningEntityId, 1, true);\n        }\n      }\n      this.processTiles();\n      this.sendData();\n    }\n  }, {\n    key: \"generateRandomDrop\",\n    value: function generateRandomDrop(distance, complexity, expectType, resources) {\n      // Filter resources to match the expected tile type\n      var potentialResources = resources.filter(function (one) {\n        return !one.allowedTileTypes || one.allowedTileTypes.includes(expectType);\n      });\n\n      // If no matching resources, return an empty array\n      if (potentialResources.length === 0) {\n        return [];\n      }\n\n      // Separate resources by rarity\n      var rarityBuckets = {\n        low: potentialResources.filter(function (r) {\n          return r.rarity <= 1;\n        }),\n        // rarity 0-1\n        mid: potentialResources.filter(function (r) {\n          return r.rarity >= 2 && r.rarity <= 3;\n        }),\n        // rarity 2-3\n        high: potentialResources.filter(function (r) {\n          return r.rarity >= 4 && r.rarity <= 5;\n        }) // rarity 4-5\n      };\n      console.log('rarityBuckets: ', rarityBuckets, potentialResources);\n\n      // Ensure we have at least 1 resource with rarity 0-1\n      var drops = [];\n      if (rarityBuckets.low.length > 0) {\n        for (var i = 0; i < Math.min(2, rarityBuckets.low.length); i++) {\n          var lowRarityResource = rarityBuckets.low[Math.floor(Math.random() * rarityBuckets.low.length)];\n          drops.push({\n            id: lowRarityResource.id,\n            amountMult: complexity / ((1 + lowRarityResource.rarity) * Math.pow(lowRarityResource.sellPrice, 0.05)),\n            probabilityMult: Math.pow(complexity, 0.4) / ((1 + Math.pow(lowRarityResource.rarity, 0.5)) * Math.pow(lowRarityResource.sellPrice, 0.25))\n          });\n        }\n      }\n\n      // Determine how many more resources are needed (at least 3 in total)\n      var remainingDropsCount = 5 - drops.length;\n\n      // Add resources from other rarity levels\n      var additionalDrops = [];\n      for (var _i = 0; _i < remainingDropsCount; _i++) {\n        var roll = Math.random();\n        var bucket = void 0;\n        if (roll < 0.75 && rarityBuckets.mid.length > 0) {\n          // 50% chance to pick from rarity 2-3\n          bucket = rarityBuckets.mid;\n        } else if (roll < 0.95 && rarityBuckets.high.length > 0) {\n          // 25% chance to pick from rarity 4-5\n          bucket = rarityBuckets.high;\n        } else if (rarityBuckets.low.length > 0) {\n          // Default back to rarity 0-1 if no other buckets are valid\n          bucket = rarityBuckets.low;\n        }\n        if (bucket && bucket.length > 0) {\n          var selectedResource = bucket[Math.floor(Math.random() * bucket.length)];\n          additionalDrops.push({\n            id: selectedResource.id,\n            amountMult: complexity / ((1 + selectedResource.rarity) * Math.pow(selectedResource.sellPrice, 0.05)),\n            probabilityMult: Math.pow(complexity, 0.5) / ((1 + Math.pow(selectedResource.rarity, 0.5)) * Math.pow(selectedResource.sellPrice, 0.25))\n          });\n        }\n      }\n\n      // Combine the guaranteed low rarity drop and additional drops\n      drops.push.apply(drops, additionalDrops);\n\n      // Ensure unique drops (remove duplicates by ID)\n      var uniqueDrops = Array.from(new Map(drops.map(function (r) {\n        return [r.id, r];\n      })).values());\n\n      // Trim to exactly 3 drops\n      return uniqueDrops.slice(0, 5);\n    }\n  }, {\n    key: \"processTiles\",\n    value: function processTiles() {\n      var _this3 = this;\n      this.mapTilesProcessed = [];\n      this.filterableLoots = {};\n      var _loop = function _loop(i) {\n        _this3.mapTilesProcessed[i] = [];\n        var _loop2 = function _loop2(j) {\n          var _this3$mapTiles$i$j$r;\n          var efficiency = 1;\n          if (game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.entityExists(\"tile_\".concat(i, \"_\").concat(j, \"_exploration\"))) {\n            efficiency = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntityEfficiency(\"tile_\".concat(i, \"_\").concat(j, \"_exploration\"));\n          }\n          var effEff = Math.pow(efficiency, 0.5);\n          var r = (_this3$mapTiles$i$j$r = _this3.mapTiles[i][j].r) !== null && _this3$mapTiles$i$j$r !== void 0 ? _this3$mapTiles$i$j$r : [];\n          if (r.length && r.length > _this3.mapTiles[i][j].drops.length) {\n            _this3.mapTiles[i][j].r = _toConsumableArray(new Set(r));\n          }\n          var isNoviceArea = Math.abs(i - 7) < 2 && Math.abs(j - 7) < 2;\n          _this3.mapTilesProcessed[i][j] = _objectSpread(_objectSpread({}, _this3.mapTiles[i][j]), {}, {\n            efficiency: efficiency,\n            effEff: effEff,\n            drops: _this3.mapTiles[i][j].drops.map(function (d, index) {\n              var _this3$mapTiles$i$j$r2;\n              var isRevealed = (_this3$mapTiles$i$j$r2 = _this3.mapTiles[i][j].r) === null || _this3$mapTiles$i$j$r2 === void 0 ? void 0 : _this3$mapTiles$i$j$r2.includes(index);\n              var rs = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(d.id);\n              var isHerb = rs.tags.includes('herb');\n              var isRare = rs.tags.includes('rare');\n              var amtHerbsMult = 1.;\n              if (isHerb) {\n                amtHerbsMult = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('gathering_herbs_amount');\n                if (isRare) {\n                  amtHerbsMult = 0.25 * Math.pow(amtHerbsMult, 0.5);\n                }\n              }\n              var rarityProbMult = 1.;\n              if (rs.rarity <= 2) {\n                rarityProbMult *= Math.pow(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEffects.getEffectValue('gathering_low_chance'), 1 / (1 + 0.25 * rs.rarity));\n              }\n              if (isRevealed) {\n                if (!_this3.filterableLoots[d.id]) {\n                  _this3.filterableLoots[d.id] = [];\n                }\n                _this3.filterableLoots[d.id].push({\n                  i: i,\n                  j: j\n                });\n              }\n              var prob = 0.03 * d.probabilityMult * rarityProbMult * effEff * (1 + Math.pow(game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('gathering_perception').amount, 0.75));\n              if (prob > 0.2) {\n                prob = Math.min(0.5, 0.2 + Math.pow(prob - 0.2, 1.5));\n              }\n              return _objectSpread(_objectSpread({}, d), {}, {\n                probability: prob,\n                amountMin: Math.max(1, 3 * d.amountMult * effEff * amtHerbsMult * (rs.lootAmountMult || 1)),\n                amountMax: Math.max(1, 6 * d.amountMult * effEff * amtHerbsMult * (rs.lootAmountMult || 1)),\n                isRevealed: isRevealed\n              });\n            }),\n            cost: _defineProperty({}, 'gathering_effort', {\n              name: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('gathering_effort').name,\n              value: _this3.mapTiles[i][j].costMult * (isNoviceArea ? 0.25 : 1)\n            })\n          });\n        };\n        for (var j = 0; j < _this3.mapTiles[i].length; j++) {\n          _loop2(j);\n        }\n      };\n      for (var i = 0; i < this.mapTiles.length; i++) {\n        _loop(i);\n      }\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        mapTiles: this.mapTiles,\n        lists: this.lists.save()\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      if (obj !== null && obj !== void 0 && obj.mapTiles) {\n        this.mapTiles = obj.mapTiles;\n        for (var i = 0; i < this.mapTiles.length; i++) {\n          for (var j = 0; j < this.mapTiles[i].length; j++) {\n            if (this.mapTiles[i][j].isRunning) {\n              this.setTileRunning(i, j, true, this.mapTiles[i][j].effort);\n            } else {\n              this.setTileRunning(i, j, false, 1);\n            }\n          }\n        }\n        this.processTiles();\n      } else {\n        this.generateMap();\n      }\n      this.lists.load((obj === null || obj === void 0 ? void 0 : obj.lists) || {});\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      var _this4 = this;\n      var filterableLoot = Object.keys(this.filterableLoots).map(function (one) {\n        return _objectSpread(_objectSpread({}, game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(one)), {}, {\n          isSelected: _this4.highlightResources[one]\n        });\n      });\n      return {\n        mapTiles: this.mapTilesProcessed.map(function (row) {\n          return row.map(function (col) {\n            var isHighlight = col.drops.some(function (drop) {\n              return _this4.highlightResources[drop.id] && drop.isRevealed;\n            });\n            return _objectSpread(_objectSpread({}, col), {}, {\n              drops: col.drops.map(function (drop, index) {\n                return _objectSpread(_objectSpread({}, drop), {}, {\n                  resource: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(drop.id)\n                });\n              }),\n              isHighlight: isHighlight\n            });\n          });\n        }),\n        explorationPoints: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('gathering_effort'),\n        mapLists: this.lists.getLists(),\n        filterableLoot: filterableLoot\n      };\n    }\n  }, {\n    key: \"sendData\",\n    value: function sendData() {\n      var data = this.getData();\n      // console.log('DATA: ', data);\n      this.eventHandler.sendData('map-data', data);\n    }\n  }, {\n    key: \"getDetails\",\n    value: function getDetails(i, j) {\n      var tile = this.mapTilesProcessed[i][j];\n      // console.log('Querying tile.drops: ', i, j, tile.drops, tile.drops.filter((drop, index) => (!tile.r?.includes(index)) && gameResources.isResourceUnlocked(drop.id)));\n\n      return _objectSpread(_objectSpread({}, tile), {}, {\n        name: tile.metaData.name,\n        unlockedUnrevealedAmount: tile.drops.filter(function (drop, index) {\n          var _tile$r;\n          return !((_tile$r = tile.r) !== null && _tile$r !== void 0 && _tile$r.includes(index)) && game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.isResourceUnlocked(drop.id);\n        }).length,\n        drops: tile.drops.map(function (drop, index) {\n          var _tile$r2;\n          return _objectSpread(_objectSpread({}, drop), {}, {\n            resource: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(drop.id),\n            isRevealed: ((_tile$r2 = tile.r) === null || _tile$r2 === void 0 ? void 0 : _tile$r2.includes(index)) && game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.isResourceUnlocked(drop.id)\n          });\n        }).filter(function (one) {\n          return one.isRevealed;\n        })\n      });\n    }\n  }, {\n    key: \"sendDetails\",\n    value: function sendDetails(_ref3) {\n      var i = _ref3.i,\n        j = _ref3.j;\n      var data = this.getDetails(i, j);\n      this.eventHandler.sendData('map-tile-details', data);\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      var _this5 = this;\n      this.refreshTimeout -= delta;\n      if (this.refreshTimeout <= 0) {\n        this.processTiles();\n        this.refreshTimeout = 2;\n\n        // attempt to drop something\n        var activeEntities = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['exploration']);\n        activeEntities.forEach(function (ent) {\n          var tile = _this5.mapTilesProcessed[ent.attributes.i][ent.attributes.j];\n          tile.drops.forEach(function (drop, index) {\n            if (!game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.isResourceUnlocked(drop.id)) {\n              return;\n            }\n            var roll = Math.random();\n            if (roll < 2 * drop.probability * ent.effectFactor) {\n              var amt = Math.round(drop.amountMin + Math.random() * drop.amountMax);\n              game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.addResource(drop.id, amt);\n              if (!_this5.mapTiles[ent.attributes.i][ent.attributes.j].r) {\n                _this5.mapTiles[ent.attributes.i][ent.attributes.j].r = [];\n              }\n              if (!_this5.mapTiles[ent.attributes.i][ent.attributes.j].r.includes(index)) {\n                _this5.mapTiles[ent.attributes.i][ent.attributes.j].r.push(index);\n              }\n              console.log(\"Found \".concat(drop.id, \" at \").concat(ent.attributes.i, \":\").concat(ent.attributes.j, \" with chance \").concat(roll, \" < \").concat(drop.probability, \": \").concat(amt, \". EntEff: \").concat(ent.efficiency), _this5.mapTiles[ent.attributes.i][ent.attributes.j]);\n            }\n          });\n        });\n      }\n      this.lists.tick(game, delta);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/map/map.module.js?");

/***/ }),

/***/ "./src/worker/modules/map/tile-db.js":
/*!*******************************************!*\
  !*** ./src/worker/modules/map/tile-db.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerTileTypesDB: () => (/* binding */ registerTileTypesDB)\n/* harmony export */ });\nvar registerTileTypesDB = function registerTileTypesDB() {\n  return [{\n    id: 'plain',\n    name: 'Plain',\n    color: '#97cd46',\n    icon: 'terrain_plain'\n  }, {\n    id: 'mountain',\n    name: 'Mountain',\n    color: '#d7cd96',\n    icon: 'terrain_mountain'\n  }, {\n    id: 'forest',\n    name: 'Forest',\n    color: '#27ad46',\n    icon: 'terrain_forest'\n  }, {\n    id: 'savanna',\n    name: 'Savanna',\n    color: '#f7fd36',\n    icon: 'terrain_savanna'\n  }, {\n    id: 'hills',\n    name: 'Hills',\n    color: '#679df6',\n    icon: 'terrain_hills'\n  }, {\n    id: 'swamp',\n    name: 'Swamp',\n    color: '#a78d26',\n    icon: 'terrain_swamp'\n  }, {\n    id: 'lakes',\n    name: 'Lakes',\n    color: '#67fdf6',\n    icon: 'terrain_lake'\n  }];\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/map/tile-db.js?");

/***/ }),

/***/ "./src/worker/modules/property/accessories-db.js":
/*!*******************************************************!*\
  !*** ./src/worker/modules/property/accessories-db.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerAccessoriesStage1: () => (/* binding */ registerAccessoriesStage1)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerAccessoriesStage1 = function registerAccessoriesStage1() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_wooden_casket', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Wooden Casket',\n    description: 'Create compact and easy to handle wooden caskets to improve your coins storage',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'coins': {\n            A: 0.1,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_refined_wood': {\n          A: 1.1,\n          B: 1,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_wooden_talisman', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Wooden Talisman',\n    description: 'Create wooden talisman that holds information about your bio-rhythms and improve your health regeneration',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'health': {\n            A: 0.02,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_refined_wood': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'knowledge': {\n          A: 1.1,\n          B: 20,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_wooden_bookcase', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Wooden Bookcase',\n    description: 'Minimalistic and very convenient bookcase can significantly increase amount of books you can store, and therefore increase your knowledge cap',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'knowledge': {\n            A: 0.1,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_refined_wood': {\n          A: 1.1,\n          B: 1,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_aromatic_carpet', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Aromatic Carpet',\n    description: 'Craft aromatic carpet that inspires you and boosts your energy recovery',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'energy': {\n            A: 0.02,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_herbal_fibers': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'mana': {\n          A: 1.1,\n          B: 3,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_scroll_of_wisdom', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Scroll of Wisdom',\n    description: 'A scroll inscribed with glowing runes that impart knowledge to the reader. It continuously generates insight, aiding the bearer in gradually increasing their understanding and intelligence over time.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_paper_working') > 0;\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'knowledge': {\n            A: 0.005,\n            B: 0,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_paper': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'mana': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_scroll_of_restoration', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Charm of Restoration Magic',\n    description: 'A delicately folded paper charm shaped like a bird, imbued with restorative magic',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_paper_working') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'restoration_spells_efficiency': {\n            A: 0.025,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_paper': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'knowledge': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'inventory_aloe_vera': {\n          A: 1.1,\n          B: 20,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_tome_of_mentalist', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Mentalist\\'s Tome',\n    description: 'Magic book containing a lot of mental power',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_paper_enhance') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'mental_training_learning_rate': {\n            A: 0.025,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_enchanted_paper': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'knowledge': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'inventory_herbal_fibers': {\n          A: 1.1,\n          B: 20,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_tome_of_occultism', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Occultist\\'s Tome',\n    description: 'Small glowing tome. You feel inspiration every time you touch it',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_paper_enhance') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'spiritual_learning_rate': {\n            A: 0.025,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_enchanted_paper': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'knowledge': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'inventory_herbal_fibers': {\n          A: 1.1,\n          B: 20,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_ruby_pendant', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Ruby Pendant',\n    description: 'Create ruby pendant that empowers your physical learning rate',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_quarrying');\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'physical_training_learn_speed': {\n            A: 0.04,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_ruby': {\n          A: 1.1,\n          B: 1,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_vitality_talisman', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Vitality Talisman',\n    description: 'Increase your HP and energy caps',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_quarrying');\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'energy': {\n            A: 0.05,\n            B: 1,\n            C: 1.01,\n            type: 3\n          },\n          'health': {\n            A: 0.05,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_ruby': {\n          A: 1.1,\n          B: 1,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_sapphire_ring', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Sapphire Ring',\n    description: 'Increase your spell XP gain',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_quarrying');\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'spell_xp_rate': {\n            A: 0.1,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_sapphire': {\n          A: 1.1,\n          B: 1,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_sapphire_pendant', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Sapphire Pendant',\n    description: 'Increase your mana cap',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_quarrying');\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'mana': {\n            A: 0.05,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_sapphire': {\n          A: 1.1,\n          B: 1,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_iron_stash', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Iron Stash',\n    description: 'Craft better and more reliable iron containers for storing coins',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_mining');\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'coins': {\n            A: 0.05,\n            B: 1,\n            C: 1.01,\n            type: 3\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_iron_plate': {\n          A: 1.1,\n          B: 1,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('accessory_lumber_mill', {\n    tags: [\"accessory\", \"upgrade\", \"purchaseable\"],\n    name: 'Lumber Mill',\n    description: 'Build a machine that helps you to process wood',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_mining');\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'inventory_refined_wood': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'inventory_iron_plate': {\n          A: 1.1,\n          B: 2,\n          type: 1\n        },\n        'inventory_stone': {\n          A: 1.1,\n          B: 5,\n          type: 1\n        },\n        'inventory_refined_wood': {\n          A: 1.1,\n          B: 5,\n          type: 1\n        }\n      };\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/property/accessories-db.js?");

/***/ }),

/***/ "./src/worker/modules/property/furniture-db.js":
/*!*****************************************************!*\
  !*** ./src/worker/modules/property/furniture-db.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerFurnitureStage1: () => (/* binding */ registerFurnitureStage1)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerFurnitureStage1 = function registerFurnitureStage1() {\n  var charismaMod = function charismaMod(attr) {\n    return attr > 0 ? 1. / (1. + 0.02 * Math.log2(attr * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('prices_discount'))) : 1.;\n  };\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_sleeping_bag', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Sleeping Bag',\n    description: 'Elementary place where you can sleep. Improves rest efficiency',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'rest_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 50 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_cart', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Cart',\n    description: 'Easy and convenient cart for better transportation of gathered things. Improves gathering efficiency',\n    level: 0,\n    maxLevel: 2,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'gathering_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 30 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_urn', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Urn',\n    description: 'Small urn to store more gold',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    resourceModifier: {\n      get_rawCap: function get_rawCap() {\n        return {\n          resources: {\n            'coins': {\n              A: 75 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('urn_storage_bonus'),\n              B: 0,\n              type: 0\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      effectDeps: ['urn_storage_bonus']\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 40 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_table', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Table',\n    description: 'Place some table where you can sit and put down notes or read books.',\n    level: 0,\n    maxLevel: 2,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    resourceModifier: {\n      get_multiplier: function get_multiplier() {\n        return {\n          effects: {\n            'learning_rate': {\n              A: 0.25,\n              B: 1,\n              type: 0\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      effectDeps: ['urn_storage_bonus']\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 50 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_book_case', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Small Book Case',\n    description: 'Place some small wooden furniture to place books and notes.',\n    level: 0,\n    maxLevel: 3,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance');\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'knowledge': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'knowledge': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 100 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_lump', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Oil Lamp',\n    description: 'Brighten your living space for more convenient reading, writing and learning',\n    level: 0,\n    maxLevel: 5,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_library_entrance') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('furniture_table') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'knowledge': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        },\n        effects: {\n          'learning_rate': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 250 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_cot', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Cot',\n    description: 'Old and smelly, but much better than your sleep bag',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 3;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'rest_efficiency': {\n            A: 0.4,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 50 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_armchair', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Armchair',\n    description: 'Looking quite oddly, but comfortable',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 3;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'rest_efficiency': {\n            A: 0.4,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 75 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_basin_bowl', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Basin Bowl',\n    description: 'A small bowl or basin filled with water, typically used for washing hands or face.',\n    level: 0,\n    maxLevel: 1,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 3;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'rest_efficiency': {\n            A: 0.5,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 150 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_yoga_carpet', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Yoga Carpet',\n    description: 'Use it for your daily yoga practices, increasing yoga XP rate',\n    level: 0,\n    maxLevel: 6,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_yoga_manual') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'yoga_learn_speed': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 150 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_workout_bench', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Workout Bench',\n    description: 'Provide some elementary inventory to improve physical training efficiency, like Training Endurance',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_tent') > 3 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('action_pushup') > 4;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'physical_training_learn_speed': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 150 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_gym', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Personal Gym',\n    description: 'Provide better inventory to improve physical training efficiency',\n    level: 0,\n    maxLevel: 10,\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_strength',\n      level: 225\n    }],\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'physical_training_learn_speed': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 100000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 3,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_magic_orb', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Magic Orb',\n    description: 'Place magic orb to improve mana regeneration',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'mana': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 1250 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_candle_holder', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Candle Holder',\n    description: 'Place magic candle holder to further improve mana power',\n    level: 0,\n    maxLevel: 3,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'mana': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 2500 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_mana_orb', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Mana Orb',\n    description: 'Made of mana and glass',\n    level: 0,\n    maxLevel: 5,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spellbook') > 0;\n    },\n    resourceModifier: {\n      rawCap: {\n        resources: {\n          'mana': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 5000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_restoration_magic_circle', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Restoration Magic Circle',\n    description: 'Improves your restoration magic efficiency',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_less_restoration') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'restoration_spells_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 10000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 3,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_illusion_magic_circle', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Illusion Magic Circle',\n    description: 'Improves your illusion magic efficiency',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_less_illusion') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'illusion_spells_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 10000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 3,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_spirit_crystal', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Spirit Crystal',\n    description: 'Magic spirit captured into crystal provides significant amplifier to your magical capabilities',\n    level: 0,\n    maxLevel: 5,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spiritualism') > 0;\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'mana': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      multiplier: {\n        resources: {\n          'mana': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 100000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 3,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_spell_analyzer', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Spell Analyzer',\n    description: 'Device that capturing acoustic and energetic waves from your spells, and provide you waves histogram for further analysis and learning',\n    level: 0,\n    maxLevel: 5,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_spiritualism') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'spell_xp_rate': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 2,\n          B: 100000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 3,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_crafting_table', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Crafting Table',\n    description: 'Provides additional space for crafting, revealing new crafting slot',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 80000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_masters_table', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Masters Table',\n    description: 'Specialized \"masters table\" with enhanced tools that boosts crafting efficiency',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_crafting_courses') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'crafting_ability': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 80000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_cauldron', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Cauldron',\n    description: 'Provides additional space for alchemy, revealing new alchemy slot',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 80000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_chemistry_lab_equipment', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Chemistry Lab',\n    description: 'Place some additional equipment to improve your ability of studying chemical reactions between ingredients',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'alchemy_ability': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 80000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_drying_rack', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Herbalist\\'s Drying Rack\\n',\n    description: 'This rustic wooden rack is woven with strands of enchanted twine, used by skilled herbalists to preserve the potency of rare plants. Hanging bunches of herbs and roots sway gently, their fragrance filling the room and infusing the air with traces of ancient magic. With this rack, even common plants yield their highest quality, providing you a greater chance to find potent herbs in the wild.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'gathering_herbs_amount': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 120000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_herbs_plantation', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Herbs Plantation',\n    description: 'Devote some space for platations to grow your very own herbs and plants',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbalists_handbook') > 0;\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'plantation_slots': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 1000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 3,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_well', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Well',\n    description: 'Dig well to make watering process more efficient, increasing plants growth rate',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_herbalists_handbook') > 0;\n    },\n    resourceModifier: {\n      income: {\n        effects: {\n          'plantations_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 1000000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_tools_workshop', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Tools Workshop',\n    description: 'Provides you with some place and instruments to repair your tools, increasing your manual-labor actions efficiency',\n    level: 0,\n    maxLevel: 6,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.isEntityUnlocked('action_woodcutter') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'manual_labor_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 3,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 600000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 3,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('furniture_fertilizing_station', {\n    tags: [\"furniture\", \"upgrade\", \"purchaseable\"],\n    name: 'Fertilizing Station',\n    description: 'Purchase some basic tools for analyzing soil on your plantations and further increase your plantations efficiency',\n    level: 0,\n    maxLevel: 4,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_soil_manual') > 0;\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'plantations_efficiency': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'living_space': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'coins': {\n          A: 1.5,\n          B: 1500000 * charismaMod(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('attribute_charisma')),\n          type: 1\n        },\n        'living_space': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/property/furniture-db.js?");

/***/ }),

/***/ "./src/worker/modules/property/property.module.js":
/*!********************************************************!*\
  !*** ./src/worker/modules/property/property.module.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PropertyModule: () => (/* binding */ PropertyModule)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _furniture_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./furniture-db */ \"./src/worker/modules/property/furniture-db.js\");\n/* harmony import */ var _accessories_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./accessories-db */ \"./src/worker/modules/property/accessories-db.js\");\n/* harmony import */ var game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! game-framework/src/utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\n\nvar PropertyModule = /*#__PURE__*/function (_GameModule) {\n  function PropertyModule() {\n    var _this;\n    _classCallCheck(this, PropertyModule);\n    _this = _callSuper(this, PropertyModule);\n    _this.purchasedFurnitures = {};\n    _this.isUnlocked = false;\n    _this.leveledId = null;\n    _this.hideMaxed = {};\n    _this.searchData = {\n      furniture: {\n        search: '',\n        selectedScopes: ['name']\n      },\n      accessory: {\n        search: '',\n        selectedScopes: ['name']\n      }\n    };\n    _this.eventHandler.registerHandler('purchase-furniture', function (payload) {\n      _this.purchaseFurniture(payload.id, payload.filterId, payload.filterId ? {\n        hideMaxed: _this.hideMaxed[payload.filterId] || false,\n        searchData: _this.searchData[payload.filterId] || {\n          search: '',\n          selectedScopes: ['name']\n        }\n      } : undefined);\n    });\n    _this.eventHandler.registerHandler('set-furniture-hide-maxed', function (payload) {\n      if (payload.filterId) {\n        _this.hideMaxed[payload.filterId] = payload.hideMaxed;\n      }\n    });\n    _this.eventHandler.registerHandler('set-furniture-search-text', function (payload) {\n      if (payload.filterId) {\n        _this.searchData[payload.filterId] = payload.searchData;\n      }\n      console.log('sendFurniture: ', payload, _this.searchData);\n    });\n    _this.eventHandler.registerHandler('delete-furniture', function (payload) {\n      _this.deleteFurniture(payload.id, payload.filterId, payload.filterId ? {\n        hideMaxed: _this.hideMaxed[payload.filterId] || false,\n        searchData: _this.searchData[payload.filterId] || {\n          search: '',\n          selectedScopes: ['name']\n        }\n      } : undefined);\n    });\n    _this.eventHandler.registerHandler('query-furnitures-data', function (payload) {\n      _this.sendFurnituresData(payload, payload.filterId ? {\n        hideMaxed: _this.hideMaxed[payload.filterId] || false,\n        searchData: _this.searchData[payload.filterId] || {\n          search: '',\n          selectedScopes: ['name']\n        }\n      } : undefined);\n    });\n    _this.eventHandler.registerHandler('query-furniture-details', function (payload) {\n      _this.sendFurnitureDetails(payload.id);\n    });\n    return _this;\n  }\n  _inherits(PropertyModule, _GameModule);\n  return _createClass(PropertyModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.registerResource('living_space', {\n        tags: ['living', 'secondary'],\n        name: 'Living Space',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('urn_storage_bonus', {\n        name: 'Urns storage bonus',\n        defaultValue: 1.,\n        minValue: 1,\n        hasCap: false\n      });\n      (0,_furniture_db__WEBPACK_IMPORTED_MODULE_2__.registerFurnitureStage1)();\n      (0,_accessories_db__WEBPACK_IMPORTED_MODULE_3__.registerAccessoriesStage1)();\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      this.leveledId = null;\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        furnitures: this.purchasedFurnitures,\n        hideMaxed: this.hideMaxed,\n        searchData: this.searchData\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {\n      for (var key in this.purchasedFurnitures) {\n        this.setFurniture(key, 0, true);\n      }\n      this.purchasedFurnitures = {};\n      if (saveObject !== null && saveObject !== void 0 && saveObject.furnitures) {\n        for (var id in saveObject.furnitures) {\n          this.setFurniture(id, saveObject.furnitures[id], true);\n        }\n      }\n      this.isUnlocked = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.isUnlocked) || false;\n      this.hideMaxed = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.hideMaxed) || {};\n      this.searchData = (saveObject === null || saveObject === void 0 ? void 0 : saveObject.searchData) || {\n        furniture: {\n          search: '',\n          selectedScopes: ['name']\n        },\n        accessory: {\n          search: '',\n          selectedScopes: ['name']\n        }\n      };\n      this.sendFurnituresData({\n        filterId: 'furniture'\n      });\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.load({});\n    }\n  }, {\n    key: \"setFurniture\",\n    value: function setFurniture(furnitureId, amount) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(furnitureId, amount, bForce);\n      this.purchasedFurnitures[furnitureId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(furnitureId);\n    }\n  }, {\n    key: \"purchaseFurniture\",\n    value: function purchaseFurniture(furnitureId, filterId, options) {\n      var newEnt = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.levelUpEntity(furnitureId);\n      console.log('newEntFurn: ', newEnt);\n      if (newEnt.success) {\n        this.purchasedFurnitures[furnitureId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(furnitureId);\n        this.leveledId = furnitureId;\n        console.log('newEntFurnNEW: ', this.purchasedFurnitures);\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').generateNotifications();\n        this.sendFurnituresData({\n          filterId: filterId\n        }, options);\n      }\n      return newEnt.success;\n    }\n  }, {\n    key: \"deleteFurniture\",\n    value: function deleteFurniture(furnitureId, filterId, options) {\n      if (!this.purchasedFurnitures[furnitureId]) return;\n      this.purchasedFurnitures[furnitureId]--;\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(furnitureId, this.purchasedFurnitures[furnitureId]);\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').generateNotifications();\n      this.sendFurnituresData({\n        filterId: filterId\n      }, options);\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      ['furniture', 'accessory'].forEach(function (filter) {\n        var items = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags([filter]);\n        items.forEach(function (item) {\n          game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('property', filter, item.id, item.isUnlocked && !item.isCapped);\n        });\n      });\n    }\n  }, {\n    key: \"matchSearch\",\n    value: function matchSearch(one, searchData) {\n      if (!searchData) return true;\n      var search = searchData.search,\n        selectedScopes = searchData.selectedScopes;\n      if (!search) return true;\n      if (selectedScopes.includes('name') && one.name.toLowerCase().includes(search)) return true;\n      if (selectedScopes.includes('tags') && one.tags && one.tags.some(function (tag) {\n        return tag.includes(search);\n      })) return true;\n      if (selectedScopes.includes('description') && one.description && one.description.toLowerCase().includes(search)) return true;\n      return false;\n    }\n  }, {\n    key: \"getFurnituresData\",\n    value: function getFurnituresData(payload, options) {\n      var _this2 = this;\n      if (!payload.filterId) {\n        throw new Error('filter is required here');\n      }\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags([payload.filterId]);\n      var spaceRes = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('living_space');\n      return {\n        available: entities.filter(function (one) {\n          return one.isUnlocked && (!(options !== null && options !== void 0 && options.hideMaxed) || !one.isCapped) && _this2.matchSearch(one, options === null || options === void 0 ? void 0 : options.searchData);\n        }).map(function (entity) {\n          return {\n            id: entity.id,\n            name: entity.name,\n            description: entity.description,\n            max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n            level: _this2.purchasedFurnitures[entity.id] || 0,\n            affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n            potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n            isLeveled: _this2.leveledId === entity.id,\n            isCapped: entity.isCapped\n          };\n        }),\n        space: {\n          max: spaceRes.income * spaceRes.multiplier,\n          consumption: spaceRes.consumption,\n          total: spaceRes.amount\n        },\n        searchData: options === null || options === void 0 ? void 0 : options.searchData,\n        hideMaxed: options === null || options === void 0 ? void 0 : options.hideMaxed\n      };\n    }\n  }, {\n    key: \"sendFurnituresData\",\n    value: function sendFurnituresData(payload, options) {\n      var data = this.getFurnituresData(payload, options);\n      this.eventHandler.sendData('furnitures-data', data);\n    }\n  }, {\n    key: \"getFurnitureDetails\",\n    value: function getFurnitureDetails(id) {\n      if (!id) return null;\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(id);\n      return {\n        id: entity.id,\n        name: entity.name,\n        description: entity.description,\n        max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n        level: this.purchasedFurnitures[entity.id] || 0,\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n        potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n        currentEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id),\n        tags: entity.tags\n      };\n    }\n  }, {\n    key: \"sendFurnitureDetails\",\n    value: function sendFurnitureDetails(id) {\n      var data = this.getFurnitureDetails(id);\n      this.eventHandler.sendData('furniture-details', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_1__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/property/property.module.js?");

/***/ }),

/***/ "./src/worker/modules/resources/common-effects-db.js":
/*!***********************************************************!*\
  !*** ./src/worker/modules/resources/common-effects-db.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerCommomEffects: () => (/* binding */ registerCommomEffects)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerCommomEffects = function registerCommomEffects() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('rest_efficiency', {\n    name: 'Rest Efficiency',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('begging_efficiency', {\n    name: 'Begging Efficiency',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('clean_stable_efficiency', {\n    name: 'Clean Stable Efficiency',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('gathering_efficiency', {\n    name: 'Gathering Efficiency',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('gathering_perception', {\n    name: 'Gathering Perception',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('gathering_low_chance', {\n    name: 'Low Rarity Gather Prob.',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('gathering_herbs_amount', {\n    name: 'Herbs Gathered',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('read_books_efficiency', {\n    name: 'Read Books Efficiency',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('books_learning_rate', {\n    name: 'Read Books Learning Rate',\n    defaultValue: 1.,\n    minValue: 1,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('spiritual_learning_rate', {\n    name: 'Spiritual Learning Rate',\n    defaultValue: 1.,\n    minValue: 1,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('mental_training_learning_rate', {\n    name: 'Mental Training Rate',\n    defaultValue: 1.,\n    minValue: 1,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('social_training_learning_rate', {\n    name: 'Social Training Rate',\n    defaultValue: 1.,\n    minValue: 1,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('max_focus_time', {\n    name: 'Max focus time',\n    defaultValue: 300.,\n    minValue: 300\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('coins_earned_bonus', {\n    name: 'Coins Earning Bonus',\n    defaultValue: 1.,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('physical_training_learn_speed', {\n    name: 'Physical Training Learning',\n    defaultValue: 1.,\n    minValue: 1,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('routine_learning_speed', {\n    name: 'Routine Learning',\n    defaultValue: 1.,\n    minValue: 1.,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('yoga_learn_speed', {\n    name: 'Yoga Learning Rate',\n    defaultValue: 1.,\n    minValue: 1.,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('manual_labor_efficiency', {\n    name: 'Manual Labor Efficiency',\n    defaultValue: 1.,\n    minValue: 1.\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('job_learning_rate', {\n    name: 'Jobs Learning Rate',\n    defaultValue: 1.,\n    minValue: 1.\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('mental_activities_learn_rate', {\n    name: 'Mental Activities Learning Rate',\n    defaultValue: 1.,\n    minValue: 1.\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('crafting_efficiency', {\n    name: 'Crafting Efficiency',\n    defaultValue: 1.,\n    minValue: 1.\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('alchemy_efficiency', {\n    name: 'Alchemy Efficiency',\n    defaultValue: 1.,\n    minValue: 1.\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('learning_rate', {\n    name: 'Learning Rate',\n    defaultValue: 1.,\n    minValue: 1,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('walking_learning_rate', {\n    name: 'Walking Learning Rate',\n    defaultValue: 1.,\n    minValue: 1,\n    saveBalanceTree: true\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('shop_max_stock', {\n    name: 'Shop Max Sell Stock',\n    defaultValue: 100,\n    minValue: 100\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('prices_discount', {\n    name: 'Price Discount Multiplier',\n    defaultValue: 1,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('shop_stock_renew_rate', {\n    name: 'Sell Stock Renew Rate',\n    defaultValue: 1,\n    minValue: 1\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('guild_reputation_rate', {\n    name: 'Guild Reputation Rate',\n    defaultValue: 1,\n    minValue: 1\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/resources/common-effects-db.js?");

/***/ }),

/***/ "./src/worker/modules/resources/resource-pool.module.js":
/*!**************************************************************!*\
  !*** ./src/worker/modules/resources/resource-pool.module.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ResourcePoolModule: () => (/* binding */ ResourcePoolModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _inventory_inventory_items_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../inventory/inventory-items-db */ \"./src/worker/modules/inventory/inventory-items-db.js\");\n/* harmony import */ var _common_effects_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./common-effects-db */ \"./src/worker/modules/resources/common-effects-db.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar ResourcePoolModule = /*#__PURE__*/function (_GameModule) {\n  function ResourcePoolModule() {\n    var _this;\n    _classCallCheck(this, ResourcePoolModule);\n    _this = _callSuper(this, ResourcePoolModule);\n    _this.dragonLevel = 0;\n    _this.dragonPower = 0;\n    _this.eventHandler.registerHandler('query-resources-data', function () {\n      var data = _this.getResourcesData();\n      _this.eventHandler.sendData('resources-data', data);\n    });\n    _this.eventHandler.registerHandler('query-all-resources', function (payload) {\n      var data = Object.values(game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.resources);\n      var label = 'all-resources';\n      if (payload !== null && payload !== void 0 && payload.prefix) {\n        label = \"\".concat(label, \"-\").concat(payload === null || payload === void 0 ? void 0 : payload.prefix);\n      }\n      _this.eventHandler.sendData(label, data.map(function (one) {\n        return {\n          id: one.id,\n          name: one.name,\n          isCapped: one.isCapped,\n          isUnlocked: one.unlockCondition ? one.unlockCondition() : true\n        };\n      }));\n    });\n    return _this;\n  }\n  _inherits(ResourcePoolModule, _GameModule);\n  return _createClass(ResourcePoolModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      (0,_common_effects_db__WEBPACK_IMPORTED_MODULE_3__.registerCommomEffects)();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.registerEffect('coins_cap_bonus', {\n        name: 'Coins cap multiplier',\n        defaultValue: 1,\n        minValue: 1\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('energy', {\n        name: 'Energy',\n        hasCap: true,\n        tags: ['resource', 'energy', 'basic', 'vital'],\n        defaultCap: 0\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('health', {\n        name: 'Health',\n        hasCap: true,\n        tags: ['resource', 'health', 'basic', 'vital'],\n        defaultCap: 0,\n        unlockCondition: function unlockCondition() {\n          // console.log('ACTLVL: ', )\n          return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('action_pushup') > 1;\n        }\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('coins', {\n        name: 'Coins',\n        hasCap: true,\n        tags: ['resource', 'coins', 'basic'],\n        defaultCap: 2\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('knowledge', {\n        name: 'Knowledge',\n        hasCap: true,\n        tags: ['resource', 'basic', 'mental'],\n        defaultCap: 10,\n        unlockCondition: function unlockCondition() {\n          return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_library_entrance') > 0;\n        }\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('mana', {\n        name: 'Mana',\n        hasCap: true,\n        tags: ['resource', 'magical', 'mental'],\n        defaultCap: 10,\n        unlockCondition: function unlockCondition() {\n          return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_spellbook') > 0;\n        }\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('crafting_ability', {\n        tags: ['crafting', 'secondary'],\n        name: 'Crafting Effort',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('crafting_slots', {\n        tags: ['crafting', 'secondary'],\n        name: 'Crafting Slots',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('alchemy_ability', {\n        tags: ['alchemy', 'secondary'],\n        name: 'Alchemy Effort',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('alchemy_slots', {\n        tags: ['alchemy', 'secondary'],\n        name: 'Alchemy Slots',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('plantation_slots', {\n        tags: ['alchemy', 'secondary'],\n        name: 'Plantation Slots',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('gathering_effort', {\n        tags: ['exploration', 'secondary'],\n        name: 'Gathering Effort',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('gathering_perception', {\n        tags: ['exploration', 'secondary'],\n        name: 'Gathering Perception',\n        isService: true\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('rare_herbs_loot', {\n        tags: ['gathering', 'secondary'],\n        name: 'Rare Herbs',\n        isService: true,\n        isPercentage: true,\n        unlockCondition: function unlockCondition() {\n          return game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getLevel('shop_item_herbs_handbook_2') > 0;\n        }\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEffects.registerEffect('metabolism_rate', {\n        name: 'Consumable Cooldown Reduction',\n        defaultValue: 1,\n        minValue: 1\n      });\n      (0,_inventory_inventory_items_db__WEBPACK_IMPORTED_MODULE_2__.registerInventoryItems)();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('guild_reputation', {\n        name: 'Guild Reputation',\n        hasCap: true,\n        tags: ['guild', 'reputation'],\n        defaultCap: 0\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.registerResource('guild-points', {\n        name: 'Guild Points',\n        hasCap: true,\n        tags: ['guild', 'points'],\n        defaultCap: 0,\n        isService: true\n      });\n    }\n  }, {\n    key: \"tick\",\n    value: function tick() {}\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {};\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {}\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      var rs = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.listResourcesByTags(['resource', 'population'], true);\n      rs.forEach(function (r) {\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.setResource(r.id, 0);\n      });\n    }\n  }, {\n    key: \"getResourcesData\",\n    value: function getResourcesData() {\n      var rs = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.listResourcesByTags(['resource', 'population'], true);\n      // console.log('RS: ', JSON.stringify(rs.find(o => o.id === 'mana')));\n      return rs.filter(function (one) {\n        return one.isUnlocked;\n      }).map(function (resource) {\n        return _objectSpread(_objectSpread({}, resource), {}, {\n          isNegative: resource.balance < 0,\n          isCapped: resource.amount >= resource.cap,\n          eta: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.assertToCapOrEmpty(resource.id)\n          // affData: monitoredResources[resource.id] || undefined\n        });\n      });\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/resources/resource-pool.module.js?");

/***/ }),

/***/ "./src/worker/modules/social/guild-upgrades-db.js":
/*!********************************************************!*\
  !*** ./src/worker/modules/social/guild-upgrades-db.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerGuildUpgrades: () => (/* binding */ registerGuildUpgrades)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerGuildUpgrades = function registerGuildUpgrades() {\n  // merchants\n\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_merchant_codex', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Merchants Codex',\n    description: 'Learn merchants codex to be more efficient in selling your goods',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_merchants') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'shop_max_stock': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_golden_streams', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Golden Streams',\n    description: 'Enhance your income from all sources, ensuring a steady flow of wealth',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_merchants') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'coins': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_efficient_work', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Efficient Work Ethic',\n    description: 'Improve the learning speed for work-related actions, maximizing your productivity',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_merchants') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'job_learning_rate': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_hagglers_charm', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Hagglers Charm',\n    description: 'Lower prices in the shop, saving money on every purchase',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_merchants') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'prices_discount': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_vault_expansion', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Vault Expansion',\n    description: 'Raise the coin cap to store even more wealth safely',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_merchants') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'coins': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_treasury_overflow', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Treasury Overflow',\n    description: 'Boost both your coin cap and income, stacking with previous upgrades',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_merchants') > 9;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 3\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'coins': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      multiplier: {\n        resources: {\n          'coins': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n\n  // scholar\n\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_knowledge_seeker', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Knowledge Seeker',\n    description: 'Increase the amount of knowledge you gain from intellectual pursuits.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_scholars') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'knowledge': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_routine_mastery', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Routine Mastery',\n    description: 'Accelerate learning speed for routine tasks, making them less time-consuming',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_scholars') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'routine_learning_speed': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_mental_acumen', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Mental Acumen',\n    description: 'Enhance the learning speed of mental actions, sharpening your intellect',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_scholars') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'mental_training_learning_rate': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_physical_insight', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Physical Insight',\n    description: 'Boost the learning speed of physical actions, improving your body\\'s capabilities',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_scholars') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'physical_training_learn_speed': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_scholars_reservior', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Scholars Reservoir',\n    description: 'Increase the amount of knowledge you gain from intellectual pursuits',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_scholars') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'knowledge': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'knowledge': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_omniscient_growth', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Omniscient Growth',\n    description: 'Dramatically enhance the learning speed of all actions, unlocking your full potential',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_scholars') > 9;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 3\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'learning_rate': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n\n  // mages\n\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_mana_well', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Mana Well',\n    description: 'Expand your maximum mana reserves, enabling more powerful spells.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_mages') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      capMult: {\n        resources: {\n          'mana': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_spiritual_enlightenment', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Spiritual Enlightenment',\n    description: 'Increase the learning speed of spiritual actions, strengthening your magical prowess',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_mages') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'spiritual_learning_rate': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_arcane_expertise', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Arcane Expertise',\n    description: 'Boost the experience gained from casting spells, mastering the art of magic',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_mages') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'spell_xp_rate': {\n            A: 0.25,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_restorative_surge', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Restorative Surge',\n    description: 'Improve the effectiveness of healing magic, ensuring faster recovery',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_mages') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'restoration_spells_efficiency': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_illusionists_edge', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Illusionist\\'s Edge',\n    description: 'Enhance the potency of illusion spells, bending reality to your will',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_mages') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'illusion_spells_efficiency': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_mana_overflow', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Mana Overflow',\n    description: 'Increase both mana generation and its maximum capacity, channeling immense magical energy',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_mages') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 3\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'mana': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'mana': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n\n  // nature\n\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_alchemical_mastery', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Alchemical Mastery',\n    description: 'Increase the efficiency of the \\'Alchemy\\' action, creating more potent results',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_herbalists') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'alchemy_ability': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_green_fingers', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Green Fingers',\n    description: 'Boost the output of plantations, ensuring richer harvests of valuable plants',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_herbalists') > 0 && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('plantation_slots').income > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'plantations_efficiency': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_effortless_routine', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Effortless Routine',\n    description: 'Improve the learning speed of routine tasks, making them second nature',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_herbalists') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'routine_learning_speed': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_herbalists_insight', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Herbalist\\'s Insight',\n    description: 'Enhance the effectiveness of herb gathering, finding rarer and higher-quality plants',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_herbalists') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'gathering_efficiency': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_extra_alembic', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Extra Alembic',\n    description: 'Gain an additional alchemy slot to create more potions simultaneously',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_herbalists') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_potion_proficiency', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Potion Proficiency',\n    description: 'Brew additional potions for the same resource cost, maximizing your efficiency',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_herbalists') > 9;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 3\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'alchemy_efficiency': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n\n  // artisans\n\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_crafting_expertise', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Crafting Expertise',\n    description: 'Enhance the efficiency of crafting actions, allowing you to create items with greater precision and speed.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_artisans') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'crafting_ability': {\n            A: 0.1,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_endless_energy', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Endless Energy',\n    description: 'Boost your energy regeneration rate, ensuring you stay active for longer periods.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_artisans') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'energy': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_vital_recovery', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Vital Recovery',\n    description: 'Increase your health regeneration, keeping you in peak condition during challenging tasks.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_artisans') > 0;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 1\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'health': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_labour_efficiency', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Labour Efficiency',\n    description: 'Improve the effectiveness of manual labor tasks, such as gathering wood and mining stone, making each effort more productive.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_artisans') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'manual_labor_efficiency': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_physical_insight_2', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Physical Insight',\n    description: 'Accelerate learning from physical exercises, honing your body\\'s capabilities with each session.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_artisans') > 4;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 2\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'physical_training_learn_speed': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_upgrades_master_crafter', {\n    tags: [\"guild-upgrade\", \"purchaseable\"],\n    name: 'Master Crafter',\n    description: 'Significantly boost the efficiency of crafting, turning you into a true artisan of creation.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('guild_artisans') > 9;\n    },\n    attributes: {\n      isCollectable: false,\n      tier: 3\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'crafting_efficiency': {\n            A: 0.2,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'guild-points': {\n            A: 2,\n            B: 0,\n            type: 0\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild-points': {\n          A: 0,\n          B: 2,\n          type: 0\n        }\n      };\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/social/guild-upgrades-db.js?");

/***/ }),

/***/ "./src/worker/modules/social/guilds-db.js":
/*!************************************************!*\
  !*** ./src/worker/modules/social/guilds-db.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerGuilds: () => (/* binding */ registerGuilds)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar registerGuilds = function registerGuilds() {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_merchants_permanent', {\n    tags: [\"guild-bonus\", \"permanent\"],\n    name: 'Merchants Reputation',\n    description: '',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'coins': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'coins': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_merchants', {\n    tags: [\"guild\", \"purchaseable\"],\n    name: 'Merchants Guild',\n    description: 'Enter merchants guild to become better in understanding how to earn and invest your coins.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 500\n    }],\n    attributes: {\n      isCollectable: false,\n      icon_id: 'merchants_guild',\n      permaBonusId: 'guild_merchants_permanent'\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: -1,\n            type: 0,\n            min: 0\n          }\n        }\n      },\n      multiplier: {\n        resources: {\n          'coins': {\n            A: 0.04,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'coins': {\n            A: 0.04,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      rawCap: {\n        resources: {\n          'guild_reputation': {\n            A: 1.5,\n            B: 100,\n            C: -100,\n            type: 1\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild_reputation': {\n          A: 1.5,\n          B: 100,\n          C: -100,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_scholars_permanent', {\n    tags: [\"guild-bonus\", \"permanent\"],\n    name: 'Scholars Reputation',\n    description: '',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        effects: {\n          'learning_rate': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'knowledge': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_scholars', {\n    tags: [\"guild\", \"purchaseable\"],\n    name: 'Scholars Guild',\n    description: 'Become member of young scientists community.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 500\n    }],\n    attributes: {\n      isCollectable: false,\n      icon_id: 'scholars_guild',\n      permaBonusId: 'guild_scholars_permanent'\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: -1,\n            type: 0,\n            min: 0\n          }\n        }\n      },\n      multiplier: {\n        resources: {\n          'knowledge': {\n            A: 0.04,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'knowledge': {\n            A: 0.04,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      rawCap: {\n        resources: {\n          'guild_reputation': {\n            A: 1.5,\n            B: 100,\n            C: -100,\n            type: 1\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild_reputation': {\n          A: 1.5,\n          B: 100,\n          C: -100,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_mages_permanent', {\n    tags: [\"guild-bonus\", \"permanent\"],\n    name: 'Mages Reputation',\n    description: '',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'mana': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'mana': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_mages', {\n    tags: [\"guild\", \"purchaseable\"],\n    name: 'Mages Guild',\n    description: 'Become member of young scientists community.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 500\n    }],\n    attributes: {\n      isCollectable: false,\n      icon_id: 'mages_guild',\n      permaBonusId: 'guild_mages_permanent'\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: -1,\n            type: 0,\n            min: 0\n          }\n        }\n      },\n      multiplier: {\n        resources: {\n          'mana': {\n            A: 0.04,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      capMult: {\n        resources: {\n          'mana': {\n            A: 0.04,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      rawCap: {\n        resources: {\n          'guild_reputation': {\n            A: 1.5,\n            B: 100,\n            C: -100,\n            type: 1\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild_reputation': {\n          A: 1.5,\n          B: 100,\n          C: -100,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_herbalists_permanent', {\n    tags: [\"guild-bonus\", \"permanent\"],\n    name: 'Herbalists Reputation',\n    description: '',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'alchemy_ability': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        },\n        effects: {\n          'plantations_efficiency': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_herbalists', {\n    tags: [\"guild\", \"purchaseable\"],\n    name: 'Herbalists Guild',\n    description: 'Reveal new alchemy opportunities by entering cauldron masters community.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 500\n    }],\n    attributes: {\n      isCollectable: false,\n      icon_id: 'herbalists_guild',\n      permaBonusId: 'guild_herbalists_permanent'\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: -1,\n            type: 0,\n            min: 0\n          }\n        }\n      },\n      multiplier: {\n        resources: {\n          'alchemy_ability': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        },\n        effects: {\n          'gathering_efficiency': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      rawCap: {\n        resources: {\n          'guild_reputation': {\n            A: 1.5,\n            B: 100,\n            C: -100,\n            type: 1\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild_reputation': {\n          A: 1.5,\n          B: 100,\n          C: -100,\n          type: 1\n        }\n      };\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_artisans_permanent', {\n    tags: [\"guild-bonus\", \"permanent\"],\n    name: 'Artisans Reputation',\n    description: '',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      isCollectable: false\n    },\n    resourceModifier: {\n      multiplier: {\n        resources: {\n          'crafting_ability': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        },\n        effects: {\n          'manual_labor_efficiency': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      }\n    }\n  });\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity('guild_artisans', {\n    tags: [\"guild\", \"purchaseable\"],\n    name: 'Artisans Guild',\n    description: 'The Artisans Guild is a sanctuary of creativity and innovation, where members craft exquisite items and enhance their own bodies through artful modifications and enchanted designs. From intricate jewelry to empowered prosthetics, they blend beauty and functionality in everything they create. This guild embodies the pursuit of perfection in both craft and self-expression.',\n    level: 0,\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    unlockedBy: [{\n      type: 'effect',\n      id: 'attribute_charisma',\n      level: 500\n    }],\n    attributes: {\n      isCollectable: false,\n      icon_id: 'artisans_guild',\n      permaBonusId: 'guild_artisans_permanent'\n    },\n    resourceModifier: {\n      income: {\n        resources: {\n          'guild-points': {\n            A: 1,\n            B: -1,\n            type: 0,\n            min: 0\n          }\n        }\n      },\n      multiplier: {\n        resources: {\n          'crafting_ability': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        },\n        effects: {\n          'manual_labor_efficiency': {\n            A: 0.05,\n            B: 1,\n            type: 0\n          }\n        }\n      },\n      rawCap: {\n        resources: {\n          'guild_reputation': {\n            A: 1.5,\n            B: 100,\n            C: -100,\n            type: 1\n          }\n        }\n      }\n    },\n    get_cost: function get_cost() {\n      return {\n        'guild_reputation': {\n          A: 1.5,\n          B: 100,\n          C: -100,\n          type: 1\n        }\n      };\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/social/guilds-db.js?");

/***/ }),

/***/ "./src/worker/modules/social/guilds.module.js":
/*!****************************************************!*\
  !*** ./src/worker/modules/social/guilds.module.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GuildsModule: () => (/* binding */ GuildsModule)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _guilds_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./guilds-db */ \"./src/worker/modules/social/guilds-db.js\");\n/* harmony import */ var _guild_upgrades_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./guild-upgrades-db */ \"./src/worker/modules/social/guild-upgrades-db.js\");\n/* harmony import */ var _shared_utils_objects__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/utils/objects */ \"./src/worker/shared/utils/objects.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\n\nvar GuildsModule = /*#__PURE__*/function (_GameModule) {\n  function GuildsModule() {\n    var _this;\n    _classCallCheck(this, GuildsModule);\n    _this = _callSuper(this, GuildsModule);\n    _this.purchasedUpgrades = {};\n    _this.guildsStats = {};\n    _this.selectedGuild = null;\n    _this.leveledId = null;\n    _this.eventHandler.registerHandler('select-guild', function (payload) {\n      _this.selectGuild(payload.id);\n    });\n    _this.eventHandler.registerHandler('leave-guild', function (payload) {\n      _this.leaveGuild(payload.id);\n    });\n    _this.eventHandler.registerHandler('purchase-guild-item', function (payload) {\n      _this.purchaseItem(payload.id);\n    });\n    _this.eventHandler.registerHandler('query-guild-items-data', function (payload) {\n      _this.sendItemsData();\n    });\n    _this.eventHandler.registerHandler('query-guild-item-details', function (payload) {\n      _this.sendItemDetails(payload.id, payload.meta);\n    });\n    return _this;\n  }\n  _inherits(GuildsModule, _GameModule);\n  return _createClass(GuildsModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      (0,_guilds_db__WEBPACK_IMPORTED_MODULE_2__.registerGuilds)();\n      (0,_guild_upgrades_db__WEBPACK_IMPORTED_MODULE_3__.registerGuildUpgrades)();\n    }\n  }, {\n    key: \"leaveGuild\",\n    value: function leaveGuild() {\n      if (!this.selectedGuild) {\n        return;\n      }\n      //\n      if (!this.guildsStats) {\n        this.guildsStats = {};\n      }\n      if (!this.guildsStats[this.selectedGuild]) {\n        this.guildsStats[this.selectedGuild] = {\n          maxLevel: 0\n        };\n      }\n      this.guildsStats[this.selectedGuild].maxLevel = Math.max(this.guildsStats[this.selectedGuild].maxLevel, game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(this.selectedGuild));\n      for (var key in this.purchasedUpgrades) {\n        this.setItem(key, 0, true);\n      }\n      this.purchasedUpgrades = {};\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(this.selectedGuild, 0, true);\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.setResource('guild_reputation', 0);\n      /*gameEntity.listEntitiesByTags(['action', 'guild-activity']).map(a => {\n          gameCore.getModule('actions').setAction(a.id, 1, true);\n          if(gameCore.getModule('actions').actions[a.id]) {\n              gameCore.getModule('actions').actions[a.id].xp = 0;\n          }\n      })*/\n      this.setPermaBonus(this.selectedGuild, this.guildsStats[this.selectedGuild].maxLevel, true);\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').generateNotifications();\n\n      // handle perma guild bonus\n      this.selectedGuild = null;\n    }\n  }, {\n    key: \"selectGuild\",\n    value: function selectGuild(id) {\n      this.selectedGuild = id;\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(this.selectedGuild, 1, true);\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').generateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.setResource('guild_reputation', 0);\n    }\n  }, {\n    key: \"getPotentialPermaLevel\",\n    value: function getPotentialPermaLevel(id) {\n      var cl = this.selectedGuild === id ? game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(this.selectedGuild) : this.guildsStats[id].maxLevel;\n      return Math.max(0, cl - 1);\n    }\n  }, {\n    key: \"getCurrentPermaLevel\",\n    value: function getCurrentPermaLevel(id) {\n      var _this$guildsStats$id;\n      var cl = ((_this$guildsStats$id = this.guildsStats[id]) === null || _this$guildsStats$id === void 0 ? void 0 : _this$guildsStats$id.maxLevel) || 0;\n      return Math.max(0, cl - 1);\n    }\n  }, {\n    key: \"getCurrentActualPermaLevel\",\n    value: function getCurrentActualPermaLevel(id) {\n      var ent = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAttribute(id, 'permaBonusId');\n      var relLevel = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(ent);\n      return relLevel;\n    }\n  }, {\n    key: \"setPermaBonus\",\n    value: function setPermaBonus(id, level) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var ent = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAttribute(id, 'permaBonusId');\n      console.log('Setting: ', id, ent, level);\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(ent, level, bForce);\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      this.leveledId = null;\n      if (!this.selectedGuild) return;\n      var guild = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(this.selectedGuild);\n      var rs = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('guild_reputation');\n      if (rs.amount >= rs.cap) {\n        var rslt = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.levelUpEntity(this.selectedGuild);\n        // gameResources.addResource('guild-points', 1);\n        this.isLeveledUp = true;\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').setViewedById(\"guild_leveled\", false);\n        // const data = this.getMageData();\n        // this.eventHandler.sendData('mage-data', data);\n      }\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        selectedGuild: this.selectedGuild,\n        guildLevel: this.selectedGuild ? game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(this.selectedGuild) : 0,\n        purchasedUpgrades: this.purchasedUpgrades,\n        guildsStats: this.guildsStats\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      if (this.selectedGuild) {\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(this.selectedGuild, 0, true);\n      }\n      this.selectedGuild = obj === null || obj === void 0 ? void 0 : obj.selectedGuild;\n      if (this.selectedGuild) {\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(this.selectedGuild, obj === null || obj === void 0 ? void 0 : obj.guildLevel);\n      }\n      for (var key in this.purchasedUpgrades) {\n        this.setItem(key, 0, true);\n      }\n      this.purchasedUpgrades = {};\n      if (obj !== null && obj !== void 0 && obj.purchasedUpgrades) {\n        for (var id in obj.purchasedUpgrades) {\n          this.setItem(id, obj.purchasedUpgrades[id], true);\n        }\n      }\n      if (this.guildsStats) {\n        for (var _key in this.guildsStats) {\n          this.guildsStats[_key].maxLevel = 0;\n          this.setPermaBonus(_key, 0, true);\n        }\n      }\n      if (obj !== null && obj !== void 0 && obj.guildsStats) {\n        this.guildsStats = obj === null || obj === void 0 ? void 0 : obj.guildsStats;\n        for (var _key2 in this.guildsStats) {\n          this.setPermaBonus(_key2, this.getCurrentPermaLevel(_key2), true);\n        }\n      }\n      this.sendItemsData();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.load({});\n    }\n  }, {\n    key: \"setItem\",\n    value: function setItem(itemId, amount) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(itemId, amount, bForce);\n      this.purchasedUpgrades[itemId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(itemId);\n    }\n  }, {\n    key: \"purchaseItem\",\n    value: function purchaseItem(itemId) {\n      var newEnt = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.levelUpEntity(itemId);\n      console.log('Purchase Guild Upgrade: ', newEnt);\n      if (newEnt.success) {\n        this.purchasedUpgrades[itemId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(itemId);\n        this.leveledId = itemId;\n        this.sendItemsData();\n      }\n      return newEnt.success;\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('social', 'guilds', \"no_guild_selected\", !this.selectedGuild);\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('social', 'guilds', \"guild_leveled\", this.selectedGuild && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(this.selectedGuild) > 0);\n    }\n  }, {\n    key: \"getItemsData\",\n    value: function getItemsData() {\n      var _this2 = this,\n        _this$guildsStats$thi;\n      var guilds = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['guild']).map(function (one) {\n        return _objectSpread(_objectSpread({}, one), {}, {\n          icon_id: one.attributes.icon_id\n        });\n      });\n      var current = this.selectedGuild ? guilds.find(function (g) {\n        return g.id === _this2.selectedGuild;\n      }) : undefined;\n      var upgrades = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['guild-upgrade']);\n      var cLv = this.selectedGuild ? game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(this.selectedGuild) : 0;\n      return {\n        guilds: guilds,\n        current: current,\n        availableUpgrades: upgrades.filter(function (one) {\n          return one.isUnlocked && !one.isCapped;\n        }).map(function (entity) {\n          return {\n            id: entity.id,\n            name: entity.name,\n            description: entity.description,\n            max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n            level: _this2.purchasedUpgrades[entity.id] || 0,\n            affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n            potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n            isLeveled: _this2.leveledId === entity.id,\n            tier: entity.attributes.tier\n          };\n        }).reduce(function (acc, upgrade) {\n          // Check if the tier already exists in the accumulator\n          if (!acc[upgrade.tier - 1]) {\n            acc[upgrade.tier - 1] = []; // Initialize the tier as an empty array\n          }\n          acc[upgrade.tier - 1].push(upgrade); // Add the upgrade to the corresponding tier\n          return acc;\n        }, {\n          0: [],\n          1: [],\n          2: []\n        }),\n        tierUnlocks: [1, 5, 10].map(function (c) {\n          return {\n            isUnlocked: c <= cLv,\n            level: c\n          };\n        }),\n        points: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('guild-points'),\n        reputation: _objectSpread(_objectSpread({}, game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('guild_reputation')), {}, {\n          eta: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.assertToCapOrEmpty('guild_reputation')\n        }),\n        maxLevel: this.selectedGuild ? ((_this$guildsStats$thi = this.guildsStats[this.selectedGuild]) === null || _this$guildsStats$thi === void 0 ? void 0 : _this$guildsStats$thi.maxLevel) || 1 : 1,\n        prestige: this.selectedGuild ? {\n          canPrestige: this.getPotentialPermaLevel(this.selectedGuild) > this.getCurrentActualPermaLevel(this.selectedGuild),\n          currentEffects: (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_4__.packEffects)(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(current.attributes.permaBonusId)),\n          potentialEffects: (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_4__.packEffects)(game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(current.attributes.permaBonusId, 0, this.getPotentialPermaLevel(this.selectedGuild)))\n        } : null\n      };\n    }\n  }, {\n    key: \"sendItemsData\",\n    value: function sendItemsData() {\n      var data = this.getItemsData();\n      this.eventHandler.sendData('guild-items-data', data);\n    }\n  }, {\n    key: \"getItemDetails\",\n    value: function getItemDetails(id, meta) {\n      if (!id) return null;\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(id);\n      return {\n        id: entity.id,\n        name: entity.name,\n        description: entity.description,\n        max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n        level: this.purchasedUpgrades[entity.id] || 0,\n        affordable: meta === 'guild' ? undefined : game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n        potentialEffects: meta === 'guild' ? undefined : game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n        effects: meta === 'guild' ? game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1).filter(function (one) {\n          return one.id !== 'guild_reputation';\n        }) : undefined,\n        currentEffects: meta === 'guild' ? undefined : game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id),\n        tags: entity.tags,\n        purchaseMultiplier: 1\n      };\n    }\n  }, {\n    key: \"sendItemDetails\",\n    value: function sendItemDetails(id, meta) {\n      var data = this.getItemDetails(id, meta);\n      this.eventHandler.sendData('guild-item-details', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_1__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/social/guilds.module.js?");

/***/ }),

/***/ "./src/worker/modules/workshop/crafting-lists.submodule.js":
/*!*****************************************************************!*\
  !*** ./src/worker/modules/workshop/crafting-lists.submodule.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CraftingListsSubmodule: () => (/* binding */ CraftingListsSubmodule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/utils/rule-utils */ \"./src/worker/shared/utils/rule-utils.js\");\n/* harmony import */ var _shared_utils_objects__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/utils/objects */ \"./src/worker/shared/utils/objects.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _createForOfIteratorHelper(r, e) { var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t[\"return\"] || t[\"return\"](); } finally { if (u) throw o; } } }; }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\nvar CraftingListsSubmodule = /*#__PURE__*/function (_GameModule) {\n  function CraftingListsSubmodule() {\n    var _this;\n    _classCallCheck(this, CraftingListsSubmodule);\n    _this = _callSuper(this, CraftingListsSubmodule);\n    _this.craftingLists = {};\n    _this.runningList = {\n      crafting: null,\n      alchemy: null\n    };\n    _this.listsAutotrigger = {\n      crafting: [],\n      alchemy: []\n    };\n    _this.autotriggerCD = {\n      crafting: 0,\n      alchemy: 0\n    };\n    _this.automationEnabled = {\n      crafting: false,\n      alchemy: false\n    };\n    _this.combineLists = true;\n    _this.autotriggerIntervalSetting = {\n      crafting: 10,\n      alchemy: 10\n    };\n    _this.eventHandler.registerHandler('save-crafting-list', function (payload) {\n      _this.saveCraftingList(payload);\n    });\n    _this.eventHandler.registerHandler('delete-crafting-list', function (_ref) {\n      var id = _ref.id;\n      _this.deleteCraftingList(id);\n    });\n    _this.eventHandler.registerHandler('load-crafting-list', function (_ref2) {\n      var id = _ref2.id;\n      _this.sendListData(id);\n    });\n    _this.eventHandler.registerHandler('query-crafting-lists', function (pl) {\n      var lists = _this.getLists(pl);\n      var label = 'crafting-lists';\n      if (pl.category) {\n        label = \"\".concat(label, \"-\").concat(pl.category);\n      }\n      if (pl.prefix) {\n        label = \"\".concat(label, \"-\").concat(pl.prefix);\n      }\n      _this.eventHandler.sendData(label, lists);\n    });\n    _this.eventHandler.registerHandler('run-crafting-list', function (_ref3) {\n      var id = _ref3.id;\n      console.log('Running List: ', id);\n      _this.runList(id);\n    });\n    _this.eventHandler.registerHandler('stop-crafting-list', function (_ref4) {\n      var category = _ref4.category;\n      _this.stopList(category);\n    });\n    _this.eventHandler.registerHandler('set-crafting-automation-enabled', function (_ref5) {\n      var category = _ref5.category,\n        flag = _ref5.flag;\n      _this.automationEnabled[category] = !!flag;\n    });\n    _this.eventHandler.registerHandler('set-crafting-autotrigger-interval', function (_ref6) {\n      var category = _ref6.category,\n        interval = _ref6.interval;\n      _this.autotriggerIntervalSetting[category] = interval;\n    });\n    _this.eventHandler.registerHandler('query-crafting-list-effects', function (_ref7) {\n      var id = _ref7.id,\n        listData = _ref7.listData;\n      var data = _this.getListEffects(null, listData);\n      var prevEffects = [];\n      var resourcesEffects = _this.packEffects(data.filter(function (one) {\n        return one.type === 'resources';\n      }).map(function (effect) {\n        var prev = game_framework__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.assertResource(effect.id, false, ['running']);\n        if (effect.scope !== 'income' && effect.scope !== 'consumption') return effect;\n        var pScope = effect.scope === 'consumption' ? 'income' : effect.scope;\n        var nPrv = _objectSpread(_objectSpread({}, effect), {}, {\n          scope: pScope,\n          value: prev.balance\n        });\n        if (nPrv.value < 0) {\n          nPrv.value = Math.abs(nPrv.value);\n          nPrv.scope = 'consumption';\n        }\n        prevEffects.push(nPrv);\n        var newVal = (effect.scope === 'income' ? effect.value : -effect.value) + prev.balance;\n        var nScope = newVal > 0 ? 'income' : 'consumption';\n        return _objectSpread(_objectSpread({}, effect), {}, {\n          value: Math.abs(newVal),\n          scope: nScope\n        });\n      }));\n      console.log('SendingData: ', JSON.stringify(data.prevEffects), JSON.stringify(data.resourcesEffects), data, id);\n      _this.eventHandler.sendData('crafting-list-effects', {\n        potentialEffects: data,\n        resourcesEffects: resourcesEffects,\n        prevEffects: _this.packEffects(prevEffects),\n        effectEffects: data.filter(function (one) {\n          return one.type === 'effects';\n        })\n      });\n    });\n    return _this;\n  }\n  _inherits(CraftingListsSubmodule, _GameModule);\n  return _createClass(CraftingListsSubmodule, [{\n    key: \"runList\",\n    value: function runList(id, cat) {\n      var _cat;\n      if (!id) {\n        if (!cat) {\n          cat = this.craftingLists[id].category;\n        }\n        this.stopList(cat);\n        return;\n      }\n      var category = (_cat = cat) !== null && _cat !== void 0 ? _cat : this.craftingLists[id].category;\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('crafting').stopAllCrafting(category);\n      if (!this.runningList) {\n        this.runningList = {};\n      }\n      this.runningList[category] = {\n        id: id,\n        name: this.craftingLists[id].name,\n        actionIndex: 0,\n        actionTimer: 0\n      };\n      var distributions = this.getRealListLevelsDistribution(id);\n      distributions.forEach(function (item) {\n        game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('crafting').setCraftingLevel({\n          id: item.id,\n          level: item.level,\n          isForce: true\n        });\n      });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('crafting').sendCraftingData({\n        filterId: this.craftingLists[id].category\n      });\n    }\n  }, {\n    key: \"stopList\",\n    value: function stopList(category) {\n      this.runningList[category] = null;\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('crafting').stopAllCrafting(category);\n    }\n  }, {\n    key: \"saveCraftingList\",\n    value: function saveCraftingList(payload) {\n      var _this$runningList, _this$runningList$cat;\n      var isNew = !payload.id;\n      var list = _objectSpread({}, payload);\n      delete list['isReopenEdit'];\n      var isReopenEdit = payload.isReopenEdit;\n      if (!list.id) {\n        list.id = \"\".concat(Math.random() * 1000000);\n      }\n      this.craftingLists[list.id] = list;\n      if (isReopenEdit) {\n        this.sendListData(list.id, true);\n      }\n      console.log('SavingList: ', list, this.craftingLists);\n      this.regenerateListsPriorityMap();\n      var category = list.category;\n      if ((_this$runningList = this.runningList) !== null && _this$runningList !== void 0 && (_this$runningList = _this$runningList[category]) !== null && _this$runningList !== void 0 && _this$runningList.id && ((_this$runningList$cat = this.runningList[category]) === null || _this$runningList$cat === void 0 ? void 0 : _this$runningList$cat.id) === payload.id) {\n        this.stopList(category);\n        this.runList(payload.id, category);\n      }\n    }\n  }, {\n    key: \"deleteCraftingList\",\n    value: function deleteCraftingList(id) {\n      delete this.craftingLists[id];\n      this.regenerateListsPriorityMap();\n    }\n  }, {\n    key: \"regenerateListsPriorityMap\",\n    value: function regenerateListsPriorityMap() {\n      var listsBeingAutotrigger = Object.values(this.craftingLists).filter(function (one) {\n        var _one$autotrigger;\n        return !!((_one$autotrigger = one.autotrigger) !== null && _one$autotrigger !== void 0 && (_one$autotrigger = _one$autotrigger.rules) !== null && _one$autotrigger !== void 0 && _one$autotrigger.length);\n      });\n      this.listsAutotrigger = {\n        crafting: listsBeingAutotrigger.filter(function (one) {\n          return one.category === 'crafting';\n        }).map(function (one) {\n          var _one$autotrigger$prio;\n          return {\n            id: one.id,\n            priority: (_one$autotrigger$prio = one.autotrigger.priority) !== null && _one$autotrigger$prio !== void 0 ? _one$autotrigger$prio : 0\n          };\n        }).sort(function (a, b) {\n          return a.priority - b.priority;\n        }),\n        alchemy: listsBeingAutotrigger.filter(function (one) {\n          return one.category === 'alchemy';\n        }).map(function (one) {\n          var _one$autotrigger$prio2;\n          return {\n            id: one.id,\n            priority: (_one$autotrigger$prio2 = one.autotrigger.priority) !== null && _one$autotrigger$prio2 !== void 0 ? _one$autotrigger$prio2 : 0\n          };\n        }).sort(function (a, b) {\n          return a.priority - b.priority;\n        })\n      };\n    }\n  }, {\n    key: \"getLists\",\n    value: function getLists(pl) {\n      var _this$runningList$pl$;\n      var ls = Object.values(this.craftingLists).filter(function (one) {\n        return one.category === pl.category;\n      }).map(function (one) {\n        return _objectSpread(_objectSpread({}, one), {}, {\n          isUnlocked: true\n        });\n      });\n      if (pl !== null && pl !== void 0 && pl.filterAutomated) {\n        ls = ls.filter(function (one) {\n          var _one$autotrigger2;\n          return (_one$autotrigger2 = one.autotrigger) === null || _one$autotrigger2 === void 0 || (_one$autotrigger2 = _one$autotrigger2.rules) === null || _one$autotrigger2 === void 0 ? void 0 : _one$autotrigger2.length;\n        });\n      }\n      return {\n        lists: ls,\n        runningList: (_this$runningList$pl$ = this.runningList[pl.category]) !== null && _this$runningList$pl$ !== void 0 && _this$runningList$pl$.id ? this.craftingLists[this.runningList[pl.category].id] : null,\n        automationEnabled: this.automationEnabled[pl.category],\n        autotriggerIntervalSetting: this.autotriggerIntervalSetting[pl.category]\n      };\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        list: (0,_shared_utils_objects__WEBPACK_IMPORTED_MODULE_3__.mapObject)(this.craftingLists, function (one) {\n          return {\n            id: one.id,\n            name: one.name,\n            recipes: one.recipes,\n            autotrigger: one.autotrigger,\n            category: one.category\n          };\n        }),\n        runningList: this.runningList,\n        automationEnabled: this.automationEnabled,\n        autotriggerIntervalSetting: this.autotriggerIntervalSetting\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      var _obj$list, _obj$runningList;\n      this.craftingLists = (_obj$list = obj === null || obj === void 0 ? void 0 : obj.list) !== null && _obj$list !== void 0 ? _obj$list : [];\n      this.runningList = (_obj$runningList = obj === null || obj === void 0 ? void 0 : obj.runningList) !== null && _obj$runningList !== void 0 ? _obj$runningList : {};\n      this.automationEnabled = obj === null || obj === void 0 ? void 0 : obj.automationEnabled;\n      this.autotriggerIntervalSetting = (obj === null || obj === void 0 ? void 0 : obj.autotriggerIntervalSetting) || 10;\n      this.regenerateListsPriorityMap();\n    }\n  }, {\n    key: \"getAutotriggerList\",\n    value: function getAutotriggerList(cat) {\n      var _iterator = _createForOfIteratorHelper(this.listsAutotrigger[cat]),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _this$craftingLists$l, _this$craftingLists$l2;\n          var list = _step.value;\n          if ((0,_shared_utils_rule_utils__WEBPACK_IMPORTED_MODULE_2__.checkMatchingRules)((_this$craftingLists$l = this.craftingLists[list.id]) === null || _this$craftingLists$l === void 0 || (_this$craftingLists$l = _this$craftingLists$l.autotrigger) === null || _this$craftingLists$l === void 0 ? void 0 : _this$craftingLists$l.rules, (_this$craftingLists$l2 = this.craftingLists[list.id]) === null || _this$craftingLists$l2 === void 0 || (_this$craftingLists$l2 = _this$craftingLists$l2.autotrigger) === null || _this$craftingLists$l2 === void 0 ? void 0 : _this$craftingLists$l2.pattern)) {\n            return list.id;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return null;\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      var _this2 = this;\n      // Here we checking autotrigger\n      ['crafting', 'alchemy'].forEach(function (cat) {\n        if (!_this2.autotriggerCD) {\n          _this2.autotriggerCD = {\n            alchemy: 0,\n            crafting: 0\n          };\n        }\n        if (_this2.automationEnabled[cat] && _this2.listsAutotrigger[cat].length && _this2.autotriggerCD[cat] <= 0) {\n          var _this2$runningList$ca;\n          _this2.autotriggerCD[cat] = _this2.autotriggerIntervalSetting[cat] || 10;\n          var autotrigger = _this2.getAutotriggerList(cat);\n          if (autotrigger && ((_this2$runningList$ca = _this2.runningList[cat]) === null || _this2$runningList$ca === void 0 ? void 0 : _this2$runningList$ca.id) !== autotrigger) {\n            var _this2$runningList$ca2;\n            console.log('Run list autotrigger: ', autotrigger, (_this2$runningList$ca2 = _this2.runningList[cat]) === null || _this2$runningList$ca2 === void 0 ? void 0 : _this2$runningList$ca2.id, _this2.listsAutotrigger);\n            _this2.runList(autotrigger, cat);\n          }\n        }\n        _this2.autotriggerCD[cat] -= delta;\n      });\n    }\n  }, {\n    key: \"packEffects\",\n    value: function packEffects(effects) {\n      var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (item) {\n        return true;\n      };\n      var result = effects.filter(filter).reduce(function (acc, item) {\n        acc[item.id] = item;\n        return acc;\n      }, {});\n      return result;\n    }\n  }, {\n    key: \"sendListData\",\n    value: function sendListData(id) {\n      var bForceOpen = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var data = this.craftingLists[id];\n      data.recipes = (data.recipes || []).map(function (a) {\n        return _objectSpread(_objectSpread({}, a), {}, {\n          isAvailable: game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isEntityUnlocked(a.id) && !game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.isCapped(a.id)\n        });\n      });\n      data.potentialEffects = this.getListEffects(id);\n      var resourcesEffects = data.potentialEffects.filter(function (one) {\n        return one.type === 'resources';\n      });\n      data.effectEffects = data.potentialEffects.filter(function (one) {\n        return one.type === 'effects';\n      });\n      var prevEffects = [];\n      data.resourcesEffects = this.packEffects(resourcesEffects.map(function (effect) {\n        var prev = game_framework__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.assertResource(effect.id, false, ['running']);\n        if (effect.scope !== 'income' && effect.scope !== 'consumption') return effect;\n        var pScope = effect.scope === 'consumption' ? 'income' : effect.scope;\n        var nPrv = _objectSpread(_objectSpread({}, effect), {}, {\n          scope: pScope,\n          value: prev.balance\n        });\n        if (nPrv.value < 0) {\n          nPrv.value = Math.abs(nPrv.value);\n          nPrv.scope = 'consumption';\n        }\n        console.log('Prv2: ', prev, effect, nPrv);\n        prevEffects.push(nPrv);\n        var newVal = (effect.scope === 'income' ? effect.value : -effect.value) + prev.balance;\n        var nScope = newVal > 0 ? 'income' : 'consumption';\n        return _objectSpread(_objectSpread({}, effect), {}, {\n          value: Math.abs(newVal),\n          scope: nScope\n        });\n      }));\n      data.prevEffects = this.packEffects(prevEffects);\n      data.bForceOpen = bForceOpen;\n\n      // console.log('SendingData: ', JSON.stringify(data.prevEffects), JSON.stringify(data.resourcesEffects));\n\n      this.eventHandler.sendData('crafting-list-data', data);\n    }\n  }, {\n    key: \"getRealListLevelsDistribution\",\n    value: function getRealListLevelsDistribution(id, listData) {\n      var list = id ? this.craftingLists[id] : _objectSpread({}, listData);\n      var maxSlots = 0;\n      var possibleEntities = [];\n      if (list.category === 'crafting') {\n        maxSlots = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('crafting_slots').income;\n        possibleEntities = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.listEntitiesByTags(['crafting', 'material']);\n      }\n      if (list.category === 'alchemy') {\n        maxSlots = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource('alchemy_slots').income;\n        possibleEntities = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.listEntitiesByTags(['crafting', 'alchemy']);\n      }\n      if (!maxSlots || !possibleEntities) return [];\n      var distribution = list === null || list === void 0 ? void 0 : list.recipes;\n      if (!distribution) return [];\n      var possibleIds = new Set(possibleEntities.map(function (_ref8) {\n        var id = _ref8.id;\n        return id;\n      }));\n\n      // Filter valid distribution entries and normalize percentages\n      var validDistribution = distribution.filter(function (_ref9) {\n        var id = _ref9.id;\n        return possibleIds.has(id);\n      }).map(function (entry) {\n        return _objectSpread(_objectSpread({}, entry), {}, {\n          percentage: entry.percentage / distribution.reduce(function (sum, _ref10) {\n            var percentage = _ref10.percentage;\n            return sum + percentage;\n          }, 0)\n        });\n      });\n      var remainingSlots = maxSlots;\n      var result = [];\n\n      // First pass: Allocate minimum slots\n      var _iterator2 = _createForOfIteratorHelper(validDistribution),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var entry = _step2.value;\n          var _id = entry.id,\n            min = entry.min;\n          var allocated = Math.min(min, remainingSlots);\n          result.push({\n            id: _id,\n            level: allocated\n          });\n          remainingSlots -= allocated;\n        }\n\n        // Second pass: Allocate slots based on percentage and constraints\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      var _loop = function _loop() {\n        var entry = _result[_i];\n        if (remainingSlots <= 0) return 1; // break\n        var original = validDistribution.find(function (_ref11) {\n          var id = _ref11.id;\n          return id === entry.id;\n        });\n        var max = original.max,\n          percentage = original.percentage;\n        var currentLevel = entry.level;\n        var additional = Math.min(Math.floor(remainingSlots * percentage), max ? max - currentLevel : 1.e+100, remainingSlots);\n        entry.level += additional;\n        remainingSlots -= additional;\n      };\n      for (var _i = 0, _result = result; _i < _result.length; _i++) {\n        if (_loop()) break;\n      }\n\n      // Third pass: Distribute remaining slots to entries that can accept more\n      var _loop2 = function _loop2() {\n        var entry = _result2[_i2];\n        if (remainingSlots <= 0) return 1; // break\n        var original = validDistribution.find(function (_ref12) {\n          var id = _ref12.id;\n          return id === entry.id;\n        });\n        var max = original.max;\n        var additional = remainingSlots;\n        if (max) {\n          additional = Math.min(max - entry.level, remainingSlots);\n        }\n        entry.level += additional;\n        remainingSlots -= additional;\n      };\n      for (var _i2 = 0, _result2 = result; _i2 < _result2.length; _i2++) {\n        if (_loop2()) break;\n      }\n      result = result.filter(function (one) {\n        return one.level > 0;\n      });\n      console.log('distributed: ', maxSlots, result);\n      return result;\n    }\n  }, {\n    key: \"getListEffects\",\n    value: function getListEffects(id, listData) {\n      var list = this.craftingLists[id];\n      if (!list) {\n        if (!listData) {\n          throw new Error(\"List with id \".concat(id, \" not found\"));\n        }\n        list = listData;\n      }\n      var assumedDistribution = this.getRealListLevelsDistribution(id, listData);\n      var totalEffects = [];\n\n      // attempt to get effects for every item according to distributions\n      assumedDistribution.forEach(function (distribution) {\n        var effects = game_framework__WEBPACK_IMPORTED_MODULE_1__.gameEntity.getEffects(distribution.id, 0, distribution.level, true);\n        effects.forEach(function (effToAdd) {\n          var foundId = totalEffects.findIndex(function (a) {\n            return a.id === effToAdd.id && (a.scope === effToAdd.scope || ['income', 'consumption'].includes(a.scope) && ['income', 'consumption'].includes(effToAdd.scope));\n          });\n          if (effToAdd.scope === 'income' && effToAdd.type === 'resources') {\n            effToAdd.value *= game_framework__WEBPACK_IMPORTED_MODULE_1__.gameResources.getResource(effToAdd.id).multiplier;\n          }\n          if (effToAdd.scope === 'multiplier' && effToAdd.type === 'effects') {\n            // we actually adding multiplier\n            effToAdd.value *= learnRateFactor;\n          }\n          if (effToAdd.scope === 'income' && effToAdd.type === 'effects') {\n            effToAdd.value *= learnRateFactor;\n          }\n          if (foundId < 0) {\n            totalEffects.push(effToAdd);\n          } else {\n            if (totalEffects[foundId].scope === 'consumption') {\n              totalEffects[foundId].scope = 'income';\n              totalEffects[foundId].value = -totalEffects[foundId].value;\n            }\n            if (effToAdd.scope === 'consumption') {\n              totalEffects[foundId].value -= effToAdd.value;\n            } else {\n              totalEffects[foundId].value += effToAdd.value;\n            }\n          }\n        });\n      });\n      return totalEffects.map(function (eff) {\n        return eff.scope === 'income' && eff.value < 0 ? _objectSpread(_objectSpread({}, eff), {}, {\n          scope: 'consumption',\n          value: -eff.value\n        }) : eff;\n      });\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/workshop/crafting-lists.submodule.js?");

/***/ }),

/***/ "./src/worker/modules/workshop/crafting.module.js":
/*!********************************************************!*\
  !*** ./src/worker/modules/workshop/crafting.module.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CraftingModule: () => (/* binding */ CraftingModule)\n/* harmony export */ });\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _recipes_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./recipes-db */ \"./src/worker/modules/workshop/recipes-db.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _crafting_lists_submodule__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./crafting-lists.submodule */ \"./src/worker/modules/workshop/crafting-lists.submodule.js\");\n/* harmony import */ var game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! game-framework/src/utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\n\n\nvar CraftingModule = /*#__PURE__*/function (_GameModule) {\n  function CraftingModule(props) {\n    var _this;\n    _classCallCheck(this, CraftingModule);\n    _this = _callSuper(this, CraftingModule, [props]);\n    _this.lists = new _crafting_lists_submodule__WEBPACK_IMPORTED_MODULE_3__.CraftingListsSubmodule();\n    _this.craftingSlots = {};\n    _this.filters = [{\n      id: 'crafting',\n      name: 'Crafting',\n      tags: ['material'],\n      isDefault: true\n    }, {\n      id: 'alchemy',\n      name: 'Alchemy',\n      tags: ['alchemy'],\n      isDefault: false\n    }];\n    _this.eventHandler.registerHandler('query-crafting-data', function (payload) {\n      _this.sendCraftingData(payload);\n    });\n    _this.eventHandler.registerHandler('query-crafting-details', function (payload) {\n      _this.sendCraftingDetails(payload.id);\n    });\n    _this.eventHandler.registerHandler('set-crafting-level', function (payload) {\n      _this.setCraftingLevel(payload);\n      _this.sendCraftingData(payload);\n    });\n    return _this;\n  }\n  _inherits(CraftingModule, _GameModule);\n  return _createClass(CraftingModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      (0,_recipes_db__WEBPACK_IMPORTED_MODULE_1__.registerCraftingRecipes)();\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      this.lists.tick(game, delta);\n      /*if(gameEntity.entityExists('activeCrafting_craft_herbal_fibers')) {\n          console.log('DT: ',\n              gameEntity.getEntity('activeCrafting_craft_herbal_fibers'),\n              gameResources.getResource('inventory_ginseng')\n          )\n      }*/\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        slots: this.craftingSlots,\n        craftingLists: this.lists.save()\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      if (this.craftingSlots) {\n        for (var id in this.craftingSlots) {\n          this.setCraftingLevel({\n            id: id,\n            level: 0,\n            isForce: true\n          });\n        }\n      }\n      this.craftingSlots = (obj === null || obj === void 0 ? void 0 : obj.slots) || {};\n      if (Array.isArray(this.craftingSlots)) {\n        this.craftingSlots = {};\n      }\n      for (var _id in this.craftingSlots) {\n        this.setCraftingLevel({\n          id: _id,\n          level: this.craftingSlots[_id].level,\n          isForce: true\n        });\n      }\n      if (obj !== null && obj !== void 0 && obj.craftingLists) {\n        this.lists.load(obj.craftingLists);\n      }\n    }\n  }, {\n    key: \"stopAllCrafting\",\n    value: function stopAllCrafting(category) {\n      var tagToCat = {\n        'crafting': 'material',\n        alchemy: 'alchemy'\n      };\n      if (this.craftingSlots) {\n        for (var id in this.craftingSlots) {\n          var isIgnore = category && !game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).tags.includes(tagToCat[category]);\n          console.log('Stop Craft: ', category, id, isIgnore, game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id).tags);\n          if (!isIgnore) {\n            this.setCraftingLevel({\n              id: id,\n              level: 0,\n              isForce: true\n            });\n          }\n        }\n      }\n    }\n  }, {\n    key: \"setCraftingLevel\",\n    value: function setCraftingLevel(_ref) {\n      var id = _ref.id,\n        level = _ref.level,\n        _ref$isForce = _ref.isForce,\n        isForce = _ref$isForce === void 0 ? false : _ref$isForce;\n      if (!this.craftingSlots[id]) {\n        this.craftingSlots[id] = {\n          level: 0\n        };\n      }\n      if (level === 0 && game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.entityExists(\"activeCrafting_\".concat(id))) {\n        game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.unsetEntity(\"activeCrafting_\".concat(id));\n        this.craftingSlots[id].level = 0;\n      }\n      if (level > 0) {\n        if (!game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.entityExists(\"activeCrafting_\".concat(id))) {\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.registerGameEntity(\"activeCrafting_\".concat(id), {\n            copyFromId: id,\n            level: level,\n            allowedImpacts: ['resources'],\n            tags: ['running', 'runningCrafting']\n          });\n        }\n        var rs = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.setEntityLevel(\"activeCrafting_\".concat(id), level, isForce);\n        console.log('Update result: ', rs);\n        this.craftingSlots[id].level = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getLevel(\"activeCrafting_\".concat(id));\n      }\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      this.filters.forEach(function (filter) {\n        var entities = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['recipe'].concat(_toConsumableArray(filter.tags)));\n        entities.forEach(function (item) {\n          game_framework__WEBPACK_IMPORTED_MODULE_2__.gameCore.getModule('unlock-notifications').registerNewNotification('workshop', filter.id, \"crafting_\".concat(item.id), item.isUnlocked && !item.isCapped);\n        });\n      });\n    }\n  }, {\n    key: \"getCraftingData\",\n    value: function getCraftingData(payload) {\n      var _this2 = this;\n      if (!(payload !== null && payload !== void 0 && payload.filterId)) {\n        throw new Error(\"FilterId is required\");\n      }\n      var filterId = payload === null || payload === void 0 ? void 0 : payload.filterId;\n      var filter = this.filters.find(function (o) {\n        return o.id === filterId;\n      });\n      if (!filter) {\n        throw new Error(\"\".concat(filterId, \" not found\"));\n      }\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.listEntitiesByTags(['recipe'].concat(_toConsumableArray(filter.tags))).filter(function (one) {\n        return one.isUnlocked;\n      });\n      var rrs = filterId === 'crafting' ? game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('crafting_slots') : game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('alchemy_slots');\n      var efrs = filterId === 'crafting' ? game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('crafting_ability') : game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('alchemy_ability');\n      var available = entities.map(function (recipe) {\n        var _this2$craftingSlots$, _this2$craftingSlots$2, _gameResources$getRes, _gameEntity$getEntity;\n        return _objectSpread(_objectSpread({}, recipe), {}, {\n          icon_id: recipe.resourceId,\n          level: ((_this2$craftingSlots$ = _this2.craftingSlots[recipe.id]) === null || _this2$craftingSlots$ === void 0 ? void 0 : _this2$craftingSlots$.level) || 0,\n          maxLevel: rrs.amount + (((_this2$craftingSlots$2 = _this2.craftingSlots[recipe.id]) === null || _this2$craftingSlots$2 === void 0 ? void 0 : _this2$craftingSlots$2.level) || 0),\n          resourceAmount: (_gameResources$getRes = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(recipe.resourceId)) === null || _gameResources$getRes === void 0 ? void 0 : _gameResources$getRes.amount,\n          isRunning: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.entityExists(\"activeCrafting_\".concat(recipe.id)),\n          isLowerEfficiency: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.entityExists(\"activeCrafting_\".concat(recipe.id)) && ((_gameEntity$getEntity = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(\"activeCrafting_\".concat(recipe.id)).modifier) === null || _gameEntity$getEntity === void 0 ? void 0 : _gameEntity$getEntity.efficiency) < 1 - game_framework_src_utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER\n        });\n      });\n      var slots = {\n        max: rrs.income,\n        total: rrs.amount\n      };\n      return {\n        available: available,\n        slots: slots,\n        efforts: efrs,\n        craftingLists: this.lists.getLists({\n          category: filterId\n        })\n      };\n    }\n  }, {\n    key: \"getCraftingDetails\",\n    value: function getCraftingDetails(id) {\n      var _this$craftingSlots$e, _this$craftingSlots$e2, _this$craftingSlots$e3, _this$craftingSlots$e4;\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(id);\n      var isRunning = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.entityExists(\"activeCrafting_\".concat(id));\n      var actualEntity = entity;\n      var efficiency = 1;\n      var bottleNeck = null;\n      if (isRunning) {\n        var _actualEntity$modifie, _actualEntity$modifie2, _actualEntity$modifie3, _actualEntity$modifie4;\n        actualEntity = game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEntity(\"activeCrafting_\".concat(id));\n        efficiency = (_actualEntity$modifie = (_actualEntity$modifie2 = actualEntity.modifier) === null || _actualEntity$modifie2 === void 0 ? void 0 : _actualEntity$modifie2.efficiency) !== null && _actualEntity$modifie !== void 0 ? _actualEntity$modifie : 1;\n        bottleNeck = (_actualEntity$modifie3 = actualEntity.modifier) !== null && _actualEntity$modifie3 !== void 0 && _actualEntity$modifie3.bottleNeck ? game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource((_actualEntity$modifie4 = actualEntity.modifier) === null || _actualEntity$modifie4 === void 0 ? void 0 : _actualEntity$modifie4.bottleNeck) : null;\n      }\n      return _objectSpread(_objectSpread({}, entity), {}, {\n        efficiency: efficiency,\n        bottleNeck: bottleNeck,\n        effects: isRunning ? game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(\"activeCrafting_\".concat(id), 0, ((_this$craftingSlots$e = this.craftingSlots[entity.id]) === null || _this$craftingSlots$e === void 0 ? void 0 : _this$craftingSlots$e.level) || 1, false, 1) : game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getEffects(entity.id, 0, ((_this$craftingSlots$e2 = this.craftingSlots[entity.id]) === null || _this$craftingSlots$e2 === void 0 ? void 0 : _this$craftingSlots$e2.level) || 1, true, 1, 1),\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameEntity.getAffordable(entity.id),\n        level: ((_this$craftingSlots$e3 = this.craftingSlots[entity.id]) === null || _this$craftingSlots$e3 === void 0 ? void 0 : _this$craftingSlots$e3.level) || 0,\n        maxLevel: game_framework__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource('crafting_slots').amount + (((_this$craftingSlots$e4 = this.craftingSlots[entity.id]) === null || _this$craftingSlots$e4 === void 0 ? void 0 : _this$craftingSlots$e4.level) || 0)\n      });\n    }\n  }, {\n    key: \"sendCraftingData\",\n    value: function sendCraftingData(payload) {\n      var data = this.getCraftingData(payload);\n      this.eventHandler.sendData(\"crafting-data-\".concat(payload.filterId), data);\n    }\n  }, {\n    key: \"sendCraftingDetails\",\n    value: function sendCraftingDetails(payload) {\n      var data = this.getCraftingDetails(payload);\n      // console.log('Send crafting: crafting-details', data);\n      this.eventHandler.sendData(\"crafting-details\", data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/workshop/crafting.module.js?");

/***/ }),

/***/ "./src/worker/modules/workshop/plantation-db.js":
/*!******************************************************!*\
  !*** ./src/worker/modules/workshop/plantation-db.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerPlant: () => (/* binding */ registerPlant),\n/* harmony export */   registerPlantations: () => (/* binding */ registerPlantations)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n\nvar registerPlant = function registerPlant(id, inventoryResource, incomeBase, costBase, options) {\n  game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(id, {\n    tags: [\"plantation\"],\n    name: options.name,\n    isAbstract: false,\n    description: options.description,\n    level: 0,\n    icon_id: inventoryResource,\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: _defineProperty({}, inventoryResource, {\n            A: incomeBase * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('plantations_efficiency'),\n            B: 0,\n            type: 0\n          })\n        };\n      },\n      consumption: {\n        resources: {\n          plantation_slots: {\n            A: 1,\n            B: 0,\n            type: 2\n          }\n        }\n      },\n      effectDeps: ['plantations_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.isResourceUnlocked(inventoryResource) && game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('plantation_slots').income > 0;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      var seeds = _defineProperty({}, inventoryResource, {\n        A: 1.5,\n        B: costBase,\n        type: 1\n      });\n      var places = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(id) <= 0 ? {\n        'plantation_slots': {\n          A: 0,\n          B: 1,\n          type: 0\n        }\n      } : {};\n      return _objectSpread(_objectSpread({}, seeds), places);\n    }\n  });\n};\nfunction registerPlantations() {\n  registerPlant('berry_plantation', 'inventory_berry', 0.1, 5000, {\n    name: 'Grow Berries',\n    description: 'Just plant some berries... OK?'\n  });\n  registerPlant('fly_mushroom_plantation', 'inventory_fly_mushroom', 0.05, 2000, {\n    name: 'Grow Fly Mushroom',\n    description: 'They say you are druggie, but never mind  you are a mage.'\n  });\n  registerPlant('golden_algae_plantation', 'inventory_golden_algae', 0.04, 2000, {\n    name: 'Grow Golden Algae',\n    description: 'Grow Golden Algae.'\n  });\n  registerPlant('knowledge_moss_plantation', 'inventory_knowledge_moss', 0.04, 2000, {\n    name: 'Grow Knowledge Moss',\n    description: 'Grow Knowledge Moss.'\n  });\n  registerPlant('core_duckweed_plantation', 'inventory_core_duckweed', 0.04, 2000, {\n    name: 'Grow Duckweed',\n    description: 'Grow core duckweed.'\n  });\n  registerPlant('aloe_vera_plantation', 'inventory_aloe_vera', 0.02, 500, {\n    name: 'Grow Aloe Vera',\n    description: 'Grow some aloe vera'\n  });\n  registerPlant('ginseng_plantation', 'inventory_ginseng', 0.02, 500, {\n    name: 'Grow Ginseng',\n    description: 'Grow some ginseng'\n  });\n  registerPlant('nightshade_plantation', 'inventory_nightshade', 0.01, 500, {\n    name: 'Grow Nightshade',\n    description: 'Grow some nightshade'\n  });\n  registerPlant('harmony_blossom_plantation', 'inventory_harmony_blossom', 0.01, 500, {\n    name: 'Grow Harmony Blossom',\n    description: 'Grow Harmony Blossom'\n  });\n  registerPlant('ember_leaf_plantation', 'inventory_ember_leaf', 0.01, 500, {\n    name: 'Grow Ember Leaf',\n    description: 'Grow Ember Leaf'\n  });\n  registerPlant('mystic_bloom_plantation', 'inventory_mystic_bloom', 0.01, 500, {\n    name: 'Grow Mystic Bloom',\n    description: 'Grow Mystic Bloom'\n  });\n}\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/workshop/plantation-db.js?");

/***/ }),

/***/ "./src/worker/modules/workshop/plantations.module.js":
/*!***********************************************************!*\
  !*** ./src/worker/modules/workshop/plantations.module.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PlantationsModule: () => (/* binding */ PlantationsModule)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n/* harmony import */ var _shared_game_module__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _plantation_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./plantation-db */ \"./src/worker/modules/workshop/plantation-db.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\n\nvar PlantationsModule = /*#__PURE__*/function (_GameModule) {\n  function PlantationsModule() {\n    var _this;\n    _classCallCheck(this, PlantationsModule);\n    _this = _callSuper(this, PlantationsModule);\n    _this.purchasedItems = {};\n    _this.isUnlocked = false;\n    _this.leveledId = null;\n    _this.eventHandler.registerHandler('purchase-plantation', function (payload) {\n      _this.purchaseItem(payload.id);\n    });\n    _this.eventHandler.registerHandler('remove-plantation', function (payload) {\n      _this.removeItem(payload.id);\n    });\n    _this.eventHandler.registerHandler('query-plantation-data', function (payload) {\n      _this.sendItemsData();\n    });\n    _this.eventHandler.registerHandler('query-plantation-details', function (payload) {\n      _this.sendItemDetails(payload.id);\n    });\n    return _this;\n  }\n  _inherits(PlantationsModule, _GameModule);\n  return _createClass(PlantationsModule, [{\n    key: \"initialize\",\n    value: function initialize() {\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.registerEffect('plantations_efficiency', {\n        name: 'Plantations Efficiency',\n        defaultValue: 1,\n        minValue: 1\n      });\n      (0,_plantation_db__WEBPACK_IMPORTED_MODULE_2__.registerPlantations)();\n    }\n  }, {\n    key: \"tick\",\n    value: function tick(game, delta) {\n      this.leveledId = null;\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        items: this.purchasedItems\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObject) {\n      for (var key in this.purchasedItems) {\n        this.setItem(key, 0, true);\n      }\n      this.purchasedItems = {};\n      if (saveObject !== null && saveObject !== void 0 && saveObject.items) {\n        for (var id in saveObject.items) {\n          this.setItem(id, saveObject.items[id], true);\n        }\n      }\n      this.sendItemsData();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.load({});\n    }\n  }, {\n    key: \"setItem\",\n    value: function setItem(itemId, amount) {\n      var bForce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.setEntityLevel(itemId, amount, bForce);\n      this.purchasedItems[itemId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(itemId);\n    }\n  }, {\n    key: \"purchaseItem\",\n    value: function purchaseItem(itemId) {\n      var newEnt = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.levelUpEntity(itemId);\n      if (newEnt.success) {\n        this.purchasedItems[itemId] = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel(itemId);\n        this.leveledId = itemId;\n        this.sendItemsData();\n      }\n      return newEnt.success;\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(itemId) {\n      this.setItem(itemId, 0, true);\n    }\n  }, {\n    key: \"regenerateNotifications\",\n    value: function regenerateNotifications() {\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['plantation']);\n      entities.forEach(function (item) {\n        game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('unlock-notifications').registerNewNotification('workshop', 'plantations', \"plantation_\".concat(item.id), item.isUnlocked && !item.isCapped);\n      });\n    }\n  }, {\n    key: \"getItemsData\",\n    value: function getItemsData() {\n      var _this2 = this;\n      var entities = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.listEntitiesByTags(['plantation']);\n      var rrs = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource('plantation_slots');\n\n      // console.log('RSS:', rrs);\n\n      var slots = {\n        max: rrs.income,\n        total: rrs.amount\n      };\n      return {\n        available: entities.filter(function (one) {\n          return one.isUnlocked && !one.isCapped;\n        }).map(function (entity) {\n          return {\n            id: entity.id,\n            icon_id: entity.icon_id,\n            name: entity.name,\n            description: entity.description,\n            max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n            level: _this2.purchasedItems[entity.id] || 0,\n            affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n            potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n            isLeveled: _this2.leveledId === entity.id\n          };\n        }),\n        slots: slots\n      };\n    }\n  }, {\n    key: \"sendItemsData\",\n    value: function sendItemsData() {\n      var data = this.getItemsData();\n      this.eventHandler.sendData('plantations-data', data);\n    }\n  }, {\n    key: \"getItemDetails\",\n    value: function getItemDetails(id) {\n      if (!id) return null;\n      var entity = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(id);\n      return {\n        id: entity.id,\n        name: entity.name,\n        description: entity.description,\n        max: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntityMaxLevel(entity.id),\n        level: this.purchasedItems[entity.id] || 0,\n        affordable: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getAffordable(entity.id),\n        potentialEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id, 1),\n        currentEffects: game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEffects(entity.id),\n        tags: entity.tags,\n        purchaseMultiplier: 1\n      };\n    }\n  }, {\n    key: \"sendItemDetails\",\n    value: function sendItemDetails(id) {\n      var data = this.getItemDetails(id);\n      this.eventHandler.sendData('plantation-details', data);\n    }\n  }]);\n}(_shared_game_module__WEBPACK_IMPORTED_MODULE_1__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/workshop/plantations.module.js?");

/***/ }),

/***/ "./src/worker/modules/workshop/recipes-db.js":
/*!***************************************************!*\
  !*** ./src/worker/modules/workshop/recipes-db.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getPrimaryBonus: () => (/* binding */ getPrimaryBonus),\n/* harmony export */   registerCraftingRecipe: () => (/* binding */ registerCraftingRecipe),\n/* harmony export */   registerCraftingRecipes: () => (/* binding */ registerCraftingRecipes)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar getPrimaryBonus = function getPrimaryBonus(attributeId) {\n  return 0.98 + 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue(attributeId);\n};\nvar registerCraftingRecipe = function registerCraftingRecipe(id, options) {\n  var primaryAttribute = options.attributes.primaryAttribute;\n  if (!primaryAttribute || !options.resourceModifier) {\n    return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(id, options);\n  }\n  if (!options.resourceModifier.effectDeps) {\n    options.resourceModifier.effectDeps = [];\n  }\n  if (!options.resourceModifier.effectDeps.includes(primaryAttribute)) {\n    options.resourceModifier.effectDeps.push(primaryAttribute);\n  }\n  options.getPrimaryEffect = function () {\n    return getPrimaryBonus(primaryAttribute);\n  };\n  if (options.attributes.isTraining) {\n    options.resourceModifier.customAmplifierApplyTypes = ['resources'];\n  } else {\n    options.resourceModifier.customAmplifierApplyTypes = ['effects', 'resources'];\n  }\n  options.resourceModifier.getCustomAmplifier = function () {\n    return options.getPrimaryEffect();\n  };\n  return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.registerGameEntity(id, options);\n};\nvar registerCraftingRecipes = function registerCraftingRecipes() {\n  registerCraftingRecipe('craft_refined_wood', {\n    tags: [\"recipe\", \"crafting\", \"material\", \"physical\"],\n    name: 'Craft Refined Wood',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Refine wood and use it for your needs, or just sell it',\n    level: 1,\n    resourceId: 'inventory_refined_wood',\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_refined_wood': {\n              A: 1.3,\n              B: 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('crafting_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'inventory_wood': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['crafting_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'crafting_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_paper', {\n    tags: [\"recipe\", \"crafting\", \"material\", \"physical\"],\n    name: 'Craft Paper',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Refine wood and use it for your needs, or just sell it',\n    level: 1,\n    resourceId: 'inventory_paper',\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_paper': {\n              A: 1.3,\n              B: 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('crafting_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'inventory_wood': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['crafting_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.isResourceUnlocked('inventory_paper');\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'crafting_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_enchanted_paper', {\n    tags: [\"recipe\", \"crafting\", \"material\", \"physical\"],\n    name: 'Enchant Paper',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Craft Enchanted magical paper scrolls',\n    level: 1,\n    resourceId: 'inventory_enchanted_paper',\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_enchanted_paper': {\n              A: 1.3,\n              B: 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('crafting_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'inventory_paper': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          mana: {\n            A: 1.5,\n            B: 40,\n            type: 1\n          },\n          'crafting_ability': {\n            A: 1.5,\n            B: 2,\n            type: 1\n          },\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['crafting_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.isResourceUnlocked('inventory_enchanted_paper');\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'crafting_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_herbal_fibers', {\n    tags: [\"recipe\", \"crafting\", \"material\", \"physical\"],\n    name: 'Craft Herbal Fibers',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Dry and weave your herbs in fibers for further usage',\n    level: 1,\n    resourceId: 'inventory_herbal_fibers',\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_herbal_fibers': {\n              A: 1.3,\n              B: 0.2 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('crafting_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'inventory_ginseng': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'inventory_aloe_vera': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['crafting_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return true;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'crafting_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_ruby', {\n    tags: [\"recipe\", \"crafting\", \"material\", \"physical\"],\n    name: 'Refine Ruby',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Refine your stones to obtain trace amounts of rubies',\n    level: 1,\n    resourceId: 'inventory_ruby',\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_ruby': {\n              A: 1.3,\n              B: 0.05 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('crafting_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'inventory_stone': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['crafting_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.isResourceUnlocked('inventory_stone');\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'crafting_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_sapphire', {\n    tags: [\"recipe\", \"crafting\", \"material\", \"physical\"],\n    name: 'Refine Sapphire',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Refine your stones to obtain trace amounts of sapphires',\n    level: 1,\n    resourceId: 'inventory_sapphire',\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_sapphire': {\n              A: 1.3,\n              B: 0.05 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('crafting_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'inventory_stone': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['crafting_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.isResourceUnlocked('inventory_stone');\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'crafting_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_iron_plate', {\n    tags: [\"recipe\", \"crafting\", \"material\", \"physical\"],\n    name: 'Craft Iron Plate',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Smelt iron ore into iron plates',\n    level: 1,\n    resourceId: 'inventory_iron_plate',\n    resourceModifier: {\n      get_income: function get_income() {\n        return {\n          resources: {\n            'inventory_iron_plate': {\n              A: 1.3,\n              B: 0.02 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('crafting_efficiency'),\n              type: 1\n            }\n          }\n        };\n      },\n      consumption: {\n        resources: {\n          'inventory_iron_ore': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'crafting_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['crafting_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.isResourceUnlocked('inventory_iron_ore');\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'crafting_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n\n  // alchemy\n\n  registerCraftingRecipe('craft_small_endurance_flask', {\n    tags: [\"recipe\", \"crafting\", \"alchemy\", \"physical\"],\n    name: 'Craft Small Endurance Flask',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Use your herbs to create more efficient substance to boost your energy',\n    level: 1,\n    resourceId: 'inventory_small_endurance_flask',\n    resourceModifier: {\n      income: {\n        resources: {\n          'inventory_small_endurance_flask': {\n            A: 1.3,\n            B: 1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('alchemy_efficiency'),\n            type: 1\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'inventory_ginseng': {\n            A: 1.5,\n            B: 5,\n            type: 1\n          },\n          'inventory_berry': {\n            A: 1.5,\n            B: 25,\n            type: 1\n          },\n          'alchemy_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['alchemy_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'alchemy_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_healing_potion', {\n    tags: [\"recipe\", \"crafting\", \"alchemy\", \"physical\"],\n    name: 'Craft Small Healing Potion',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Use healing herbs concentrate to save yourself from falling deceased',\n    level: 1,\n    resourceId: 'inventory_healing_potion',\n    resourceModifier: {\n      income: {\n        resources: {\n          'inventory_healing_potion': {\n            A: 1.3,\n            B: 1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('alchemy_efficiency'),\n            type: 1\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'inventory_aloe_vera': {\n            A: 1.5,\n            B: 5,\n            type: 1\n          },\n          'inventory_berry': {\n            A: 1.5,\n            B: 25,\n            type: 1\n          },\n          'alchemy_ability': {\n            A: 1.5,\n            B: 1,\n            type: 1\n          },\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['alchemy_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'alchemy_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_experience_potion', {\n    tags: [\"recipe\", \"crafting\", \"alchemy\", \"physical\"],\n    name: 'Craft Small Experience Potion',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Use experimental and dangerous herbs at your risk in searching for better understanding of human and mages being',\n    level: 1,\n    resourceId: 'inventory_experience_potion',\n    resourceModifier: {\n      income: {\n        resources: {\n          'inventory_experience_potion': {\n            A: 1.3,\n            B: 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('alchemy_efficiency'),\n            type: 1\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'inventory_nightshade': {\n            A: 1.5,\n            B: 2.5,\n            type: 1\n          },\n          'inventory_fly_mushroom': {\n            A: 1.5,\n            B: 10,\n            type: 1\n          },\n          'alchemy_ability': {\n            A: 1.5,\n            B: 2. / 1.5,\n            type: 1\n          },\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['alchemy_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'alchemy_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_insight_potion', {\n    tags: [\"recipe\", \"crafting\", \"alchemy\", \"physical\"],\n    name: 'Craft Insight Potion',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'A simple yet potent concoction brewed from golden algae and knowledge moss. Consuming it grants a one-time surge in experience.',\n    level: 1,\n    resourceId: 'inventory_insight_potion',\n    resourceModifier: {\n      income: {\n        resources: {\n          'inventory_insight_potion': {\n            A: 1.3,\n            B: 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('alchemy_efficiency'),\n            type: 1\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'inventory_knowledge_moss': {\n            A: 1.5,\n            B: 75,\n            type: 1\n          },\n          'inventory_golden_algae': {\n            A: 1.5,\n            B: 250,\n            type: 1\n          },\n          'alchemy_ability': {\n            A: 1.5,\n            B: 2. / 1.5,\n            type: 1\n          },\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['alchemy_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'alchemy_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n  registerCraftingRecipe('craft_amnesia_potion', {\n    tags: [\"recipe\", \"crafting\", \"alchemy\", \"physical\"],\n    name: 'Amnesia Potion',\n    isAbstract: false,\n    allowedImpacts: ['effects'],\n    description: 'Forget your previously learned skills, feel yourself refreshed. Of course, it will have consequences',\n    level: 1,\n    resourceId: 'inventory_amnesia_potion',\n    resourceModifier: {\n      income: {\n        resources: {\n          'inventory_amnesia_potion': {\n            A: 1.3,\n            B: 0.1 * game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEffects.getEffectValue('alchemy_efficiency'),\n            type: 1\n          }\n        }\n      },\n      consumption: {\n        resources: {\n          'inventory_nightshade': {\n            A: 1.5,\n            B: 100,\n            type: 1\n          },\n          'inventory_fly_mushroom': {\n            A: 1.5,\n            B: 1000,\n            type: 1\n          },\n          'alchemy_ability': {\n            A: 1.5,\n            B: 2. / 1.5,\n            type: 1\n          },\n          'alchemy_slots': {\n            A: 1,\n            B: 0,\n            type: 0,\n            ignoreEfficiency: true\n          }\n        }\n      },\n      effectDeps: ['alchemy_efficiency']\n    },\n    unlockCondition: function unlockCondition() {\n      return game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getLevel('shop_item_alchemy_courses') > 0;\n    },\n    attributes: {\n      baseXPCost: 10\n    },\n    get_cost: function get_cost() {\n      return {\n        'alchemy_slots': {\n          A: 1,\n          B: 0,\n          type: 0\n        }\n      };\n    }\n  });\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/modules/workshop/recipes-db.js?");

/***/ }),

/***/ "./src/worker/shared/event-handler.js":
/*!********************************************!*\
  !*** ./src/worker/shared/event-handler.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EventHandler: () => (/* binding */ EventHandler)\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar EventHandler = /*#__PURE__*/function () {\n  function EventHandler() {\n    _classCallCheck(this, EventHandler);\n    _defineProperty(this, \"handlers\", {});\n    _defineProperty(this, \"handlers\", {});\n    if (EventHandler.instance) {\n      return EventHandler.instance;\n    }\n    EventHandler.instance = this;\n  }\n  return _createClass(EventHandler, [{\n    key: \"registerHandler\",\n    value: function registerHandler(event, cb) {\n      this.handlers[event] = cb;\n    }\n  }, {\n    key: \"processEvent\",\n    value: function processEvent(event) {\n      if (!event.data) return;\n      var parsed = JSON.parse(event.data);\n      if (!parsed.event || !this.handlers[parsed.event]) {\n        throw new Error(\"Invalid event: \".concat(parsed.event));\n      }\n      return this.handlers[parsed.event](parsed.payload);\n    }\n  }, {\n    key: \"sendData\",\n    value: function sendData(event, payload) {\n      postMessage(JSON.stringify({\n        event: event,\n        payload: payload\n      }));\n    }\n  }]);\n}();\n_defineProperty(EventHandler, \"instance\", null);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/event-handler.js?");

/***/ }),

/***/ "./src/worker/shared/game-module.js":
/*!******************************************!*\
  !*** ./src/worker/shared/game-module.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GameModule: () => (/* binding */ GameModule)\n/* harmony export */ });\n/* harmony import */ var _event_handler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./event-handler */ \"./src/worker/shared/event-handler.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\n\nvar GameModule = /*#__PURE__*/_createClass(function GameModule() {\n  _classCallCheck(this, GameModule);\n  this.eventHandler = new _event_handler__WEBPACK_IMPORTED_MODULE_0__.EventHandler();\n});\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/game-module.js?");

/***/ }),

/***/ "./src/worker/shared/modules/hotkeys.module.js":
/*!*****************************************************!*\
  !*** ./src/worker/shared/modules/hotkeys.module.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HotkeysModule: () => (/* binding */ HotkeysModule)\n/* harmony export */ });\n/* harmony import */ var _game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../game-module */ \"./src/worker/shared/game-module.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\nvar HotkeysModule = /*#__PURE__*/function (_GameModule) {\n  function HotkeysModule() {\n    var _this;\n    _classCallCheck(this, HotkeysModule);\n    _this = _callSuper(this, HotkeysModule);\n    _this.hotKeys = {};\n    _this.eventHandler.registerHandler('query-all-hotkeys', function () {\n      _this.eventHandler.sendData('all-hotkeys', _this.hotKeys);\n    });\n    _this.eventHandler.registerHandler('update-hotkey', function (payload) {\n      _this.hotKeys[payload.id] = payload;\n      _this.eventHandler.sendData('all-hotkeys', _this.hotKeys);\n    });\n    return _this;\n  }\n  _inherits(HotkeysModule, _GameModule);\n  return _createClass(HotkeysModule, [{\n    key: \"initialize\",\n    value: function initialize() {}\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        hotKeys: this.hotKeys\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(obj) {\n      if (obj !== null && obj !== void 0 && obj.hotKeys) {\n        this.hotKeys = obj.hotKeys;\n      }\n    }\n  }, {\n    key: \"tick\",\n    value: function tick() {}\n  }]);\n}(_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/modules/hotkeys.module.js?");

/***/ }),

/***/ "./src/worker/shared/modules/monitoring.module.js":
/*!********************************************************!*\
  !*** ./src/worker/shared/modules/monitoring.module.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MonitoringModule: () => (/* binding */ MonitoringModule)\n/* harmony export */ });\n/* harmony import */ var _game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\nvar MonitoringModule = /*#__PURE__*/function (_GameModule) {\n  function MonitoringModule() {\n    var _this;\n    _classCallCheck(this, MonitoringModule);\n    _this = _callSuper(this, MonitoringModule);\n    _this.eventHandler.registerHandler('set-monitored', function (_ref) {\n      var type = _ref.type,\n        id = _ref.id;\n      // console.log('Mon: ', { type, id });\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').setMonitored({\n        type: type,\n        id: id\n      });\n    });\n    return _this;\n  }\n  _inherits(MonitoringModule, _GameModule);\n  return _createClass(MonitoringModule, [{\n    key: \"initialize\",\n    value: function initialize() {}\n  }, {\n    key: \"tick\",\n    value: function tick() {}\n  }, {\n    key: \"save\",\n    value: function save() {}\n  }, {\n    key: \"load\",\n    value: function load() {}\n  }]);\n}(_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/modules/monitoring.module.js?");

/***/ }),

/***/ "./src/worker/shared/modules/rules.module.js":
/*!***************************************************!*\
  !*** ./src/worker/shared/modules/rules.module.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RulesModule: () => (/* binding */ RulesModule)\n/* harmony export */ });\n/* harmony import */ var _game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var _utils_rule_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/rule-utils */ \"./src/worker/shared/utils/rule-utils.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\nvar RulesModule = /*#__PURE__*/function (_GameModule) {\n  function RulesModule() {\n    var _this;\n    _classCallCheck(this, RulesModule);\n    _this = _callSuper(this, RulesModule);\n    _this.eventHandler.registerHandler('check-rule-conditions-matched', function (_ref) {\n      var prefix = _ref.prefix,\n        rules = _ref.rules,\n        pattern = _ref.pattern;\n      var results = (0,_utils_rule_utils__WEBPACK_IMPORTED_MODULE_1__.checkMatchingRules)(rules, pattern, true);\n      _this.eventHandler.sendData(\"rule-conditions-matched-\".concat(prefix), results);\n    });\n    return _this;\n  }\n  _inherits(RulesModule, _GameModule);\n  return _createClass(RulesModule, [{\n    key: \"initialize\",\n    value: function initialize() {}\n  }, {\n    key: \"save\",\n    value: function save() {}\n  }, {\n    key: \"load\",\n    value: function load() {}\n  }, {\n    key: \"tick\",\n    value: function tick() {}\n  }]);\n}(_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/modules/rules.module.js?");

/***/ }),

/***/ "./src/worker/shared/modules/unlock-notifications.module.js":
/*!******************************************************************!*\
  !*** ./src/worker/shared/modules/unlock-notifications.module.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UnlockNotificationsModule: () => (/* binding */ UnlockNotificationsModule)\n/* harmony export */ });\n/* harmony import */ var _game_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../game-module */ \"./src/worker/shared/game-module.js\");\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\n\n\nvar UnlockNotificationsModule = /*#__PURE__*/function (_GameModule) {\n  function UnlockNotificationsModule() {\n    var _this;\n    _classCallCheck(this, UnlockNotificationsModule);\n    _this = _callSuper(this, UnlockNotificationsModule);\n    _this.notifications = {};\n    _this.byId = {};\n    _this.eventHandler.registerHandler('query-new-unlocks-notifications', function (payload) {\n      _this.sendNewUnlocks(payload);\n    });\n    _this.eventHandler.registerHandler('set-new-notification-viewed', function (payload) {\n      _this.setViewed(payload.scope, payload.category, payload.id);\n    });\n    _this.eventHandler.registerHandler('set-all-new-notification-viewed', function (payload) {\n      _this.setAllViewed();\n    });\n    _this.eventHandler.registerHandler('set-new-notification-viewed-by-id', function (payload) {\n      _this.setViewedById(payload.id);\n    });\n    return _this;\n  }\n  _inherits(UnlockNotificationsModule, _GameModule);\n  return _createClass(UnlockNotificationsModule, [{\n    key: \"initialize\",\n    value: function initialize() {}\n  }, {\n    key: \"tick\",\n    value: function tick() {}\n  }, {\n    key: \"registerPath\",\n    value: function registerPath(scope, category, id) {\n      if (!this.notifications[scope]) {\n        this.notifications[scope] = {};\n      }\n      if (!this.notifications[scope][category]) {\n        this.notifications[scope][category] = {};\n      }\n      if (!this.notifications[scope][category][id]) {\n        this.notifications[scope][category][id] = {\n          isUnlocked: false,\n          isViewed: false\n        };\n      }\n      if (!this.byId[id]) {\n        this.byId[id] = [];\n      }\n      if (!this.byId[id].find(function (one) {\n        return one.scope === scope && one.category === category;\n      })) {\n        this.byId[id].push({\n          scope: scope,\n          category: category\n        });\n      }\n    }\n  }, {\n    key: \"registerNewNotification\",\n    value: function registerNewNotification(scope, category, id) {\n      var isUnlocked = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      this.registerPath(scope, category, id);\n      this.notifications[scope][category][id].isUnlocked = isUnlocked;\n    }\n  }, {\n    key: \"setViewed\",\n    value: function setViewed(scope, category, id) {\n      var isViewed = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n      console.log('Setting viewed: ', scope, category, id);\n      this.registerPath(scope, category, id);\n      this.notifications[scope][category][id].isViewed = isViewed;\n    }\n  }, {\n    key: \"setViewedById\",\n    value: function setViewedById(id) {\n      var _this2 = this;\n      var isViewed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      if (!this.byId[id]) {\n        return;\n      }\n      this.byId[id].forEach(function (pathData) {\n        _this2.setViewed(pathData.scope, pathData.category, id, isViewed);\n      });\n    }\n  }, {\n    key: \"setAllViewed\",\n    value: function setAllViewed() {\n      var _this3 = this;\n      var _loop = function _loop(id) {\n        var pathsData = _this3.byId[id];\n        var isUnlocked = pathsData.reduce(function (acc, item) {\n          return acc || _this3.notifications[item.scope][item.category][id].isUnlocked;\n        }, false);\n        console.log('id: ', id, isUnlocked);\n        if (isUnlocked) {\n          _this3.setViewedById(id, true);\n        }\n      };\n      for (var id in this.byId) {\n        _loop(id);\n      }\n    }\n  }, {\n    key: \"load\",\n    value: function load(saveObj) {\n      this.notifications = (saveObj === null || saveObj === void 0 ? void 0 : saveObj.newNotifications) || {};\n      this.generateNotifications();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      return {\n        newNotifications: this.notifications\n      };\n    }\n  }, {\n    key: \"generateNotifications\",\n    value: function generateNotifications() {\n      // called each time when we should check notifications\n\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('actions').regenerateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('shop').regenerateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('inventory').regenerateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('property').regenerateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('crafting').regenerateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('plantations').regenerateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('magic').regenerateNotifications();\n      game_framework__WEBPACK_IMPORTED_MODULE_1__.gameCore.getModule('guilds').regenerateNotifications();\n    }\n  }, {\n    key: \"fetchCategoryNew\",\n    value: function fetchCategoryNew(scope, category) {\n      var results = {};\n      for (var key in this.notifications[scope][category]) {\n        if (this.notifications[scope][category][key].isUnlocked && !this.notifications[scope][category][key].isViewed) {\n          results[key] = true;\n        }\n      }\n      return results;\n    }\n  }, {\n    key: \"hasNewNotifications\",\n    value: function hasNewNotifications() {\n      var scope = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var category = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var id = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var result = {};\n      for (var scopeId in this.notifications) {\n        if (scope && scopeId !== scope) {\n          continue;\n        }\n        if (!result[scopeId]) {\n          result[scopeId] = {\n            items: {},\n            hasNew: false\n          };\n        }\n        for (var categoryId in this.notifications[scopeId]) {\n          if (category && category !== categoryId) {\n            continue;\n          }\n          if (!result[scopeId].items[categoryId]) {\n            result[scopeId].items[categoryId] = {\n              items: {},\n              hasNew: false\n            };\n          }\n          for (var itemId in this.notifications[scopeId][categoryId]) {\n            if (id && id !== itemId) {\n              continue;\n            }\n            if (!result[scopeId].items[categoryId].items[itemId]) {\n              result[scopeId].items[categoryId].items[itemId] = {\n                items: {},\n                hasNew: false\n              };\n            }\n            var hasNew = this.notifications[scopeId][categoryId][itemId].isUnlocked && !this.notifications[scopeId][categoryId][itemId].isViewed;\n            if (hasNew) {\n              result[scopeId].items[categoryId].items[itemId].hasNew = true;\n              result[scopeId].items[categoryId].hasNew = true;\n              result[scopeId].hasNew = true;\n            }\n          }\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"sendNewUnlocks\",\n    value: function sendNewUnlocks(payload) {\n      var result = this.hasNewNotifications(payload.scope, payload.category, payload.id);\n      var label = 'new-unlocks-notifications';\n      if (payload.suffix) {\n        label = \"\".concat(label, \"-\").concat(payload.suffix);\n      }\n      this.eventHandler.sendData(label, result);\n    }\n  }]);\n}(_game_module__WEBPACK_IMPORTED_MODULE_0__.GameModule);\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/modules/unlock-notifications.module.js?");

/***/ }),

/***/ "./src/worker/shared/utils/math.js":
/*!*****************************************!*\
  !*** ./src/worker/shared/utils/math.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calculateTimeToLevelUp: () => (/* binding */ calculateTimeToLevelUp),\n/* harmony export */   weightedRandomChoice: () => (/* binding */ weightedRandomChoice)\n/* harmony export */ });\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nfunction calculateTimeToLevelUp(A, B, N, M, factor, dxp) {\n  if (dxp <= 0) return 1.e+16;\n  //  1.01\n  var ln1_01 = Math.log(factor);\n\n  //  \n  var firstTerm = A * (Math.pow(factor, M) - Math.pow(factor, N)) / ln1_01;\n\n  //   -   level\n  var secondTermPart1 = A * B * ((M * Math.pow(factor, M) - N * Math.pow(factor, N)) / ln1_01);\n\n  //   -     1/(ln(1.01))^2\n  var secondTermPart2 = A * B * ((Math.pow(factor, M) - Math.pow(factor, N)) / Math.pow(ln1_01, 2));\n\n  //    XP\n  var totalXP = firstTerm + secondTermPart1 - secondTermPart2;\n\n  // ,    \n  var totalTime = totalXP / dxp;\n  return totalTime;\n}\nfunction weightedRandomChoice(probMap) {\n  // Calculate total weight\n  var totalWeight = Object.values(probMap).reduce(function (sum, weight) {\n    return sum + weight;\n  }, 0);\n\n  // Generate a random number in the range of totalWeight\n  var randVal = Math.random() * totalWeight;\n\n  // Traverse through the items, accumulating the weight\n  var cumulativeWeight = 0;\n  for (var _i = 0, _Object$entries = Object.entries(probMap); _i < _Object$entries.length; _i++) {\n    var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n      key = _Object$entries$_i[0],\n      weight = _Object$entries$_i[1];\n    cumulativeWeight += weight;\n    if (randVal < cumulativeWeight) {\n      return key;\n    }\n  }\n}\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/utils/math.js?");

/***/ }),

/***/ "./src/worker/shared/utils/objects.js":
/*!********************************************!*\
  !*** ./src/worker/shared/utils/objects.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   mapObject: () => (/* binding */ mapObject),\n/* harmony export */   packEffects: () => (/* binding */ packEffects)\n/* harmony export */ });\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nvar packEffects = function packEffects(effects) {\n  var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (item) {\n    return true;\n  };\n  var result = effects.filter(filter).reduce(function (acc, item) {\n    acc[\"\".concat(item.id, \"_\").concat(item.scope)] = item;\n    return acc;\n  }, {});\n  return result;\n};\nvar mapObject = function mapObject(o, cb) {\n  return Object.entries(o).reduce(function (acc, _ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      key = _ref2[0],\n      val = _ref2[1];\n    acc[key] = cb ? cb(val, key) : val;\n    return acc;\n  }, {});\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/utils/objects.js?");

/***/ }),

/***/ "./src/worker/shared/utils/rule-utils.js":
/*!***********************************************!*\
  !*** ./src/worker/shared/utils/rule-utils.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkMatchingActionLevelRule: () => (/* binding */ checkMatchingActionLevelRule),\n/* harmony export */   checkMatchingActionListRule: () => (/* binding */ checkMatchingActionListRule),\n/* harmony export */   checkMatchingActionRule: () => (/* binding */ checkMatchingActionRule),\n/* harmony export */   checkMatchingActionTagRule: () => (/* binding */ checkMatchingActionTagRule),\n/* harmony export */   checkMatchingResourceRule: () => (/* binding */ checkMatchingResourceRule),\n/* harmony export */   checkMatchingRule: () => (/* binding */ checkMatchingRule),\n/* harmony export */   checkMatchingRules: () => (/* binding */ checkMatchingRules)\n/* harmony export */ });\n/* harmony import */ var game_framework__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! game-framework */ \"./node_modules/game-framework/index.js\");\n\nvar checkMatchingResourceRule = function checkMatchingResourceRule(rule, key) {\n  var resource = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(rule.resource_id);\n  if (!resource) return false;\n  var compare = resource[key];\n  if (rule.value_type === 'percentage') {\n    if (!resource.cap) return false;\n    compare = 100 * resource[key] / resource.cap;\n  }\n  switch (rule.condition) {\n    case 'less':\n      return compare < +rule.value;\n    case 'less_or_eq':\n      return compare <= +rule.value;\n    case 'eq':\n      return compare == +rule.value;\n    case 'grt_or_eq':\n      return compare >= +rule.value;\n    case 'grt':\n      return compare > +rule.value;\n  }\n  return false;\n};\nvar checkMatchingActionRule = function checkMatchingActionRule(rule) {\n  var actionRunning = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('actions').isRunningAction(rule.action_id);\n  switch (rule.condition) {\n    case 'true':\n      return !!actionRunning;\n    case 'false':\n      return !actionRunning;\n  }\n  return false;\n};\nvar checkMatchingActionListRule = function checkMatchingActionListRule(rule) {\n  var _gameCore$getModule$l;\n  var actionListRunning = ((_gameCore$getModule$l = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('actions').lists.runningList) === null || _gameCore$getModule$l === void 0 ? void 0 : _gameCore$getModule$l.id) === rule.action_list_id;\n  switch (rule.condition) {\n    case 'true':\n      return !!actionListRunning;\n    case 'false':\n      return !actionListRunning;\n  }\n  return false;\n};\nvar checkMatchingActionTagRule = function checkMatchingActionTagRule(rule) {\n  var actionRunning = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameCore.getModule('actions').isRunningActionWithTag(rule.tag);\n  switch (rule.condition) {\n    case 'true':\n      return !!actionRunning;\n    case 'false':\n      return !actionRunning;\n  }\n  return false;\n};\nvar checkMatchingActionLevelRule = function checkMatchingActionLevelRule(rule, key) {\n  var action = game_framework__WEBPACK_IMPORTED_MODULE_0__.gameEntity.getEntity(rule.action_id);\n  if (!action) return false;\n  var compare = action.level;\n  switch (rule.condition) {\n    case 'less':\n      return compare < +rule.value;\n    case 'less_or_eq':\n      return compare <= +rule.value;\n    case 'eq':\n      return compare == +rule.value;\n    case 'grt_or_eq':\n      return compare >= +rule.value;\n    case 'grt':\n      return compare > +rule.value;\n  }\n  return false;\n};\nvar checkMatchingRule = function checkMatchingRule(rule) {\n  if (rule.compare_type === 'resource_amount') {\n    return checkMatchingResourceRule(rule, 'amount');\n  }\n  if (rule.compare_type === 'resource_balance') {\n    return checkMatchingResourceRule(rule, 'balance');\n  }\n  if (rule.compare_type === 'running_action') {\n    return checkMatchingActionRule(rule);\n  }\n  if (rule.compare_type === 'running_action_tag') {\n    return checkMatchingActionTagRule(rule);\n  }\n  if (rule.compare_type === 'action_level') {\n    return checkMatchingActionLevelRule(rule);\n  }\n  if (rule.compare_type === 'running_action_list') {\n    return checkMatchingActionListRule(rule);\n  }\n};\nvar checkMatchingRules = function checkMatchingRules(rules) {\n  var conditionStr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  var bExplain = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var ruleResults = rules.map(function (rule) {\n    return checkMatchingRule(rule);\n  });\n  if (!conditionStr) {\n    if (!bExplain) {\n      return ruleResults.every(function (result) {\n        return result === true;\n      });\n    }\n    return {\n      ruleResults: ruleResults,\n      result: ruleResults.length && ruleResults.every(function (result) {\n        return result === true;\n      })\n    };\n  }\n  var conditionExpression = conditionStr;\n  ruleResults.forEach(function (result, index) {\n    conditionExpression = conditionExpression.replace(new RegExp(\"\\\\b\".concat(index + 1, \"\\\\b\"), 'g'), result);\n  });\n  conditionExpression = conditionExpression.replace(/\\bAND\\b/g, '&&').replace(/\\bOR\\b/g, '||').replace(/\\bNOT\\b/g, '!');\n  try {\n    if (!bExplain) return eval(conditionExpression); //  \n\n    return {\n      ruleResults: ruleResults,\n      result: eval(conditionExpression)\n    };\n  } catch (error) {\n    console.error(\"Invalid condition string\", error);\n    return false;\n  }\n};\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/shared/utils/rule-utils.js?");

/***/ }),

/***/ "./node_modules/game-framework/index.js":
/*!**********************************************!*\
  !*** ./node_modules/game-framework/index.js ***!
  \**********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("module.exports = __webpack_require__(/*! ./src */ \"./node_modules/game-framework/src/index.js\");\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/index.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/core/index.js":
/*!*******************************************************!*\
  !*** ./node_modules/game-framework/src/core/index.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GameCore: () => (/* binding */ GameCore),\n/* harmony export */   gameCore: () => (/* binding */ gameCore)\n/* harmony export */ });\n/* harmony import */ var _resources__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../resources */ \"./node_modules/game-framework/src/resources/index.js\");\n/* harmony import */ var _game_entity__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../game-entity */ \"./node_modules/game-framework/src/game-entity/index.js\");\n/* harmony import */ var _utils_unlocks__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/unlocks */ \"./node_modules/game-framework/src/utils/unlocks.js\");\n\n\n\n\nclass GameCore {\n\n    constructor() {\n        this.isInitialized = false;\n        this.isTicking = false;\n        this.modules = {};\n        this.globalTime = 0;\n        this.numTicks = 0;\n        this.pid = Math.random();\n        GameCore.instance = this;\n    }\n\n    registerModule(id, moduleProto) {\n        if(this.modules[id]) return;\n\n        const module = new moduleProto();\n\n        module.gameInstance = this;\n\n        if(!module.initialize) {\n            throw new Error(`Module ${id} missing \"initialize\" method implementation`)\n        }\n        if(!module.tick) {\n            throw new Error(`Module ${id} missing \"tick\" method implementation`)\n        }\n        if(!module.load) {\n            throw new Error(`Module ${id} missing \"load\" method implementation`)\n        }\n        if(!module.save) {\n            throw new Error(`Module ${id} missing \"save\" method implementation`)\n        }\n        this.modules[id] = module;\n    }\n\n    getModule(id) {\n        return this.modules[id];\n    }\n\n    initialize(cb) {\n        for(const key in this.modules) {\n            this.modules[key].initialize(this);\n        }\n        _resources__WEBPACK_IMPORTED_MODULE_0__.resourcesManager.initialize();\n        _utils_unlocks__WEBPACK_IMPORTED_MODULE_2__.gameUnlocks.initialize();\n        if(cb) {\n            cb(this);\n        }\n\n        this.isInitialized = true;\n    }\n\n    startTicking(interval, delta, cb, bDebug) {\n        this.isTicking = true;\n        this.ticker = setInterval(() => {\n            const currentDelta = typeof delta === 'function' ? delta() : delta;\n            if(this.isInitialized) {\n                let ticks = {};\n                let start;\n                let total = 0;\n                for(const key in this.modules) {\n                    if(bDebug) {\n                        start = performance.now();\n                    }\n                    this.modules[key].tick(this, currentDelta);\n                    if(bDebug) {\n                        const dt = performance.now() - start;\n                        ticks[key] = dt;\n                        total += dt;\n                    }\n                }\n                if(bDebug) {\n                    start = performance.now();\n                }\n                _resources__WEBPACK_IMPORTED_MODULE_0__.resourcesManager.tick(currentDelta);\n                if(bDebug) {\n                    ticks['resourcesManager'] = performance.now() - start;\n                    total += ticks['resourcesManager'];\n                    console.log('TICKS: ', ticks, total);\n                }\n                cb(this, currentDelta);\n                this.numTicks++;\n                this.globalTime += currentDelta;\n            }\n        }, interval)\n    }\n\n    stopTicking() {\n        clearInterval(this.ticker);\n    }\n\n    save() {\n        const obj = {};\n        for(const key in this.modules) {\n            obj[key] = this.modules[key].save();\n        }\n        obj.resources = _resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.save();\n        obj.globalTime = this.globalTime;\n        obj.numTicks = this.numTicks;\n        obj.lastSave = Date.now();\n        return obj;\n    }\n\n    load(obj) {\n        _resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.load(obj.resources || {});\n        for(const key in this.modules) {\n            this.modules[key].load(obj[key]);\n        }\n        _resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.load(obj.resources || {});\n        this.numTicks = obj.numTicks;\n        this.globalTime = obj.globalTime;\n    }\n\n    getModule(id) {\n        return this.modules[id];\n    }\n\n}\n\nconst gameCore = GameCore.instance || new GameCore();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/core/index.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/game-entity/game-entity.js":
/*!********************************************************************!*\
  !*** ./node_modules/game-framework/src/game-entity/game-entity.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   gameEntity: () => (/* binding */ gameEntity)\n/* harmony export */ });\n/* harmony import */ var _resources_resource_modifiers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../resources/resource-modifiers */ \"./node_modules/game-framework/src/resources/resource-modifiers.js\");\n/* harmony import */ var _resources_resource_calculators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../resources/resource-calculators */ \"./node_modules/game-framework/src/resources/resource-calculators.js\");\n/* harmony import */ var _utils_formulas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/formulas */ \"./node_modules/game-framework/src/utils/formulas.js\");\n/* harmony import */ var _resources_game_effects__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../resources/game-effects */ \"./node_modules/game-framework/src/resources/game-effects.js\");\n/* harmony import */ var _resources_game_resources__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../resources/game-resources */ \"./node_modules/game-framework/src/resources/game-resources.js\");\n/* harmony import */ var _utils_consts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\n/* harmony import */ var _utils_unlocks__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/unlocks */ \"./node_modules/game-framework/src/utils/unlocks.js\");\n\n\n\n\n\n\n\n\nclass GameEntity {\n\n    constructor() {\n        GameEntity.instance = this;\n        this.entities = {};\n        this.entitiesByTags = {};\n\n        // this.entitiesByDeps = {};\n    }\n\n    registerGameEntity(id, entity) {\n        if(this.entities[id]) {\n            this.unsetEntity(id);\n        }\n        if(entity.copyFromId) {\n            entity = {\n                ...this.entities[entity.copyFromId],\n                allowedImpacts: [],\n                isAbstract: false,\n                ...entity,\n            }\n        }\n\n        if(!entity.level) {\n            entity.level = 0;\n        }\n        entity.id = id;\n        if(!entity.allowedImpacts || !entity.allowedImpacts.length) {\n            entity.allowedImpacts = ['resources', 'effects'];\n        }\n\n        if (entity.unlockedBy) {\n            for (const unlockInfo of entity.unlockedBy) {\n                const unlockerId = unlockInfo.id;\n                const unlockerScope = unlockInfo.type;\n                if (!_utils_unlocks__WEBPACK_IMPORTED_MODULE_6__.gameUnlocks.unlockMapping[unlockerScope][unlockerId]) {\n                    _utils_unlocks__WEBPACK_IMPORTED_MODULE_6__.gameUnlocks.unlockMapping[unlockerScope][unlockerId] = [];\n                }\n                _utils_unlocks__WEBPACK_IMPORTED_MODULE_6__.gameUnlocks.unlockMapping[unlockerScope][unlockerId].push({\n                    unlockId: id,\n                    level: unlockInfo.level\n                });\n            }\n        }\n\n        if(entity.resourceModifier && !entity.resourceModifier.customAmplifierApplyTypes) {\n            entity.resourceModifier.customAmplifierApplyTypes = ['resources', 'effects'];\n        }\n\n        if(entity.resourceModifier && !entity.isAbstract) {\n\n\n\n            if('effectFactor' in entity) {\n                // console.log(`EffectFactor for ${entity.id}: `, entity.effectFactor);\n                entity.resourceModifier.effectFactor = entity.effectFactor;\n            } else {\n                entity.resourceModifier.effectFactor = 1.;\n            }\n\n            // register resource modifier\n            const modif = {...entity.resourceModifier, level: entity.level, name: entity.name, allowedImpacts: entity.allowedImpacts, tags: entity.tags || []};\n\n            if(!modif.allowedImpacts) {\n                console.error('Not allowed empty modifiers', entity);\n            }\n\n            if(!modif.id) {\n                modif.id = `entity_${id}`\n            }\n            if(entity.modifierGroupId) {\n                modif.groupId = entity.modifierGroupId;\n            }\n            if(modif.groupId) {\n                entity.modifierGroupId = modif.groupId;\n                modif.id = modif.groupId;\n            }\n            entity.modifier = _resources_resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.registerModifier(modif, id);\n        }\n        this.entities[id] = entity;\n        if(entity.tags && entity.tags.length) {\n            entity.tags.forEach(tag => {\n                if(!this.entitiesByTags[tag]) {\n                    this.entitiesByTags[tag] = [];\n                }\n                this.entitiesByTags[tag].push(id)\n            })\n        }\n\n        // console.log('Active modifiers: ', resourceModifiers.modifiers, resourceModifiers.modifiersGroupped);\n        return this.entities[id];\n    }\n\n    unsetEntity(id) {\n        if(!this.entities[id]) return;\n\n        if(this.entities[id].modifier) {\n            if(this.entities[id].modifierGroupId) {\n                this.entities[id].modifier.entityRefs = this.entities[id].modifier.entityRefs.filter(eId => eId !== id);\n                // reassertModifierLevel\n                const lvl = this.reassertModifierLevel(this.entities[id].modifier);\n                _resources_resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.updateModifierLevel(this.entities[id].modifier.id, lvl);\n                console.warn('NEWLV: ', this.entities[id].modifier.id, lvl, this.entities[id].modifier.entityRefs);\n            }\n            if(!this.entities[id].modifier.entityRefs?.length) {\n                _resources_resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.unsetModifier(this.entities[id].modifier.id);\n            }\n\n        }\n\n        delete this.entities[id];\n\n        for(const tag in this.entitiesByTags) {\n            this.entitiesByTags[tag] = this.entitiesByTags[tag].filter(ent => ent !== id);\n        }\n    }\n\n    getEntityEfficiency(id) {\n        return this.getEntity(id).modifier ? this.getEntity(id).modifier.efficiency : 1\n    }\n\n    listEntitiesByTags(tags, isOr = false, excludeIds = []) {\n        let suitableIds = []\n        if(isOr) {\n            suitableIds = tags.reduce((acc, tag) => [...acc, ...(this.entitiesByTags[tag] || [])], []);\n        } else {\n            suitableIds = [...(this.entitiesByTags[tags[0]] || [])];\n            for(let i = 1; i < tags.length; i++) {\n                suitableIds = suitableIds.filter(st => (this.entitiesByTags[tags[i]] || []).includes(st))\n            }\n        }\n        if(excludeIds && excludeIds.length) {\n            suitableIds = suitableIds.filter(id => !excludeIds.includes(id))\n        }\n        return suitableIds.map(id => ({\n            ...this.getEntity(id),\n            isUnlocked: this.isEntityUnlocked(id),\n            isCapped: this.isCapped(id),\n            efficiency: this.getEntityEfficiency(id),\n            nextUnlock: this.getNextEntityUnlock(id)\n        }));\n    }\n\n    checkUnlockedBy(unlockedBy) {\n        for(const unlockInfo of unlockedBy) {\n            if(unlockInfo.type === 'entity') {\n                if(this.getLevel(unlockInfo.id) < unlockInfo.level) {\n                    return false;\n                }\n            }\n            if(unlockInfo.type === 'effect') {\n                if(_resources_game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.getEffectValue(unlockInfo.id) < unlockInfo.level) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n\n    isEntityUnlocked(id) {\n        const entity = this.getEntity(id);\n\n        if(entity.unlockedBy) {\n            const unlockedByCheck = this.checkUnlockedBy(entity.unlockedBy);\n            if(!unlockedByCheck) return false;\n        }\n        return !this.getEntity(id).unlockCondition || this.getEntity(id).unlockCondition();\n    }\n\n    getNextEntityUnlock(id) {\n        const entity = this.getEntity(id);\n\n        if(!_utils_unlocks__WEBPACK_IMPORTED_MODULE_6__.gameUnlocks.unlockMapping['entity']?.[id]) return null;\n\n        return _utils_unlocks__WEBPACK_IMPORTED_MODULE_6__.gameUnlocks.findNextUnlock(_utils_unlocks__WEBPACK_IMPORTED_MODULE_6__.gameUnlocks.unlockMapping['entity'][id], entity.level);\n    }\n\n    fetchAllUnlocks() {\n        const result = [];\n        for (const unlockerId in _utils_unlocks__WEBPACK_IMPORTED_MODULE_6__.gameUnlocks.unlockMapping['entity']) {\n            if(this.isEntityUnlocked(unlockerId)) {\n                result.push({...this.getEntity(unlockerId), nextUnlock: this.getNextEntityUnlock(unlockerId)})\n            }\n        }\n    }\n\n    countEntitiesByTags(tags, isOr = false, excludeIds = []) {\n        let suitableIds = []\n        if(isOr) {\n            suitableIds = tags.reduce((acc, tag) => [...acc, ...(this.entitiesByTags[tag] || [])], []);\n        } else {\n            suitableIds = [...(this.entitiesByTags[tags[0]] || [])];\n            for(let i = 1; i < tags.length; i++) {\n                suitableIds = suitableIds.filter(st => (this.entitiesByTags[tags[i]] || []).find(st))\n            }\n        }\n        if(excludeIds && excludeIds.length) {\n            suitableIds = suitableIds.filter(id => !excludeIds.includes(id))\n        }\n        return suitableIds.map(id => ({\n            ...this.entities[id],\n        })).reduce((acc, item) => acc += item.level, 0);\n    }\n\n    getEntity(id) {\n        if(!this.entities[id]) {\n            throw new Error(`Not found entity ${id}`);\n        }\n\n        return this.entities[id];\n    }\n\n    entityExists(id) {\n        return (id in this.entities);\n    }\n\n    isCapped(id) {\n        return (this.getEntity(id).maxLevel || (this.getEntity(id).getMaxLevel ? this.getEntity(id).getMaxLevel() : 1.e+308)) <= this.entities[id].level\n    }\n\n    getLevelupCost(id, addLvl = 0) {\n        const current = this.getEntity(id);\n        if(current.get_cost) {\n            current.cost = current.get_cost();\n        }\n        if(current.cost) {\n            const totalCost = {};\n            for(const rsId in current.cost) {\n                const costs = _utils_formulas__WEBPACK_IMPORTED_MODULE_2__.Formulas.calculateValue(current.cost[rsId], current.level + addLvl);\n                totalCost[rsId] = costs;\n            }\n            return totalCost;\n        }\n        return null;\n    }\n\n    getEntityMaxLevel(id) {\n        const current = this.getEntity(id);\n        let max;\n        if(current.getMaxLevel) {\n            max = current.getMaxLevel();\n        } else\n        if(current.maxLevel || current.maxLevel === 0) {\n            max = current.maxLevel;\n        }\n\n       return max;\n    }\n\n    getEntityCapped(id, addLvl = 0) {\n        const current = this.getEntity(id);\n        let max;\n        if(current.getMaxLevel) {\n            max = current.getMaxLevel();\n        } else\n        if(current.maxLevel || current.maxLevel === 0) {\n            max = current.maxLevel;\n        }\n\n        if(max || max === 0) {\n            if(max <= current.level + addLvl) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    reassertModifierLevel(modifier) {\n        if(!modifier.entityRefs?.length) {\n            return modifier.level;\n        }\n        return modifier.entityRefs.reduce((acc, id) => acc + this.getLevel(id), 0);\n    }\n\n    levelUpEntity(id) {\n        const isUnlocked = this.isEntityUnlocked(id);\n\n        if(!isUnlocked) {\n            return {\n                success: false,\n                reason: 'isLocked',\n            }\n        }\n        const current = this.getEntity(id);\n        let max;\n        if(current.getMaxLevel) {\n            max = current.getMaxLevel();\n        } else\n        if(current.maxLevel || current.maxLevel === 0) {\n            max = current.maxLevel;\n        }\n\n        if(max || max === 0) {\n            if(max <= current.level) {\n                return {\n                    success: false,\n                    reason: {\n                        maxLevel: max,\n                        level: current.level\n                    },\n                }\n            }\n        }\n        const costs = this.getLevelupCost(id);\n        if(costs) {\n            const affordable = _resources_resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.isAffordable(costs);\n            if(!affordable.isAffordable) {\n                return {\n                    success: false,\n                    reason: affordable,\n                }\n            }\n            for(const rsId in costs) {\n                _resources_game_resources__WEBPACK_IMPORTED_MODULE_4__.gameResources.addResource(rsId, -costs[rsId]);\n            }\n        }\n        this.setEntityLevel(id, current.level + 1);\n        return {\n            success: true\n        }\n    }\n\n    setEntityLevel(id, level, bForce = false) {\n        const current = this.getEntity(id);\n        if(!bForce) {\n            const isUnlocked = this.isEntityUnlocked(id);\n\n            if(!isUnlocked) {\n                return false;\n            }\n            let max;\n            if(current.getMaxLevel) {\n                max = current.getMaxLevel();\n            } else\n            if(current.maxLevel || current.maxLevel === 0) {\n                max = current.maxLevel;\n            }\n\n            if(max || max === 0) {\n                if(max <= level) {\n                    level = max;\n                }\n            }\n        }\n\n        if(current.modifier?.id) {\n            let levelToSet = level;\n            if(current.modifier.entityRefs) {\n                levelToSet = this.reassertModifierLevel(current.modifier) + level - current.level;\n            }\n            _resources_resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.updateModifierLevel(current.modifier.id, levelToSet);\n        }\n        const pLev = current.level;\n        current.level = level;\n        if(current.onLevelSet) {\n            current.onLevelSet(current.level, pLev)\n        }\n        return current;\n    }\n\n    getLevel(id) {\n        return this.getEntity(id).level;\n    }\n\n    getGroupLevel(id) {\n        const modiff = _resources_resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(id);\n        return this.reassertModifierLevel(modiff);\n    }\n\n    getAffordable(id, addLvl = 0) {\n        const costs = this.getLevelupCost(id, addLvl);\n        if(costs) {\n            const affordable = _resources_resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.isAffordable(costs);\n            return affordable;\n        }\n        return {\n            isAffordable: true\n        }\n    }\n\n    getDependanciesBreakdown(id, exludeArr = []) {\n\n        const entity = this.getEntity(id);\n        if(!entity.modifier) return;\n        const deps = entity.modifier.effectDeps;\n\n        if(!deps.length) return;\n\n        const depsToAssert = deps.filter(dep => !exludeArr.includes(dep));\n\n        if(!depsToAssert.length) return;\n\n        return depsToAssert.map(dep => {\n\n            return {\n                effect: _resources_game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.getEffect(dep),\n                breakDown: _resources_resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.getEffectBreakdowns(dep)\n            }\n        })\n    }\n\n    getEffects(id, addLvl = 0, lvl = null, calculateForAbstract = false, customMultiplier = 1, customEfficiency = 1) {\n\n        const result = [];\n        const entity = this.entities[id];\n\n        if(lvl == null) {\n            lvl = entity.level;\n        }\n\n        const unpack = (object, type, scope, intensityMultiplier = 1.) => {\n            if(!object?.[scope]?.[type]) return [];\n            const toUnpack = object?.[scope]?.[type];\n            const results = [];\n            for(const key in toUnpack) {\n                const formula = toUnpack[key];\n                const efft = type === 'resources' ? _resources_game_resources__WEBPACK_IMPORTED_MODULE_4__.gameResources.getResource(key) : _resources_game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.getEffect(key);\n                if(efft.unlockCondition) {\n                    if(!efft.unlockCondition()) {\n                        continue;\n                    }\n                }\n                try {\n                    if(!object.customAmplifierApplyTypes.includes(type)) {\n                        intensityMultiplier = 1.;\n                    }\n                } catch (e) {\n                    console.warn('Undefined uplifier types: '+id, object);\n                    throw e;\n                }\n\n                const basic_name = efft.name;\n                let lvlToCalc = lvl + addLvl;\n                let customMultiplierLocal = customMultiplier;\n                let val = customMultiplierLocal*_utils_formulas__WEBPACK_IMPORTED_MODULE_2__.Formulas.calculateValue(formula, lvlToCalc);\n                if(scope === 'multiplier' || scope === 'capMult') {\n                    val = 1 + (val - 1) * customEfficiency*intensityMultiplier;\n                } else {\n                    val = val * customEfficiency*intensityMultiplier;\n                }\n                const item = {\n                    id: key,\n                    name: basic_name,\n                    value: val,\n                    scope,\n                    type,\n                    isPercentage: efft.isPercentage\n                };\n                if(item.value == null || Math.abs(item.value) < _utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER) {\n                    continue;\n                }\n                if((scope === 'multiplier' || scope === 'capMult') && (Math.abs(item.value - 1) < _utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER)) {\n                    continue;\n                }\n                results.push(item);\n            }\n            return results;\n        }\n\n        let modif = entity.modifier;\n\n        if(entity.isAbstract && calculateForAbstract) {\n            modif = entity.resourceModifier;\n\n            if(modif) {\n                // checkCallables\n                ['income', 'multiplier', 'consumption', 'rawCap', 'capMult'].forEach(scope => {\n                    if(modif[`get_${scope}`]) {\n                        modif[scope] = modif[`get_${scope}`]();\n                    }\n                })\n            }\n        }\n\n        if(!modif) {\n            return result;\n        }\n\n        let intensityMultiplier = 1.;\n        if(modif.getCustomAmplifier) {\n            intensityMultiplier = modif.getCustomAmplifier();\n            // console.log('CustomAmpl: ', id, modif.getCustomAmplifier());\n        }\n\n        // console.log('CustomMult: ', id, intensityMultiplier);\n\n        result.push(\n            ...unpack(modif, 'resources', 'income', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'income', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'multiplier', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'multiplier', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'rawCap', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'rawCap', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'capMult', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'capMult', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'consumption', intensityMultiplier)\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'consumption', intensityMultiplier)\n        )\n        return result;\n    }\n\n    getAttributes(id) {\n        const entity = this.getEntity(id);\n        if(entity.get_attributes) {\n            return Object.entries(entity.get_attributes()).map(([name, value]) => ({\n                name,\n                value\n            }));\n        }\n        return Object.entries(entity.attributes).map(([name, value]) => ({\n            name,\n            value\n        }));\n    }\n\n    setAttribute(id, attributeId, value) {\n        const entity = this.getEntity(id);\n\n        if(!entity.attributes) {\n            entity.attributes = {};\n        }\n\n        entity.attributes[attributeId] = value;\n    }\n\n    getAttribute(id, attributeId, defaultValue) {\n        const entity = this.getEntity(id);\n\n        if(!entity.attributes) {\n            entity.attributes = {};\n        }\n\n        return entity.attributes[attributeId] || defaultValue;\n    }\n\n    getAttributesObject(id) {\n        const entity = this.getEntity(id);\n        if(entity.get_attributes) {\n            return entity.get_attributes();\n        }\n        return entity.attributes || {};\n    }\n\n}\n\nconst gameEntity = GameEntity.instance || new GameEntity();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/game-entity/game-entity.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/game-entity/index.js":
/*!**************************************************************!*\
  !*** ./node_modules/game-framework/src/game-entity/index.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   gameEntity: () => (/* reexport safe */ _game_entity__WEBPACK_IMPORTED_MODULE_0__.gameEntity)\n/* harmony export */ });\n/* harmony import */ var _game_entity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./game-entity */ \"./node_modules/game-framework/src/game-entity/game-entity.js\");\n\n\n\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/game-entity/index.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/index.js":
/*!**************************************************!*\
  !*** ./node_modules/game-framework/src/index.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GameCore: () => (/* reexport safe */ _core__WEBPACK_IMPORTED_MODULE_0__.GameCore),\n/* harmony export */   gameCore: () => (/* reexport safe */ _core__WEBPACK_IMPORTED_MODULE_0__.gameCore),\n/* harmony export */   gameEffects: () => (/* reexport safe */ _resources__WEBPACK_IMPORTED_MODULE_1__.gameEffects),\n/* harmony export */   gameEntity: () => (/* reexport safe */ _game_entity__WEBPACK_IMPORTED_MODULE_2__.gameEntity),\n/* harmony export */   gameResources: () => (/* reexport safe */ _resources__WEBPACK_IMPORTED_MODULE_1__.gameResources),\n/* harmony export */   resourceApi: () => (/* reexport safe */ _resources__WEBPACK_IMPORTED_MODULE_1__.resourceApi),\n/* harmony export */   resourceCalculators: () => (/* reexport safe */ _resources__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators),\n/* harmony export */   resourceModifiers: () => (/* reexport safe */ _resources__WEBPACK_IMPORTED_MODULE_1__.resourceModifiers),\n/* harmony export */   resourcesManager: () => (/* reexport safe */ _resources__WEBPACK_IMPORTED_MODULE_1__.resourcesManager)\n/* harmony export */ });\n/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./core */ \"./node_modules/game-framework/src/core/index.js\");\n/* harmony import */ var _resources__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./resources */ \"./node_modules/game-framework/src/resources/index.js\");\n/* harmony import */ var _game_entity__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./game-entity */ \"./node_modules/game-framework/src/game-entity/index.js\");\n\n\n\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/index.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/resources/game-effects.js":
/*!*******************************************************************!*\
  !*** ./node_modules/game-framework/src/resources/game-effects.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   gameEffects: () => (/* binding */ gameEffects)\n/* harmony export */ });\n/* harmony import */ var _utils_unlocks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/unlocks */ \"./node_modules/game-framework/src/utils/unlocks.js\");\n\n\nclass GameEffects {\n\n    constructor() {\n        GameEffects.instance = this;\n        this.effects = {};\n        this.effectsByTags = {};\n    }\n\n    registerEffect(id, effect) {\n        if(!effect.defaultValue) {\n            effect.defaultValue = 0;\n        }\n        if(!effect.defaultCap) {\n            effect.defaultCap = 0;\n        }\n        effect.value = effect.defaultValue ?? 0;\n        effect.income = effect.income ?? 0;\n        effect.multiplier = effect.multiplier ?? 1;\n        effect.consumption = effect.consumption ?? 0;\n        effect.rawCap = effect.rawCap ?? 0;\n        effect.capMult = effect.capMult ?? 0;\n        effect.tags = effect.tags ?? [];\n        this.effects[id] = effect;\n\n        if(effect.minValue !== null) {\n            effect.value = Math.max(effect.value, effect.minValue);\n        }\n\n        if(effect.tags) {\n            effect.tags.forEach(tag => {\n                if(!this.effectsByTags[tag]) {\n                    this.effectsByTags[tag] = [];\n                }\n                this.effectsByTags[tag].push(id);\n            })\n        }\n    }\n\n    getEffect(id) {\n        if(!this.effects[id]) {\n            throw new Error('Undefined effect - '+id);\n        }\n        return this.effects[id];\n    }\n\n    getEffectValue(id) {\n        return this.getEffect(id).value;\n    }\n\n    assertValue(id) {\n        const rs = this.getEffect(id);\n        rs.value = Math.min((rs.income + rs.defaultValue)*rs.multiplier - rs.consumption, rs.hasCap ? rs.cap : 1.e+308);\n        if(rs.minValue !== null) {\n            rs.value = Math.max(rs.minValue, rs.value);\n        }\n        return rs.value;\n    }\n\n    assertCap(id) {\n        const rs = this.getEffect(id);\n        rs.cap = (rs.rawCap + rs.defaultCap)*rs.capMult;\n        return rs.cap;\n    }\n\n    setEffectRawIncome(id, income) {\n        const rs = this.getEffect(id);\n        rs.income = income;\n        this.assertValue(id);\n    }\n\n    setEffectRawConsumption(id, consumption) {\n        const rs = this.getEffect(id);\n        rs.consumption = consumption;\n        this.assertValue(id);\n    }\n\n    setEffectMultiplier(id, multiplier) {\n        const rs = this.getEffect(id);\n        rs.multiplier = multiplier;\n        this.assertValue(id);\n    }\n\n    setEffectRawCap(id, cap) {\n        const rs = this.getEffect(id);\n        rs.rawCap = cap;\n        this.assertCap(id);\n    }\n\n    setEffectCapMult(id, capMult) {\n        const rs = this.getEffect(id);\n        rs.capMult = capMult;\n        this.assertCap(id);\n    }\n\n    setBreakDown(id, breakDown) {\n        const rs = this.getEffect(id);\n        rs.breakDown = breakDown;\n    }\n\n    getBreakdown(id) {\n        const rs = this.getEffect(id);\n        return rs.breakDown || {};\n    }\n\n    listEffectsByTags(tags, isOr = false, excludeIds = []) {\n        let suitableIds = []\n        if(isOr) {\n            suitableIds = tags.reduce((acc, tag) => [...acc, ...(this.effectsByTags[tag] || [])], []);\n        } else {\n            suitableIds = [...(this.effectsByTags[tags[0]] || [])];\n            for(let i = 1; i < tags.length; i++) {\n                suitableIds = suitableIds.filter(st => (this.effectsByTags[tags[i]] || []).find(st))\n            }\n        }\n        if(excludeIds && excludeIds.length) {\n            suitableIds = suitableIds.filter(id => !excludeIds.includes(id))\n        }\n        return suitableIds.map(id => ({\n            id,\n            ...this.effects[id],\n            isUnlocked: !this.effects[id].unlockCondition || this.effects[id].unlockCondition(),\n            nextUnlock: this.getNextEffectUnlock(id)\n        }));\n    }\n\n    getNextEffectUnlock(id) {\n        const effect = this.getEffectValue(id);\n\n        if(!_utils_unlocks__WEBPACK_IMPORTED_MODULE_0__.gameUnlocks.unlockMapping['effect']?.[id]) return null;\n\n        return _utils_unlocks__WEBPACK_IMPORTED_MODULE_0__.gameUnlocks.findNextUnlock(_utils_unlocks__WEBPACK_IMPORTED_MODULE_0__.gameUnlocks.unlockMapping['effect'][id], effect);\n    }\n\n    isEffectUnlocked(id) {\n        return !this.getEffect(id).unlockCondition || this.getEffect(id).unlockCondition();\n    }\n\n    fetchAllUnlocks() {\n        const result = [];\n        for (const unlockerId in _utils_unlocks__WEBPACK_IMPORTED_MODULE_0__.gameUnlocks.unlockMapping['effect']) {\n            if(this.isEffectUnlocked(unlockerId)) {\n                result.push({...this.getEffect(unlockerId), nextUnlock: this.getNextEffectUnlock(unlockerId)})\n            }\n        }\n    }\n}\n\nconst gameEffects = GameEffects.instance || new GameEffects();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/resources/game-effects.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/resources/game-resources.js":
/*!*********************************************************************!*\
  !*** ./node_modules/game-framework/src/resources/game-resources.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   gameResources: () => (/* binding */ gameResources)\n/* harmony export */ });\n/* harmony import */ var _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./resource-modifiers */ \"./node_modules/game-framework/src/resources/resource-modifiers.js\");\n/* harmony import */ var _resource_calculators__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./resource-calculators */ \"./node_modules/game-framework/src/resources/resource-calculators.js\");\n/* harmony import */ var _utils_consts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\n\n\n\n\nclass GameResources {\n\n    constructor() {\n        this.resources = {};\n        this.resourcesByTags = {};\n        this.delayedResets = {};\n        GameResources.instance = this;\n    }\n\n    registerResource(id, resource) {\n        if(resource.resourceModifier && !resource.isAbstract) {\n            const modif = {...resource.resourceModifier};\n            if(!modif.id) {\n                modif.id = `resource_${id}`\n            }\n            modif.name = resource.name;\n            resource.modifier = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.registerModifier(modif);\n        }\n        this.resources[id] = resource;\n        this.resources[id].id = id;\n        if(!this.resources[id].amount) {\n            this.resources[id].amount = 0;\n        }\n        if(!this.resources[id].defaultCap) {\n            this.resources[id].defaultCap = 0;\n        }\n        if(!this.resources[id].targetEfficiency) {\n            this.resources[id].targetEfficiency = 1;\n        }\n        if(resource.tags) {\n            resource.tags.forEach(tag => {\n                if(!this.resourcesByTags[tag]) {\n                    this.resourcesByTags[tag] = [];\n                }\n                this.resourcesByTags[tag].push(id);\n            })\n        }\n    }\n\n    getResource(id) {\n        const rs = this.resources[id];\n        if(!rs) {\n            throw new Error(`Try to add undefined resource: ${id}`);\n        }\n        return rs;\n    }\n\n\n    isResourceUnlocked(id) {\n        return !this.resources[id].unlockCondition || this.resources[id].unlockCondition()\n    }\n\n    listMissing() {\n        const result = {};\n        for(const key in this.resources) {\n            if(this.resources[key].targetEfficiency < 1) {\n                result[key] = this.resources[key].targetEfficiency;\n            }\n        }\n        return result;\n    }\n\n\n    assertToCapOrEmpty(id) {\n        const rs = this.getResource(id);\n        if(rs.balance > 0) {\n            return (rs.cap - rs.amount) / rs.balance;\n        } else {\n            return (rs.amount / rs.balance)\n        }\n    }\n\n    listResourcesByTags(tags, isOr = false, excludeIds = []) {\n        let suitableIds = []\n        if(isOr) {\n            suitableIds = tags.reduce((acc, tag) => [...acc, ...(this.resourcesByTags[tag] || [])], []);\n        } else {\n            suitableIds = [...(this.resourcesByTags[tags[0]] || [])];\n            for(let i = 1; i < tags.length; i++) {\n                suitableIds = suitableIds.filter(st => (this.resourcesByTags[tags[i]] || []).includes(st))\n            }\n        }\n        if(excludeIds && excludeIds.length) {\n            suitableIds = suitableIds.filter(id => !excludeIds.includes(id))\n        }\n        return suitableIds.map(id => ({\n            id,\n            ...this.resources[id],\n            isUnlocked: !this.resources[id].unlockCondition || this.resources[id].unlockCondition()\n        }));\n    }\n\n    assertBalance(id) {\n        const rs = this.getResource(id);\n        rs.balance = rs.income*rs.multiplier - rs.consumption;\n        return rs.balance;\n    }\n\n    assertCap(id) {\n        const rs = this.getResource(id);\n        rs.cap = (rs.rawCap + rs.defaultCap)*rs.capMult;\n        return rs.cap;\n    }\n\n    addResource(id, amount, isDelayed = false) {\n        const rs = this.getResource(id);\n        if(rs.unlockCondition && !rs.unlockCondition()) return ;\n        if(rs.isService) return ;\n        const amtToAdd = rs.hasCap ? Math.min(amount, rs.cap - (rs.amount || 0) ) : amount;\n        if(rs.amount < 0) {\n            rs.amount = 0;\n        }\n        rs.amount += amtToAdd;\n        if(rs.modifier && amtToAdd !== 0) {\n            rs.modifier.level = rs.amount;\n            _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.regenerateModifier(rs.modifier.id);\n            console.log('rs.mod', rs.modifier);\n        }\n        if(amtToAdd > _utils_consts__WEBPACK_IMPORTED_MODULE_2__.SMALL_NUMBER*rs.consumption && rs.targetEfficiency < 1) {\n            if(isDelayed) {\n                this.delayedResets[id] = amtToAdd;\n            } else {\n                _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.resetConsumingEfficiency(id, true);\n            }\n        }\n        if(amtToAdd) {\n            _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResourceDeps[id]?.forEach(modifierId => {\n                _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.cacheModifier(modifierId);\n                _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.regenerateModifier(modifierId)\n            })\n        }\n        return rs.amount;\n    }\n\n    setResource(id, amount, bPreventReset = false, delayedReset = false) {\n        const rs = this.getResource(id);\n        const pAmount = rs.amount;\n        rs.amount = amount;\n        if(rs.amount < 0) {\n            rs.amount = 0;\n        }\n        if(rs.modifier && amount > 0) {\n            rs.modifier.level = rs.amount;\n            _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.regenerateModifier(rs.modifier.id);\n            console.log('rs.mod', rs.modifier);\n        }\n        if(pAmount !== rs.amount && Math.abs((pAmount - rs.amount) / (pAmount + rs.amount)) > _utils_consts__WEBPACK_IMPORTED_MODULE_2__.SMALL_NUMBER) {\n            if(rs.isService && rs.targetEfficiency < 1 && !bPreventReset) {\n                console.log('resetEffService: ', rs, pAmount, amount, delayedReset);\n                if(delayedReset) {\n                    this.delayedResets[id] = amount;\n                } else {\n                    _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.resetConsumingEfficiency(id, true);\n                }\n\n            }\n            _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResourceDeps[id]?.forEach(modifierId => {\n                _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.cacheModifier(modifierId);\n                _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.regenerateModifier(modifierId)\n            })\n            if(rs.modifier) {\n                rs.modifier.level = rs.amount;\n                _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.regenerateModifier(rs.modifier.id);\n                console.log('rs.mod.setResource', rs.modifier);\n            }\n        }\n        return rs.amount;\n    }\n\n    handleDelayed() {\n        for(const id in this.delayedResets) {\n            _resource_calculators__WEBPACK_IMPORTED_MODULE_1__.resourceCalculators.resetConsumingEfficiency(id, true);\n        }\n        this.delayedResets = {};\n    }\n\n    setResourceRawIncome(id, income) {\n        const rs = this.getResource(id);\n        rs.income = income;\n        this.assertBalance(id);\n    }\n\n    setResourceRawConsumption(id, consumption) {\n        const rs = this.getResource(id);\n        rs.consumption = consumption;\n        this.assertBalance(id);\n    }\n\n    setResourceMultiplier(id, multiplier) {\n        const rs = this.getResource(id);\n        rs.multiplier = multiplier;\n        this.assertBalance(id);\n    }\n\n    setResourceRawCap(id, cap) {\n        const rs = this.getResource(id);\n        rs.rawCap = cap;\n        this.assertCap(id);\n    }\n\n    setResourceCapMult(id, capMult) {\n        const rs = this.getResource(id);\n        rs.capMult = capMult;\n        this.assertCap(id);\n    }\n\n    setBreakdown(id, breakDown, storageBreakdown) {\n        const rs = this.getResource(id);\n        rs.breakDown = breakDown;\n        rs.storageBreakdown = storageBreakdown;\n    }\n\n    save() {\n        const obj = {};\n        for(const rsId in this.resources) {\n            obj[rsId] = this.resources[rsId].amount;\n        }\n        return obj;\n    }\n\n    load(obj) {\n        for(const rsId in obj) {\n            this.setResource(rsId, obj[rsId]);\n        }\n        return obj;\n    }\n\n}\n\nconst gameResources = GameResources.instance || new GameResources();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/resources/game-resources.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/resources/index.js":
/*!************************************************************!*\
  !*** ./node_modules/game-framework/src/resources/index.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   gameEffects: () => (/* reexport safe */ _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects),\n/* harmony export */   gameResources: () => (/* reexport safe */ _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources),\n/* harmony export */   resourceApi: () => (/* reexport safe */ _resource_api__WEBPACK_IMPORTED_MODULE_4__.resourceApi),\n/* harmony export */   resourceCalculators: () => (/* reexport safe */ _resource_calculators__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators),\n/* harmony export */   resourceModifiers: () => (/* reexport safe */ _resource_modifiers__WEBPACK_IMPORTED_MODULE_1__.resourceModifiers),\n/* harmony export */   resourcesManager: () => (/* binding */ resourcesManager)\n/* harmony export */ });\n/* harmony import */ var _game_resources__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./game-resources */ \"./node_modules/game-framework/src/resources/game-resources.js\");\n/* harmony import */ var _resource_modifiers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./resource-modifiers */ \"./node_modules/game-framework/src/resources/resource-modifiers.js\");\n/* harmony import */ var _resource_calculators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./resource-calculators */ \"./node_modules/game-framework/src/resources/resource-calculators.js\");\n/* harmony import */ var _game_effects__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./game-effects */ \"./node_modules/game-framework/src/resources/game-effects.js\");\n/* harmony import */ var _resource_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./resource-api */ \"./node_modules/game-framework/src/resources/resource-api.js\");\n/* harmony import */ var _utils_consts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\n\n\n\n\n\n\n\nclass ResourcesManager {\n\n    constructor() {\n        ResourcesManager.instance = this;\n    }\n\n    initialize() {\n        for(const resourceId in _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources) {\n            _resource_calculators__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators.assertResource(resourceId);\n        }\n    }\n\n    tick(dT) {\n        let isAssertsFinished = false;\n        const start = performance.now();\n        // console.log('iter started: ', JSON.parse(JSON.stringify(gameResources.resources['crafting_ability'])));\n        _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.handleDelayed();\n        let maxIter = 10;\n        let iter = 0;\n        // console.log('START_ITER: EntEEF', resourceModifiers.getModifier('entity_runningAction').efficiency);\n        // console.log('asserting: ', JSON.parse(JSON.stringify(gameResources.resources['crafting_ability'])));\n        let resourcesToUpdate = [];\n        for (const resourceId in _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources) {\n            resourcesToUpdate.push(resourceId);\n        }\n\n        while(!isAssertsFinished) {\n            isAssertsFinished = true;\n            iter++;\n            let newResourcesToUpdate = [];\n            for(const resourceId of resourcesToUpdate) {\n                if(_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].balance) {\n                    if(_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].isService && _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].balance < -_utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER) {\n                        // we are missing service resource\n                        const effPercentage = _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].multiplier * _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].income / _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].consumption;\n                        const togg = _resource_calculators__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators.toggleConsumingEfficiency(resourceId, effPercentage, true);\n                        newResourcesToUpdate.push(...togg.affectedResourceIds)\n                        _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].isMissing = true;\n                        _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].amount = 0;\n                        _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency = effPercentage * _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency;\n                        console.log(`Iter${iter}: ${resourceId} is missing: `, effPercentage, _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency, _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.listMissing(), JSON.parse(JSON.stringify(_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId])))\n                        isAssertsFinished = false;\n                    } else\n                    if(-1*_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].balance*dT - _utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER > _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].amount) {\n                        // now we should retain list of stuff consuming\n                        const effPercentage = _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].multiplier * _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].income / _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].consumption;\n                        // console.log('resource is finishing: ', resourceId, gameResources.resources[resourceId].balance, effPercentage);\n                        const togg = _resource_calculators__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators.toggleConsumingEfficiency(resourceId, effPercentage, true);\n                        newResourcesToUpdate.push(...togg.affectedResourceIds)\n                        _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].isMissing = true;\n                        _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].amount = 0;\n                        _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency = effPercentage * _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency;\n                        console.log(`Iter${iter}: ${resourceId} is missing: `, effPercentage, _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency, _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.listMissing(), JSON.parse(JSON.stringify(_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId])))\n                        isAssertsFinished = false;\n                    } else {\n                        if (_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].isMissing && _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].balance > 0) {\n                            // console.log('Toggling '+resourceId);\n                            //    100%     . (crafting_ability)\n                            //          resourceModifiers,    -  \n                            //       1,      - ,    \n                            // ,      ,    > 0    .\n                            //       \n                            //     ,     > 0,    -  \n                            //  ,      ,      .\n                            //         \n                            //       -  ,     ,\n                            //    \n                            // ,       crafting_ability -    \n                            //    resourceId,   \n                            const prEff = _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency;\n                            const exceedFactor = _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].consumption\n                                ? _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].multiplier * _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].income / _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].consumption\n                                : 1./Math.max(_utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER, prEff);\n                            const affected = _resource_calculators__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators.toggleConsumingEfficiency(resourceId, exceedFactor, true);\n                            _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency = prEff * exceedFactor;\n                            _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].isMissing = _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].targetEfficiency < 1;\n                            const prUp = [...newResourcesToUpdate];\n                            newResourcesToUpdate.push(resourceId);\n                            if(affected.affectedResources) {\n                                newResourcesToUpdate.push(...affected.affectedResources);\n                            }\n                            console.log(`Iter${iter}: Toggling `+resourceId, prEff, 1./(_utils_consts__WEBPACK_IMPORTED_MODULE_5__.SMALL_NUMBER + prEff), exceedFactor, JSON.parse(JSON.stringify(newResourcesToUpdate)), _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.listMissing(), JSON.parse(JSON.stringify(_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId])));\n                            isAssertsFinished = false;\n                        }\n                    }\n                    resourcesToUpdate = [...new Set(newResourcesToUpdate)];\n                }\n            }\n            // console.log(`Iter: ${iter}`, resourcesToUpdate.length, newResourcesToUpdate, JSON.parse(JSON.stringify(gameResources.resources)));\n            if(iter > maxIter) {\n                console.error('CRITICAL ERROR: not able to find resources divergence.', JSON.parse(JSON.stringify(_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources)), _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.listMissing());\n                isAssertsFinished = true;\n            }\n        }\n        const end = performance.now();\n        // console.log('FINISH_ITER: EntEEF', end - start, resourceModifiers.getModifier('entity_runningAction').efficiency);\n\n        for(const resourceId in _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources) {\n            if(_game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].isService) {\n                _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.setResource(resourceId, _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].balance, false, true);\n            } else {\n                _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.addResource(resourceId, _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.resources[resourceId].balance*dT, true);\n            }\n\n        }\n\n\n        // console.log('iter ended: ', JSON.parse(JSON.stringify(gameResources.resources['crafting_ability'])));\n\n        // console.log('END_UP: EntEEF', resourceModifiers.getModifier('entity_runningAction').efficiency);\n\n    }\n\n    reassertAll() {\n        for(const modifierId in _resource_modifiers__WEBPACK_IMPORTED_MODULE_1__.resourceModifiers.modifiers) {\n            _resource_modifiers__WEBPACK_IMPORTED_MODULE_1__.resourceModifiers.cacheModifier(modifierId);\n            _resource_calculators__WEBPACK_IMPORTED_MODULE_2__.resourceCalculators.regenerateModifier(modifierId)\n        }\n\n    }\n\n}\n\nconst resourcesManager = ResourcesManager.instance || new ResourcesManager();\n\n\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/resources/index.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/resources/resource-api.js":
/*!*******************************************************************!*\
  !*** ./node_modules/game-framework/src/resources/resource-api.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ResourceApi: () => (/* binding */ ResourceApi),\n/* harmony export */   resourceApi: () => (/* binding */ resourceApi)\n/* harmony export */ });\n/* harmony import */ var _game_resources__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./game-resources */ \"./node_modules/game-framework/src/resources/game-resources.js\");\n/* harmony import */ var _game_effects__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./game-effects */ \"./node_modules/game-framework/src/resources/game-effects.js\");\n/* harmony import */ var _utils_formulas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/formulas */ \"./node_modules/game-framework/src/utils/formulas.js\");\n/* harmony import */ var _utils_consts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\n\n\n\n\n\nclass ResourceApi {\n\n    constructor() {\n        ResourceApi.instance = this;\n    }\n\n    unpackEffects(effects, lvl, customMultiplier = 1) {\n\n        const result = [];\n\n        const unpack = (object, type, scope, intensityMultiplier = 1.) => {\n            if(!object?.[scope]?.[type]) return [];\n            const toUnpack = object?.[scope]?.[type];\n            const results = [];\n            for(const key in toUnpack) {\n                const formula = toUnpack[key];\n                const efft = type === 'resources' ? _game_resources__WEBPACK_IMPORTED_MODULE_0__.gameResources.getResource(key) : _game_effects__WEBPACK_IMPORTED_MODULE_1__.gameEffects.getEffect(key);\n                if(efft.unlockCondition) {\n                    if(!efft.unlockCondition()) {\n                        continue;\n                    }\n                }\n                const basic_name = efft.name;\n                const item = {\n                    id: key,\n                    name: basic_name,\n                    value: _utils_formulas__WEBPACK_IMPORTED_MODULE_2__.Formulas.calculateValue(formula, lvl)*customMultiplier,\n                    scope,\n                    type\n                };\n                if(item.value == null || Math.abs(item.value) < _utils_consts__WEBPACK_IMPORTED_MODULE_3__.SMALL_NUMBER) {\n                    continue;\n                }\n                if((key === 'multiplier' || key === 'capMult') && (Math.abs(item.value - 1) < _utils_consts__WEBPACK_IMPORTED_MODULE_3__.SMALL_NUMBER)) {\n                    continue;\n                }\n                results.push(item);\n            }\n            return results;\n        }\n\n        let modif = {};\n\n        ['income', 'multiplier', 'consumption', 'rawCap', 'capMult'].forEach(scope => {\n            if(effects[`get_${scope}`]) {\n                modif[scope] = effects[`get_${scope}`]();\n            } else if(effects[scope]) {\n                modif[scope] = effects[scope];\n            }\n        })\n\n        result.push(\n            ...unpack(modif, 'resources', 'income')\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'income')\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'multiplier')\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'multiplier')\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'rawCap')\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'rawCap')\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'capMult')\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'capMult')\n        )\n        result.push(\n            ...unpack(modif, 'resources', 'consumption')\n        )\n        result.push(\n            ...unpack(modif, 'effects', 'consumption')\n        )\n        return result;\n    }\n\n}\n\nconst resourceApi = ResourceApi.instance || new ResourceApi();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/resources/resource-api.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/resources/resource-calculators.js":
/*!***************************************************************************!*\
  !*** ./node_modules/game-framework/src/resources/resource-calculators.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   resourceCalculators: () => (/* binding */ resourceCalculators)\n/* harmony export */ });\n/* harmony import */ var _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./resource-modifiers */ \"./node_modules/game-framework/src/resources/resource-modifiers.js\");\n/* harmony import */ var _utils_formulas__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/formulas */ \"./node_modules/game-framework/src/utils/formulas.js\");\n/* harmony import */ var _game_resources__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./game-resources */ \"./node_modules/game-framework/src/resources/game-resources.js\");\n/* harmony import */ var _game_effects__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./game-effects */ \"./node_modules/game-framework/src/resources/game-effects.js\");\n/* harmony import */ var _utils_consts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/consts */ \"./node_modules/game-framework/src/utils/consts.js\");\n\n\n\n\n\n\nclass ResourceCalculators {\n    constructor() {\n        ResourceCalculators.instance = this;\n    }\n\n\n    getResourceBreakdowns(id) {\n        const byRes = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[id];\n\n        const modifiersBreakdown = {\n            income: [],\n            multiplier: [],\n            consumption: [],\n            rawCap: [],\n            capMult: [],\n            modifiers: 0,\n        };\n        byRes?.income?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.income?.effects?.[id]) {\n                const inc = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.income?.resources?.[id], rmod.level) * rmod.efficiency * intensityMultiplier;\n                if(inc != null && inc > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER) {\n\n                    modifiersBreakdown.income.push({\n                        id: mod,\n                        name: rmod.name,\n                        value: inc\n                    })\n                    modifiersBreakdown.modifiers++;\n                }\n            }\n        });\n        byRes?.multiplier?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.multiplier?.resources?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.multiplier?.resources?.[id], rmod.level * rmod.efficiency * intensityMultiplier);\n\n                modifiersBreakdown.multiplier.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n            }\n        });\n        byRes?.consumption?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.consumption?.effects?.[id]) {\n                const relevantEfficiency = rmod.consumption?.resources?.[id]?.ignoreEfficiency ? 1 : rmod.efficiency;\n                if (relevantEfficiency === 0) {\n                    return;\n                }\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.consumption?.resources?.[id], rmod.level) * relevantEfficiency * intensityMultiplier;\n                modifiersBreakdown.consumption.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n\n            }\n        });\n        byRes?.rawCap?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.rawCap?.effects?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.rawCap?.resources?.[id], rmod.level) * rmod.efficiency * intensityMultiplier;\n                modifiersBreakdown.rawCap.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n            }\n        });\n        byRes?.capMult?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n\n            if(rmod.capMult?.effects?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.capMult?.resources?.[id], rmod.level*rmod.efficiency*intensityMultiplier);\n                modifiersBreakdown.capMult.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n            }\n        });\n\n        return modifiersBreakdown;\n    }\n\n    assertResource(id, doUpdate = true, skipByTags = []) {\n        // now we walking through all the modifiers\n        let income = 0;\n        let multiplier = 1;\n        let consumption = 0;\n        let rawCap = 0;\n        let capMult = 1;\n        let effectIncome = 0;\n        let effectMultiplier = 1;\n\n        const modifiersBreakdown = {\n            income: [],\n            multiplier: [],\n            consumption: []\n        };\n\n        const storageBreakdown = {\n            income: [],\n            multiplier: []\n        }\n        //\n        const byRes = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[id];\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[id]?.income?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if(skipByTags.some(tag => rmod.tags.includes(tag))) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.income?.resources?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.income?.resources?.[id], rmod.level);\n                if(amt != null && Math.abs(amt) > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER) {\n                    income += amt * rmod.efficiency * intensityMultiplier;\n                    modifiersBreakdown.income.push({\n                        id: mod,\n                        name: rmod.name,\n                        value: amt * rmod.efficiency * intensityMultiplier\n                    })\n                }\n\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[id]?.multiplier?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if(skipByTags.some(tag => rmod.tags.includes(tag))) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.multiplier?.resources?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.multiplier?.resources?.[id], rmod.level * rmod.efficiency * intensityMultiplier);\n                multiplier *= amt;\n                if(Math.abs(amt - 1) > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER) {\n                    modifiersBreakdown.multiplier.push({\n                        id: mod,\n                        name: rmod.name,\n                        value: amt\n                    })\n                }\n\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[id]?.consumption?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if(skipByTags.some(tag => rmod.tags.includes(tag))) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.consumption?.resources?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.consumption?.resources?.[id], rmod.level);\n                const relevantEfficiency = rmod.consumption?.resources?.[id]?.ignoreEfficiency ? 1 : rmod.efficiency;\n                if (relevantEfficiency === 0) {\n                    return;\n                }\n                consumption += amt * relevantEfficiency * intensityMultiplier;\n                if(amt > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER) {\n                    modifiersBreakdown.consumption.push({\n                        id: mod,\n                        name: rmod.name,\n                        value: amt * relevantEfficiency * intensityMultiplier\n                    })\n                }\n\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[id]?.rawCap?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if(skipByTags.some(tag => rmod.tags.includes(tag))) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.rawCap?.resources?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.rawCap?.resources?.[id], rmod.level) * rmod.efficiency * intensityMultiplier;\n\n                rawCap += amt;\n                if(amt > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER) {\n                    storageBreakdown.income.push({\n                        id: mod,\n                        name: rmod.name,\n                        value: amt\n                    })\n                }\n\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[id]?.capMult?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if(skipByTags.some(tag => rmod.tags.includes(tag))) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('resources')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if(rmod.capMult?.resources?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.capMult?.resources?.[id], rmod.level*rmod.efficiency*intensityMultiplier);\n                capMult *= amt;\n\n                if(Math.abs(amt - 1) > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER) {\n                    storageBreakdown.multiplier.push({\n                        id: mod,\n                        name: rmod.name,\n                        value: amt\n                    })\n                }\n            }\n        });\n\n        if(!doUpdate) {\n            return {\n                income,\n                multiplier,\n                consumption,\n                rawCap,\n                capMult,\n                balance: income*multiplier - consumption,\n                modifiersBreakdown,\n                storageBreakdown\n            }\n        }\n\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.setResourceRawIncome(id, income);\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.setResourceMultiplier(id, multiplier);\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.setResourceRawConsumption(id, consumption);\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.setResourceRawCap(id, rawCap);\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.setResourceCapMult(id, capMult);\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.setBreakdown(id, modifiersBreakdown, storageBreakdown);\n        // console.log(`asserted[${id}]: `, gameResources.resources[id]);\n    }\n\n    getEffectBreakdowns(id) {\n        const byRes = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byEffect[id];\n\n        const modifiersBreakdown = {\n            income: [],\n            multiplier: [],\n            consumption: [],\n            rawCap: [],\n            capMult: [],\n            modifiers: 0,\n        };\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byEffect[id]?.income?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('effects')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.income?.effects?.[id]) {\n                const inc = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.income?.effects?.[id], rmod.level) * rmod.efficiency * intensityMultiplier;\n                if(inc != null && inc > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER) {\n                    const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.income?.effects?.[id], rmod.level) * rmod.efficiency * intensityMultiplier;\n\n                    modifiersBreakdown.income.push({\n                        id: mod,\n                        name: rmod.name,\n                        value: amt\n                    })\n                    modifiersBreakdown.modifiers++;\n                }\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byEffect[id]?.multiplier?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('effects')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.multiplier?.effects?.[id]) {\n                const amt = 1 + (_utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.multiplier?.effects?.[id], rmod.level) - 1) * rmod.efficiency * intensityMultiplier;\n\n                modifiersBreakdown.multiplier.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byEffect[id]?.consumption?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('effects')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.consumption?.effects?.[id]) {\n                const relevantEfficiency = rmod.consumption?.effects?.[id]?.ignoreEfficiency ? 1 : rmod.efficiency;\n                if (relevantEfficiency === 0) {\n                    return;\n                }\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.consumption?.effects?.[id], rmod.level) * relevantEfficiency * intensityMultiplier;\n                modifiersBreakdown.consumption.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byEffect[id]?.rawCap?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('effects')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n            if (rmod.rawCap?.effects?.[id]) {\n                const amt = _utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.rawCap?.effects?.[id], rmod.level) * rmod.efficiency * intensityMultiplier;\n                modifiersBreakdown.rawCap.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n            }\n        });\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byEffect[id]?.capMult?.forEach(mod => {\n            const rmod = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(mod);\n            if (rmod.level === 0) {\n                return;\n            }\n            if (rmod.efficiency === 0) {\n                return;\n            }\n\n            let intensityMultiplier = rmod.effectFactor;\n            if(rmod.getCustomAmplifier && rmod.customAmplifierApplyTypes.includes('effects')) {\n                intensityMultiplier *= rmod.getCustomAmplifier();\n            }\n\n            if(rmod.capMult?.effects?.[id]) {\n                const amt = 1 + (_utils_formulas__WEBPACK_IMPORTED_MODULE_1__.Formulas.calculateValue(rmod.capMult?.effects?.[id], rmod.level) - 1)*rmod.efficiency*intensityMultiplier;\n                modifiersBreakdown.capMult.push({\n                    id: mod,\n                    name: rmod.name,\n                    value: amt\n                })\n                modifiersBreakdown.modifiers++;\n            }\n        });\n\n        return modifiersBreakdown;\n    }\n\n    assertEffect(id) {\n        // now we walking through all the modifiers\n        let income = 0;\n        let multiplier = 1;\n        let consumption = 0;\n        let rawCap = 0;\n        let capMult = 1;\n\n        const byRes = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byEffect[id];\n        if(id === 'workersEfficiency') {\n            console.log('byRes: ', byRes);\n        }\n        const modifiersBreakdown = this.getEffectBreakdowns(id);\n        let isSaveTree = _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.getEffect(id).saveBalanceTree;\n\n        income = modifiersBreakdown.income?.reduce((acc, item) => acc + item.value, income);\n        consumption = modifiersBreakdown.consumption?.reduce((acc, item) => acc + item.value, consumption);\n        multiplier = modifiersBreakdown.multiplier?.reduce((acc, item) => acc * item.value, multiplier);\n        rawCap = modifiersBreakdown.rawCap?.reduce((acc, item) => acc + item.value, rawCap);\n        capMult = modifiersBreakdown.capMult?.reduce((acc, item) => acc * item.value, capMult);\n\n\n        const prevValue = _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.getEffectValue(id);\n        _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.setEffectRawIncome(id, income);\n        _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.setEffectMultiplier(id, multiplier);\n        _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.setEffectRawConsumption(id, consumption);\n        _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.setEffectRawCap(id, rawCap);\n        _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.setEffectCapMult(id, capMult);\n        if(isSaveTree) {\n            _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.setBreakDown(id, modifiersBreakdown);\n        }\n        const currValue = _game_effects__WEBPACK_IMPORTED_MODULE_3__.gameEffects.getEffectValue(id);\n        if(prevValue !== currValue) {\n            console.log(`Effect ${id} changed from ${prevValue} -> ${currValue}`, _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byDeps);\n            _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byDeps[id]?.forEach(modifierId => {\n                _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.cacheModifier(modifierId); // regenerate caches\n                this.regenerateModifier(modifierId, true)\n            })\n        }\n\n    }\n\n    regenerateModifier(id, preserveEfficiency = false) {\n        const deps = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getDependenciesToRegenerate(id);\n        if(!preserveEfficiency) {\n            console.log('regeneratingModifier: ', id, deps.effects, preserveEfficiency);\n        }\n        if(deps.resources.length) {\n            //TODO: if missing resources are present in deps - we need to reset those\n            deps.resources.forEach(rs => {\n                if(_game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(rs).isMissing && !preserveEfficiency) {\n                    this.resetConsumingEfficiency(rs);\n                }\n                this.assertResource(rs);\n            });\n        }\n        if(deps.effects.length) {\n            //TODO: if missing resources are present in deps - we need to reset those\n            deps.effects.forEach(effId => {\n                this.assertEffect(effId);\n                console.log('Reasserted: ', effId);\n            });\n        }\n    }\n\n\n    updateModifierLevel(id, level) {\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.updateLevel(id, level);\n        this.regenerateModifier(id);\n    }\n\n    updateModifierEfficiency(id, efficiency) {\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.setEfficiency(id, efficiency);\n        const deps = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getDependenciesToRegenerate(id);\n        if(deps.resources.length) {\n            deps.resources.forEach(rs => this.assertResource(rs));\n        }\n        if(deps.effects.length) {\n            deps.effects.forEach(rs => this.assertEffect(rs));\n        }\n    }\n\n    unsetModifier(id) {\n        const deps = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getDependenciesToRegenerate(id);\n        /*if(deps.resources.length) {\n            deps.resources.forEach(rs => {\n                console.log('BDEL: '+id, {...resourceModifiers.modifiersGroupped.byResource[rs]})\n            })\n        }*/\n        _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.unsetModifier(id)\n        // console.log('regeneratingModifier: ', id, deps.resources);\n        if(deps.resources.length) {\n            //TODO: if missing resources are present in deps - we need to reset those\n            deps.resources.forEach(rs => {\n                if(_game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(rs).isMissing) {\n                    this.resetConsumingEfficiency(rs);\n                }\n                this.assertResource(rs);\n            });\n        }\n        if(deps.effects.length) {\n            //TODO: if missing resources are present in deps - we need to reset those\n            deps.effects.forEach(effId => {\n                this.assertEffect(effId);\n                console.log('Reasserted: ', effId);\n            });\n        }\n    }\n\n    toggleConsumingEfficiency(resourceId, efficiency, bReset = false) {\n        const consuming = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[resourceId]?.consumption;\n\n        let affectedResourceIds = [];\n\n        // console.log('Consuming: ', resourceModifiers.modifiersGroupped.byResource);\n        if(consuming && consuming.length) {\n            consuming.forEach(consumerId => {\n                const consumer = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(consumerId);\n                /*if(resourceId === 'energy' || resourceId === 'coins') {\n                    console.log(`${resourceId} consumption/production toggled. Reassert: `, efficiency, consumer, consumer.nIter);\n                }*/\n                if(bReset) {\n                    consumer.nIter = 0;\n                }\n                consumer.nIter = (consumer.nIter) + 1;\n                if(consumer.nIter > 8) {\n                    return;\n                }\n                this.updateModifierEfficiency(consumer.id, Math.min(1, consumer.efficiency * efficiency));\n                if(consumer.bottleNeck && consumer.bottleNeck !== resourceId) {\n                    affectedResourceIds.push(consumer.bottleNeck);\n                }\n                if(efficiency < 1) {\n                    consumer.bottleNeck = resourceId;\n                }\n                if(resourceId === 'crafting_ability' || resourceId === 'inventory_paper' || resourceId === 'inventory_enchanted_paper') {\n                    console.log('Consumers of '+resourceId, consumer.id, consumer.efficiency, efficiency, JSON.parse(JSON.stringify(affectedResourceIds)), consumer.nIter);\n                }\n                /*if(consumerId === 'entity_runningAction') {\n                    console.log('AfterUpd EntEEF: ', JSON.stringify(resourceModifiers.getModifier(consumerId)), efficiency);\n                }*/\n            })\n        }\n\n        return {\n            efficiency,\n            affectedResourceIds\n        }\n    }\n\n    resetConsumingEfficiency(resourceId, bCheckBottleneck = false) {\n        const consuming = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.modifiersGroupped.byResource[resourceId]?.consumption;\n        let targetEff = 1.;\n        let affectedResources = [];\n        if(consuming && consuming.length) {\n            consuming.forEach(consumerId => {\n                const consumer = _resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getModifier(consumerId);\n                if(!bCheckBottleneck) {\n                    this.updateModifierEfficiency(consumer.id, 1);\n                } else {\n                    console.log('CHKN Checking bottleneck for '+resourceId, consumer.id, consumer.bottleNeck);\n                    //\n                    // We should get here next target, but for now use this dirty hack\n                    targetEff = 1.; // Math.min(1, Math.max(consumer.efficiency, 100*SMALL_NUMBER)*4);\n                    if(consumer.bottleNeck === resourceId) {\n                        this.updateModifierEfficiency(consumer.id,targetEff);\n                    }\n                }\n\n                affectedResources.push(..._resource_modifiers__WEBPACK_IMPORTED_MODULE_0__.resourceModifiers.getDependenciesToRegenerate(consumer.id).resources)\n\n            })\n        }\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).isMissing = targetEff >= 1.;\n        _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).targetEfficiency = targetEff;\n\n        return {\n            affectedResources\n        }\n    }\n\n    isAffordable(prices) {\n        let isAffordable = true;\n        let affordabilities = {};\n        let eta = 0;\n        let percentage = 1;\n        let hardLocked = false;\n        let max = 1e+200;\n        for(const resourceId in prices) {\n            affordabilities[resourceId] = {\n                resourceId,\n                name: _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).name,\n                requirement: prices[resourceId],\n                actual: _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).amount,\n                max: prices[resourceId] > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER ? Math.floor(_game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).amount / prices[resourceId]) : 1e+200,\n            }\n            if(_game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).amount >= prices[resourceId] || prices[resourceId] <= 0) {\n                affordabilities[resourceId].isAffordable = true;\n            } else {\n                affordabilities[resourceId].isAffordable = false;\n                affordabilities[resourceId].eta = _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).balance > _utils_consts__WEBPACK_IMPORTED_MODULE_4__.SMALL_NUMBER ? (prices[resourceId] - _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).amount) / _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).balance : 1.e+20;\n                affordabilities[resourceId].percentage = _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).amount / prices[resourceId];\n                isAffordable = false;\n                if(_game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).hasCap && prices[resourceId] > _game_resources__WEBPACK_IMPORTED_MODULE_2__.gameResources.getResource(resourceId).cap) {\n                    affordabilities[resourceId].hardLocked = true;\n                    affordabilities[resourceId].eta = 1.e+20;\n                    hardLocked = true;\n                }\n                eta = Math.max(eta, affordabilities[resourceId].eta);\n                percentage = Math.min(percentage, affordabilities[resourceId].percentage);\n            }\n            max = Math.min(max, affordabilities[resourceId].max);\n        }\n        return {\n            isAffordable,\n            hardLocked,\n            eta,\n            percentage,\n            affordabilities,\n            max\n        }\n    }\n}\n\nconst resourceCalculators = ResourceCalculators.instance || new ResourceCalculators();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/resources/resource-calculators.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/resources/resource-modifiers.js":
/*!*************************************************************************!*\
  !*** ./node_modules/game-framework/src/resources/resource-modifiers.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ResourceModifiers: () => (/* binding */ ResourceModifiers),\n/* harmony export */   resourceModifiers: () => (/* binding */ resourceModifiers)\n/* harmony export */ });\nclass ResourceModifiers {\n\n    constructor() {\n        this.modifiers = {}\n        this.modifiersGroupped = {\n            byResource: {},\n            byEffect: {},\n            byDeps: {},\n            byResourceDeps: {}\n        }\n        ResourceModifiers.instance = this;\n    }\n\n    registerModifier(modifier, entityRefId = null) {\n        if(modifier.groupId && entityRefId) {\n            modifier = this.modifiers[modifier.groupId] ?? modifier;\n            console.log('(modifier.entityRefs || [])', modifier, this.modifiers);\n            modifier.entityRefs ? modifier.entityRefs.push(entityRefId) : modifier.entityRefs = [entityRefId];\n        }\n        if(modifier.level == null) {\n            modifier.level = 0\n        }\n        if(!modifier.id) {\n            throw new Error(`Unique id is required`);\n        }\n        modifier.efficiency = modifier.efficiency || 1;\n        this.modifiers[modifier.id] = modifier;\n\n        const result = this.cacheModifier(modifier.id);\n\n        // console.log('Modiff: ', this.modifiers, this.modifiersGroupped);\n\n        return result;\n\n    }\n\n    unsetModifier(modifierId) {\n        if(!this.modifiers[modifierId]) return;\n\n        for(const id in this.modifiersGroupped.byResource) {\n            for(const effectKey in this.modifiersGroupped.byResource[id]) {\n                this.modifiersGroupped.byResource[id][effectKey] = this.modifiersGroupped.byResource[id][effectKey]\n                    .filter(one => one !== modifierId);\n            }\n        }\n\n        for(const id in this.modifiersGroupped.byEffect) {\n            for(const effectKey in this.modifiersGroupped.byEffect[id]) {\n                this.modifiersGroupped.byEffect[id][effectKey] = this.modifiersGroupped.byEffect[id][effectKey]\n                    .filter(one => one !== modifierId);\n            }\n        }\n\n        for(const id in this.modifiersGroupped.byDeps) {\n            this.modifiersGroupped.byDeps[id] = this.modifiersGroupped.byDeps[id]\n                .filter(one => one !== modifierId);\n        }\n\n        for(const id in this.modifiersGroupped.byResourceDeps) {\n            this.modifiersGroupped.byResourceDeps[id] = this.modifiersGroupped.byResourceDeps[id]\n                .filter(one => one !== modifierId);\n        }\n\n        delete this.modifiers[modifierId];\n    }\n\n    getModifier(id) {\n        if(!this.modifiers[id]) {\n            throw new Error(`Modifier ${id} wasn't found`)\n        }\n\n        return this.modifiers[id];\n    }\n\n    setEfficiency(id, efficiency) {\n        this.getModifier(id).efficiency = efficiency;\n        // return this.cacheModifier(modifier.id);\n    }\n\n    updateLevel(id, level) {\n        this.getModifier(id).level = level;\n        // return this.cacheModifier(modifier.id);\n    }\n\n    unpackModifier(modifier, effectKey) {\n\n        if(modifier[`get_${effectKey}`]) {\n            modifier[effectKey] = modifier[`get_${effectKey}`]();\n        }\n\n        if(modifier[effectKey].resources && modifier.allowedImpacts.includes('resources')) {\n            for(const key in modifier[effectKey].resources) {\n                if(!this.modifiersGroupped.byResource[key]) {\n                    this.modifiersGroupped.byResource[key] = {\n\n                    }\n                }\n                if(!this.modifiersGroupped.byResource[key][effectKey]) {\n                    this.modifiersGroupped.byResource[key][effectKey] = []\n                }\n                if(!this.modifiersGroupped.byResource[key][effectKey].find(mod => mod === modifier.id)) {\n                    this.modifiersGroupped.byResource[key][effectKey].push(modifier.id);\n                }\n            }\n        }\n        if(modifier[effectKey].effects && modifier.allowedImpacts.includes('effects')) {\n            for(const key in modifier[effectKey].effects) {\n                if(!this.modifiersGroupped.byEffect[key]) {\n                    this.modifiersGroupped.byEffect[key] = {\n\n                    }\n                }\n                if(!this.modifiersGroupped.byEffect[key][effectKey]) {\n                    this.modifiersGroupped.byEffect[key][effectKey] = []\n                }\n                if(!this.modifiersGroupped.byEffect[key][effectKey].find(mod => mod === modifier.id)) {\n                    this.modifiersGroupped.byEffect[key][effectKey].push(modifier.id);\n                }\n            }\n        }\n    }\n\n    // caches all dependencies\n    cacheModifier(id) {\n        const modifier = this.getModifier(id);\n        // Now group down modifiers\n        if(modifier.income || modifier.get_income) {\n            this.unpackModifier(modifier, 'income');\n        }\n        if(modifier.multiplier || modifier.get_multiplier) {\n            this.unpackModifier(modifier, 'multiplier');\n        }\n        if(modifier.consumption || modifier.get_consumption) {\n            this.unpackModifier(modifier, 'consumption');\n        }\n        if(modifier.rawCap || modifier.get_rawCap) {\n            this.unpackModifier(modifier, 'rawCap');\n        }\n        if(modifier.capMult || modifier.get_capMult) {\n            this.unpackModifier(modifier, 'capMult');\n        }\n        if(modifier.effectDeps) {\n            modifier.effectDeps.forEach(dep => {\n                if(!this.modifiersGroupped.byDeps[dep]) {\n                    this.modifiersGroupped.byDeps[dep] = [];\n                }\n                if(!this.modifiersGroupped.byDeps[dep].includes(modifier.id)) {\n                    this.modifiersGroupped.byDeps[dep].push(modifier.id)\n                }\n            })\n\n        }\n        if(modifier.resourceDeps) {\n            modifier.resourceDeps.forEach(dep => {\n                if(!this.modifiersGroupped.byResourceDeps[dep]) {\n                    this.modifiersGroupped.byResourceDeps[dep] = [];\n                }\n                if(!this.modifiersGroupped.byResourceDeps[dep].includes(modifier.id)) {\n                    this.modifiersGroupped.byResourceDeps[dep].push(modifier.id)\n                }\n            })\n\n        }\n        /*if(modifier.effect) {\n            this.unpackModifier(modifier, 'effect');\n        }\n        if(modifier.effectMult) {\n            this.unpackModifier(modifier, 'effectMult');\n        }*/\n\n        return modifier;\n    }\n\n    // get list of dependant resources or effects to re-assert\n    getDependenciesToRegenerate(id) {\n        const modif = this.getModifier(id);\n        const dependantResources = [];\n        const dependantEffects = [];\n\n        if(modif.income) {\n            dependantResources.push(...Object.keys(modif.income.resources || []))\n            dependantEffects.push(...Object.keys(modif.income.effects || []))\n        }\n\n        if(modif.multiplier) {\n            dependantResources.push(...Object.keys(modif.multiplier.resources || []))\n            dependantEffects.push(...Object.keys(modif.multiplier.effects || []))\n        }\n\n        if(modif.consumption) {\n            dependantResources.push(...Object.keys(modif.consumption.resources || []))\n            dependantEffects.push(...Object.keys(modif.consumption.effects || []))\n        }\n\n        if(modif.rawCap) {\n            dependantResources.push(...Object.keys(modif.rawCap.resources || []))\n            dependantEffects.push(...Object.keys(modif.rawCap.effects || []))\n        }\n\n        if(modif.capMult) {\n            dependantResources.push(...Object.keys(modif.capMult.resources || []))\n            dependantEffects.push(...Object.keys(modif.capMult.effects || []))\n        }\n\n        if(modif.reourcesToReassert) {\n            dependantResources.push(...modif.reourcesToReassert);\n        }\n\n        return {\n            resources: dependantResources,\n            effects: dependantEffects,\n        }\n    }\n\n    cacheAll() {\n        Object.keys(this.modifiers).forEach(id => this.cacheModifier(id))\n    }\n\n}\n\nconst resourceModifiers = ResourceModifiers.instance || new ResourceModifiers();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/resources/resource-modifiers.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/utils/consts.js":
/*!*********************************************************!*\
  !*** ./node_modules/game-framework/src/utils/consts.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SMALL_NUMBER: () => (/* binding */ SMALL_NUMBER)\n/* harmony export */ });\nconst SMALL_NUMBER = 1.e-8;\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/utils/consts.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/utils/formulas.js":
/*!***********************************************************!*\
  !*** ./node_modules/game-framework/src/utils/formulas.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Formulas: () => (/* binding */ Formulas)\n/* harmony export */ });\nclass Formulas {\n\n    static applyMinMax(val, formula) {\n        if (formula.min != null) {\n            val = Math.max(formula.min, val);\n        }\n        if (formula.max != null) {\n            val = Math.min(formula.max, val);\n        }\n        return val;\n    }\n\n    static calculateLinearValue(formula, x) {\n        let val = formula.B + formula.A * x;\n        return this.applyMinMax(val, formula);\n    }\n\n    static calculateConst(formula, x) {\n        let val = x < 1 ? formula.B : formula.A + formula.B;\n        return this.applyMinMax(val, formula);\n    }\n\n    static calculateExponentialValue(formula, x) {\n        let val = formula.B * Math.pow(formula.A, x) + (formula.C || 0);\n        return this.applyMinMax(val, formula);\n    }\n\n    static calculatePolyExponential(formula, x) {\n        let val = formula.B + formula.A * x * Math.pow(formula.C, x);\n        return this.applyMinMax(val, formula);\n    }\n\n    static calculateDiminish(formula, x) {\n        let val = formula.C + formula.A * formula.B * x * Math.pow(x, 0.5) / (formula.B + x);\n        return this.applyMinMax(val, formula);\n    }\n\n    static calculateValue(formula, x) {\n        if (formula.type === 0) {\n            return Formulas.calculateLinearValue(formula, x);\n        } else if (formula.type === 1) {\n            return Formulas.calculateExponentialValue(formula, x);\n        } else if (formula.type === 2) {\n            return Formulas.calculateConst(formula, x);\n        } else if (formula.type === 3) {\n            return Formulas.calculatePolyExponential(formula, x);\n        } else if (formula.type === 4) {\n            return Formulas.calculateDiminish(formula, x);\n        } else {\n            throw new Error('Invalid formula type: ' + formula.type);\n        }\n    }\n\n}\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/utils/formulas.js?");

/***/ }),

/***/ "./node_modules/game-framework/src/utils/unlocks.js":
/*!**********************************************************!*\
  !*** ./node_modules/game-framework/src/utils/unlocks.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GameUnlocks: () => (/* binding */ GameUnlocks),\n/* harmony export */   gameUnlocks: () => (/* binding */ gameUnlocks)\n/* harmony export */ });\nclass GameUnlocks {\n\n    constructor() {\n        GameUnlocks.instance = this;\n        this.unlockMapping = {\n            entity: {},\n            effect: {}\n        };\n    }\n\n    findNextUnlock(unlocks, currentLevel) {\n        let left = 0;\n        let right = unlocks.length - 1;\n        let nextUnlock = null;\n        let nextLevelPos = currentLevel + 1;\n\n        while (left <= right) {\n            const mid = Math.floor((left + right) / 2);\n            if (unlocks[mid].level >= nextLevelPos) {\n                nextUnlock = unlocks[mid];\n                right = mid - 1; // Search the left half\n            } else {\n                left = mid + 1; // Search the right half\n            }\n        }\n\n        return nextUnlock;\n    }\n\n    sortUnlockMappings() {\n        for (const scope in this.unlockMapping) {\n\n            for (const unlockerId in this.unlockMapping[scope]) {\n                this.unlockMapping[scope][unlockerId].sort((a, b) => a.level - b.level);\n            }\n\n        }\n\n    }\n\n    initialize() {\n        this.sortUnlockMappings();\n    }\n\n}\n\n\nconst gameUnlocks = GameUnlocks.instance || new GameUnlocks();\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./node_modules/game-framework/src/utils/unlocks.js?");

/***/ }),

/***/ "./src/worker/main.worker.js":
/*!***********************************!*\
  !*** ./src/worker/main.worker.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _main_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./main.module */ \"./src/worker/main.module.js\");\n\n\nconsole.log('re-inc', _main_module__WEBPACK_IMPORTED_MODULE_0__.MainModule.instance);\n\nconst mainGame = (0,_main_module__WEBPACK_IMPORTED_MODULE_0__.mainModule)();\n\nself.addEventListener('message', (event) => {\n    // Perform some computation\n    mainGame.eventHandler.processEvent(event);\n    /*const result = {\n        received: event.data\n    };\n    self.postMessage(JSON.stringify({event: 'initialized', payload: result}));*/\n});\n\n\n//# sourceURL=webpack://idlemancery-v2-reworked/./src/worker/main.worker.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/worker/main.worker.js");
/******/ 	
/******/ })()
;